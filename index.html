<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ElementCraft: Chemie-Simulation</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.3.4/vue.global.prod.js"></script>
    <link rel="stylesheet" type="text/css"
          href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js"></script>
    <style>
        [v-cloak] {
            display: none;
        }

        .element {
            transition: all 0.3s ease;
        }

        .element:hover {
            transform: scale(1.05);
            z-index: 10;
        }

        .break-word {
            word-break: break-word;
        }

        .workspace-area {
            min-height: 200px;
        }

        .discovered-item {
            transition: all 0.3s;
        }

        .discovered-item:hover {
            transform: translateY(-5px);
        }

        .lab-equipment {
            transition: all 0.3s;
        }

        .lab-equipment:hover {
            transform: scale(1.05);
        }

        .new-discovery {
            animation: pulse 2s infinite;
        }

        .modal-content {
            max-width: 80vw;
            max-height: 80vh;
            overflow: auto;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(66, 153, 225, 0.7);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(66, 153, 225, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(66, 153, 225, 0);
            }
        }

        .notification {
            transition: all 0.5s;
            animation: slideIn 0.5s forwards;
        }

        @keyframes slideIn {
            from {
                transform: translateY(-100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .notification-exit {
            animation: slideOut 0.5s forwards;
        }

        @keyframes slideOut {
            from {
                transform: translateY(0);
                opacity: 1;
            }
            to {
                transform: translateY(-100%);
                opacity: 0;
            }
        }

        .particle {
            position: absolute;
            border-radius: 50%;
            pointer-events: none;
            animation: particle 1s linear forwards;
        }

        @keyframes particle {
            0% {
                transform: translate(0, 0);
                opacity: 1;
            }
            100% {
                transform: translate(var(--tx), var(--ty));
                opacity: 0;
            }
        }

        .tooltip {
            visibility: hidden;
            position: absolute;
            z-index: 50;
            width: auto;
            max-width: 250px;
            padding: 0.5rem;
            border-radius: 0.375rem;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            opacity: 0;
            transition: opacity 0.3s;
        }

        *:hover > .tooltip {
            visibility: visible;
            opacity: 1;
        }

        .mission-progress {
            transition: width 0.5s ease-in-out;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .reaction-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            background-color: rgba(0, 0, 0, 0.7);
            animation: fadeIn 0.3s forwards;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .bouncing {
            animation: bounce 1s infinite alternate;
        }

        @keyframes bounce {
            from {
                transform: translateY(0);
            }
            to {
                transform: translateY(-10px);
            }
        }

        .rotating {
            animation: rotate 2s linear infinite;
        }

        @keyframes rotate {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }

        .temperature-bar {
            height: 1.5rem;
            background: linear-gradient(to right, blue, green, yellow, red);
            border-radius: 0.375rem;
            position: relative;
        }

        .temperature-indicator {
            position: absolute;
            top: -8px;
            width: 10px;
            height: 20px;
            background-color: white;
            border: 1px solid black;
            border-radius: 2px;
            transform: translateX(-50%);
            transition: left 0.3s ease;
        }

        /* Mobile optimizations */
        @media (max-width: 640px) {
            .workspace-area {
                min-height: 150px;
            }

            .element, .lab-equipment {
                padding: 0.5rem !important;
            }

            .mobile-scroll {
                overflow-x: auto;
                white-space: nowrap;
                -webkit-overflow-scrolling: touch;
                padding-bottom: 0.5rem;
            }

            .mobile-scroll::-webkit-scrollbar {
                height: 4px;
            }

            .mobile-scroll::-webkit-scrollbar-thumb {
                background-color: rgba(156, 163, 175, 0.5);
                border-radius: 2px;
            }

            .mobile-small-text {
                font-size: 0.75rem !important;
            }

            .mobile-btn {
                padding: 0.5rem !important;
                font-size: 0.875rem !important;
            }

            .mobile-stack {
                flex-direction: column !important;
            }

            .mobile-stack > * {
                margin-left: 0 !important;
                margin-right: 0 !important;
                margin-top: 0.5rem !important;
                width: 100% !important;
            }

            .mobile-compact {
                padding: 0.5rem !important;
            }
        }
    </style>
</head>
<body>
<div id="app" v-cloak :class="darkMode ? 'bg-gray-900 text-white' : 'bg-gray-100 text-gray-900'"
     class="min-h-screen transition-colors duration-500">
    <!-- Header -->
    <header class="p-3 sm:p-4 flex justify-between items-center"
            :class="darkMode ? 'bg-gray-800' : 'bg-blue-600 text-white'">
        <div class="flex items-center space-x-2 sm:space-x-4">
            <h1 class="text-xl sm:text-2xl md:text-3xl font-bold">ElementCraft</h1>
            <div class="hidden sm:flex items-center space-x-2 p-2 rounded-lg"
                 :class="darkMode ? 'bg-gray-700' : 'bg-blue-500'">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd"
                          d="M10 2a4 4 0 00-4 4v1H5a1 1 0 00-.994.89l-1 9A1 1 0 004 18h12a1 1 0 00.994-1.11l-1-9A1 1 0 0015 7h-1V6a4 4 0 00-4-4zm2 5V6a2 2 0 10-4 0v1h4zm-6 3a1 1 0 112 0 1 1 0 01-2 0zm7-1a1 1 0 100 2 1 1 0 000-2z"
                          clip-rule="evenodd"/>
                </svg>
                <span>{{ translate({de: 'Entdeckungen', en: 'Discoveries'}) }}: {{ discoveredItems.length
                    }}/{{ recipeCount }}</span>
            </div>
        </div>
        <div class="flex space-x-1 sm:space-x-2">
            <button @click="openMissionsModal" class="p-1 sm:p-2 rounded-lg hover:bg-opacity-80"
                    :class="darkMode ? 'bg-green-700 hover:bg-green-600' : 'bg-green-500'">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24"
                     stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"/>
                </svg>
            </button>
            <button @click="toggleDarkMode" class="p-1 sm:p-2 rounded-lg hover:bg-opacity-80"
                    :class="darkMode ? 'bg-yellow-500 text-gray-900' : 'bg-gray-700'">
                <svg v-if="darkMode" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20"
                     fill="currentColor">
                    <path fill-rule="evenodd"
                          d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"
                          clip-rule="evenodd"/>
                </svg>
                <svg v-else xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"/>
                </svg>
            </button>
            <button @click="toggleLanguage" class="p-1 sm:p-2 rounded-lg hover:bg-opacity-80"
                    :class="darkMode ? 'bg-gray-700' : 'bg-gray-700 text-white'">
                {{ currentLanguage.toUpperCase() }}
            </button>
            <button @click="resetGame" class="p-1 sm:p-2 rounded-lg hover:bg-opacity-80"
                    :class="darkMode ? 'bg-red-700 hover:bg-red-600' : 'bg-red-500'">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd"
                          d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z"
                          clip-rule="evenodd"/>
                </svg>
            </button>
        </div>
    </header>

    <!-- Mobile Stats Bar -->
    <div class="sm:hidden flex justify-between items-center p-2 bg-blue-800 text-white">
        <div class="flex items-center space-x-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd"
                      d="M10 2a4 4 0 00-4 4v1H5a1 1 0 00-.994.89l-1 9A1 1 0 004 18h12a1 1 0 00.994-1.11l-1-9A1 1 0 0015 7h-1V6a4 4 0 00-4-4zm2 5V6a2 2 0 10-4 0v1h4zm-6 3a1 1 0 112 0 1 1 0 01-2 0zm7-1a1 1 0 100 2 1 1 0 000-2z"
                      clip-rule="evenodd"/>
            </svg>
            <span class="text-xs">{{ discoveredItems.length }}/{{ recipeCount }}</span>
        </div>
        <div class="flex items-center space-x-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd"
                      d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                      clip-rule="evenodd"/>
            </svg>
            <span class="text-xs">{{ translate({de: 'Level', en: 'Level'}) }}: {{ playerLevel }}</span>
        </div>
        <div class="flex items-center space-x-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118l-2.8-2.034c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
            </svg>
            <span class="text-xs">{{ currentLevelProgress }}/{{ currentLevelTarget }}</span>
        </div>
    </div>

    <!-- Notifications -->
    <div class="fixed top-16 sm:top-20 right-2 sm:right-4 w-64 sm:w-72 z-50 space-y-2">
        <div v-for="(notification, index) in notifications" :key="notification.id"
             class="notification p-3 rounded-lg shadow-lg"
             :class="[
             notification.exiting ? 'notification-exit' : '',
             darkMode ? 'bg-gray-800 border-l-4 border-blue-500' : 'bg-white border-l-4 border-blue-600 text-gray-800'
           ]">
            <div class="flex items-center">
                <div class="mr-3" :class="notificationIconClass(notification.type)">
                    <svg v-if="notification.type === 'discovery'" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5"
                         fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                              d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                    </svg>
                    <svg v-else-if="notification.type === 'mission'" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5"
                         fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                              d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"/>
                    </svg>
                    <svg v-else xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24"
                         stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                              d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                </div>
                <div class="flex-grow">
                    <div class="font-medium text-sm sm:text-base">{{ notification.title }}</div>
                    <div class="text-xs sm:text-sm opacity-90">{{ notification.message }}</div>
                </div>
                <button @click="dismissNotification(notification.id)" class="ml-2 text-gray-500 hover:text-gray-700">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24"
                         stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <!-- Main Game Area -->
    <main class="container mx-auto p-2 sm:p-4 pb-24">
        <!-- Quick Mission Progress -->
        <div v-if="activeMission" class="mb-4 p-3 rounded-lg shadow-md"
             :class="darkMode ? 'bg-gray-800' : 'bg-blue-50 text-blue-800'">
            <div class="flex justify-between items-start">
                <div class="flex-grow">
                    <div class="flex items-start">
                        <svg class="h-5 w-5 mt-1 mr-2 flex-shrink-0"
                             :class="darkMode ? 'text-yellow-400' : 'text-yellow-600'" xmlns="http://www.w3.org/2000/svg"
                             fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"/>
                        </svg>
                        <div>
                            <h3 class="font-bold text-sm sm:text-lg">{{ activeMission.title }}</h3>
                            <p class="text-xs sm:text-sm">{{ activeMission.description }}</p>
                            <div class="mt-2 w-full bg-gray-300 rounded-full h-2.5 dark:bg-gray-700">
                                <div class="bg-blue-600 h-2.5 rounded-full mission-progress"
                                     :style="{ width: `${calculateMissionProgress(activeMission)}%` }"></div>
                            </div>
                            <div class="mt-1 text-xs">
                                {{ translate({de: 'Fortschritt', en: 'Progress'}) }}:
                                {{ getMissionProgressText(activeMission) }}
                            </div>
                        </div>
                    </div>

                    <!-- Mission Hints -->
                    <div class="mt-3 border-t pt-2 border-gray-200 dark:border-gray-700">
                        <h4 class="text-xs font-semibold mb-1">{{ translate({de: 'Hinweise', en: 'Hints'}) }}:</h4>
                        <ul class="space-y-1 list-disc pl-5 text-xs">
                            <li v-for="(hint, idx) in getMissionHints(activeMission)" :key="idx">{{ hint }}</li>
                        </ul>

                        <h4 class="text-xs font-semibold mt-2 mb-1">{{ translate({de: 'Benötigte Zutaten', en: 'Required Ingredients'}) }}:</h4>
                        <div v-for="req in activeMission.requirements" :key="req.id" class="mb-1 text-xs">
                            <div v-if="req.type === 'discover'">
                                <div class="flex items-center">
                            <span :class="discoveredItems.some(item => item.id === req.id) ? 'line-through opacity-50' : ''">
                                {{ getElementSymbolById(req.id) }}:
                            </span>

                                    <div v-if="getMissionIngredients(activeMission, req.id)" class="flex items-center ml-2">
                                <span v-for="(ingredient, idx) in getMissionIngredients(activeMission, req.id).ingredients" :key="idx"
                                      class="mx-1 px-1 rounded"
                                      :class="isIngredientAvailable(ingredient) ? 'bg-green-100 dark:bg-green-800' : 'bg-red-100 dark:bg-red-800'">
                                    {{ ingredient }}
                                </span>

                                        <span v-if="getMissionIngredients(activeMission, req.id).equipmentNeeded.length > 0" class="ml-2">
                                    +
                                    <span v-for="(eq, idx) in getMissionIngredients(activeMission, req.id).equipmentNeeded" :key="idx"
                                          class="mx-1 px-1 rounded"
                                          :class="activeEquipment.some(e => e.id === eq) ? 'bg-green-100 dark:bg-green-800' : 'bg-red-100 dark:bg-red-800'">
                                        {{ getEquipmentNameById(eq) }}
                                    </span>
                                </span>

                                        <span v-if="getMissionIngredients(activeMission, req.id).temperature" class="ml-2">
                                    {{ translate({de: 'Temp', en: 'Temp'}) }}:
                                    <span class="mx-1 px-1 rounded"
                                          :class="temperature >= getMissionIngredients(activeMission, req.id).temperature.min &&
                                                 temperature <= getMissionIngredients(activeMission, req.id).temperature.max ?
                                                 'bg-green-100 dark:bg-green-800' : 'bg-red-100 dark:bg-red-800'">
                                        {{ getMissionIngredients(activeMission, req.id).temperature.min }}-{{ getMissionIngredients(activeMission, req.id).temperature.max }}°C
                                    </span>
                                </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <button @click="activeMission = null" class="text-gray-500 hover:text-gray-700 ml-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24"
                         stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
        </div>

        <!-- Tabs for different game areas -->
        <div class="mb-3 sm:mb-6">
            <div class="flex border-b overflow-x-auto mobile-scroll"
                 :class="darkMode ? 'border-gray-700' : 'border-gray-200'">
                <button
                        v-for="tab in tabs"
                        :key="tab.id"
                        @click="activeTab = tab.id"
                        class="py-2 px-3 sm:px-4 font-medium rounded-t-lg transition-all whitespace-nowrap"
                        :class="[
              activeTab === tab.id
                ? (darkMode ? 'bg-gray-800 text-blue-400 border-b-2 border-blue-400' : 'bg-white text-blue-600 border-b-2 border-blue-600')
                : (darkMode ? 'text-gray-400 hover:text-white' : 'text-gray-500 hover:text-gray-700')
            ]"
                >
                    <div class="flex items-center">
                        <component :is="tab.icon" class="h-4 w-4 sm:h-5 sm:w-5 mr-1 sm:mr-2"></component>
                        <span class="text-sm sm:text-base">{{ tab.name }}</span>
                    </div>
                </button>
            </div>
        </div>

        <!-- Lab Tab -->
        <div v-if="activeTab === 'lab'" class="tab-content active">
            <!-- Workspace Area -->
            <div class="workspace-area mb-3 sm:mb-6 p-3 sm:p-4 rounded-lg shadow-md relative"
                 :class="darkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200'">
                <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center mb-3">
                    <h2 class="text-lg sm:text-xl font-bold mb-2 sm:mb-0">{{ translate({
                        de: 'Arbeitsbereich',
                        en: 'Workspace'
                    }) }}</h2>

                    <!-- Temperature Control -->
                    <div class="flex flex-wrap items-center gap-1 sm:gap-2">
                        <span class="text-xs sm:text-sm">{{ translate({de: 'Temperatur', en: 'Temperature'}) }}:</span>
                        <div class="temperature-bar w-24 sm:w-32 relative">
                            <div class="temperature-indicator"
                                 :style="{ left: `${(temperature / maxTemperature) * 100}%` }"></div>
                        </div>
                        <input
                                type="range"
                                v-model.number="temperature"
                                min="0"
                                :max="maxTemperature"
                                class="w-24 sm:w-32"
                        >
                        <input
                                type="number"
                                v-model.number="temperature"
                                min="0"
                                :max="maxTemperature"
                                class="w-12 sm:w-16 px-1 sm:px-2 py-1 rounded-md text-sm"
                                :class="darkMode ? 'bg-gray-700 border-gray-600' : 'bg-white border-gray-300'"
                        >
                        <span class="text-xs sm:text-sm">°C</span>
                    </div>
                </div>

                <!-- Active Equipment Display -->
                <div v-if="activeEquipment.length > 0" class="mb-3 sm:mb-4 flex flex-wrap gap-2">
                    <div v-for="(item, index) in activeEquipment" :key="'eq-'+index"
                         class="lab-equipment p-1 sm:p-2 rounded-lg shadow-md flex items-center space-x-1 sm:space-x-2 text-sm"
                         :class="getElementClass(item)">
                        <span class="text-base sm:text-lg">{{ item.symbol }}</span>
                        <span class="text-xs sm:text-sm">{{ item.name }}</span>
                        <button @click="removeEquipment(index)" class="text-gray-500 hover:text-gray-700 ml-1 sm:ml-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 sm:h-4 sm:w-4" fill="none"
                                 viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                      d="M6 18L18 6M6 6l12 12"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <div class="flex flex-wrap gap-2 sm:gap-3 min-h-24 sm:min-h-32" @dragover.prevent @drop="onDrop">
                    <div v-for="(item, index) in workspace" :key="'workspace-'+index"
                         class="element cursor-grab p-2 sm:p-3 rounded-lg shadow-md text-xs sm:text-sm"
                         :class="getElementClass(item)"
                         draggable="true"
                         @dragstart="onDragStart($event, item, index, 'workspace')"
                         @click="removeFromWorkspace(index)">
                        <div class="font-bold text-base sm:text-lg">{{ item.symbol }}</div>
                        <div class="text-xs">{{ item.name }}</div>
                        <div v-if="item.state" class="text-xs mt-1 italic">
                            {{ translate({de: 'Zustand', en: 'State'}) }}: {{ translateState(item.state) }}
                        </div>
                    </div>
                    <!-- Workspace Empty State with Suggestions -->
                    <div v-if="workspace.length === 0 && activeMission"
                         class="w-full h-24 sm:h-32 flex items-center justify-center text-gray-500 italic text-xs sm:text-sm">
                        <div class="text-center">
                            <p>{{ translate({
                                de: 'Ziehe Elemente hierher, um zu experimentieren',
                                en: 'Drag elements here to experiment'
                            }) }}</p>

                            <div v-if="displayWorkspaceHint()" class="mt-2 p-2 bg-blue-50 dark:bg-blue-900 rounded-md text-xs">
                                <p class="font-semibold">{{ translate({de: 'Vorschlag', en: 'Suggestion'}) }}:</p>
                                <p>{{ translate({
                                    de: `Für ${displayWorkspaceHint().target}, füge hinzu:`,
                                    en: `For ${displayWorkspaceHint().target}, add:`
                                }) }}</p>

                                <div v-if="displayWorkspaceHint().missingIngredients.length > 0" class="mt-1">
                <span v-for="(ing, idx) in displayWorkspaceHint().missingIngredients" :key="idx"
                      class="mx-1 px-1 rounded bg-green-100 dark:bg-green-800">
                    {{ ing }}
                </span>
                                </div>

                                <div v-if="displayWorkspaceHint().missingEquipment.length > 0" class="mt-1">
                                    <span>{{ translate({de: 'Benötigte Ausrüstung', en: 'Required equipment'}) }}:</span>
                                    <span v-for="(eq, idx) in displayWorkspaceHint().missingEquipment" :key="idx"
                                          class="mx-1 px-1 rounded bg-yellow-100 dark:bg-yellow-800">
                    {{ eq }}
                </span>
                                </div>

                                <div v-if="displayWorkspaceHint().temperature" class="mt-1">
                                    <span>{{ translate({de: 'Temperatur', en: 'Temperature'}) }}:</span>
                                    <span class="mx-1 px-1 rounded bg-orange-100 dark:bg-orange-800">
                    {{ displayWorkspaceHint().temperature.min }}-{{ displayWorkspaceHint().temperature.max }}°C
                </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mt-3 sm:mt-4 flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 sm:gap-0">
                    <button @click="combineElements"
                            class="px-3 py-1 sm:px-4 sm:py-2 rounded-lg shadow hover:shadow-lg transition-all text-sm sm:text-base"
                            :class="[workspace.length >= 2 || (workspace.length >= 1 && activeEquipment.length > 0) ? (darkMode ? 'bg-green-600 hover:bg-green-500' : 'bg-green-500 hover:bg-green-400 text-white') : (darkMode ? 'bg-gray-700 cursor-not-allowed' : 'bg-gray-300 cursor-not-allowed text-gray-500'), 'flex items-center justify-center sm:justify-start space-x-1 sm:space-x-2']"
                            :disabled="workspace.length < 2 && (workspace.length < 1 || activeEquipment.length === 0)">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 sm:h-5 sm:w-5" viewBox="0 0 20 20"
                             fill="currentColor">
                            <path fill-rule="evenodd"
                                  d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z"
                                  clip-rule="evenodd"/>
                        </svg>
                        <span>{{ translate({de: 'Kombinieren', en: 'Combine'}) }}</span>
                    </button>
                    <button @click="clearWorkspace"
                            class="px-3 py-1 sm:px-4 sm:py-2 rounded-lg shadow hover:shadow-lg transition-all flex items-center justify-center sm:justify-start space-x-1 sm:space-x-2 text-sm sm:text-base"
                            :class="workspace.length > 0 ? (darkMode ? 'bg-red-600 hover:bg-red-500' : 'bg-red-500 hover:bg-red-400 text-white') : (darkMode ? 'bg-gray-700 cursor-not-allowed' : 'bg-gray-300 cursor-not-allowed text-gray-500')"
                            :disabled="workspace.length === 0">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 sm:h-5 sm:w-5" viewBox="0 0 20 20"
                             fill="currentColor">
                            <path fill-rule="evenodd"
                                  d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                                  clip-rule="evenodd"/>
                        </svg>
                        <span>{{ translate({de: 'Leeren', en: 'Clear'}) }}</span>
                    </button>
                </div>
            </div>

            <!-- Basic Elements -->
            <div class="mb-3 sm:mb-6 p-3 sm:p-4 rounded-lg shadow-md"
                 :class="darkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200'">
                <h2 class="text-lg sm:text-xl font-bold mb-2 sm:mb-3">{{ translate({
                    de: 'Grundelemente',
                    en: 'Basic Elements'
                }) }}</h2>
                <div class="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-2 sm:gap-3">
                    <div v-for="element in basicElements" :key="element.id"
                         class="element cursor-grab p-2 sm:p-3 rounded-lg shadow-md transition-all relative text-xs sm:text-sm"
                         :class="getElementClass(element)"
                         draggable="true"
                         @dragstart="onDragStart($event, element, null, 'basics')"
                         @click="addToWorkspace(element)">
                        <div class="font-bold text-base sm:text-lg">{{ element.symbol }}</div>
                        <div class="text-xs">{{ element.name }}</div>
                        <div class="tooltip" :class="darkMode ? 'bg-gray-700' : 'bg-white text-gray-800'">
                            <h4 class="font-bold text-xs sm:text-sm">{{ element.name }}</h4>
                            <p v-if="element.description" class="text-xs mt-1">{{ element.description }}</p>
                            <div v-if="element.atomicNumber" class="text-xs mt-1">
                                {{ translate({de: 'Ordnungszahl', en: 'Atomic Number'}) }}: {{ element.atomicNumber }}
                            </div>
                            <div v-if="element.atomicWeight" class="text-xs">
                                {{ translate({de: 'Atomgewicht', en: 'Atomic Weight'}) }}: {{ element.atomicWeight }}
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Laboratory Equipment -->
            <div class="mb-3 sm:mb-6 p-3 sm:p-4 rounded-lg shadow-md"
                 :class="darkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200'">
                <h2 class="text-lg sm:text-xl font-bold mb-2 sm:mb-3">{{ translate({
                    de: 'Laborgeräte',
                    en: 'Laboratory Equipment'
                }) }}</h2>
                <div class="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-2 sm:gap-3">
                    <div v-for="equipment in availableEquipment" :key="equipment.id"
                         class="lab-equipment cursor-grab p-2 sm:p-3 rounded-lg shadow-md transition-all relative text-xs sm:text-sm"
                         :class="getElementClass(equipment)"
                         draggable="true"
                         @dragstart="onDragStart($event, equipment, null, 'equipment')"
                         @click="addEquipment(equipment)">
                        <div class="font-bold text-base sm:text-lg">{{ equipment.symbol }}</div>
                        <div class="text-xs break-word">{{ equipment.name }}</div>
                        <div class="tooltip" :class="darkMode ? 'bg-gray-700' : 'bg-white text-gray-800'">
                            <h4 class="font-bold text-xs sm:text-sm">{{ equipment.name }}</h4>
                            <p class="text-xs mt-1">{{ equipment.description }}</p>
                            <div class="text-xs mt-1 italic">
                                {{ translate({de: 'Ermöglicht', en: 'Enables'}) }}: {{ equipment.enables.join(', ') }}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Discoveries Tab -->
        <div v-if="activeTab === 'discoveries'" class="tab-content active">
            <!-- Discovered Items -->
            <div class="p-3 sm:p-4 rounded-lg shadow-md"
                 :class="darkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200'">
                <div class="flex justify-between items-center mb-2 sm:mb-3">
                    <h2 class="text-lg sm:text-xl font-bold">{{ translate({de: 'Entdeckungen', en: 'Discoveries'}) }}
                        ({{ discoveredItems.length }}/{{ recipeCount }})</h2>
                    <div class="text-xs sm:text-sm px-2 sm:px-3 py-1 rounded-full"
                         :class="darkMode ? 'bg-gray-700' : 'bg-blue-100 text-blue-800'">
                        {{ translate({de: 'Level', en: 'Level'}) }}: {{ playerLevel }}
                    </div>
                </div>

                <!-- Discovery Category Filters -->
                <div class="mb-2 sm:mb-4 flex flex-wrap gap-1 sm:gap-2">
                    <button
                            @click="discoveryFilter = 'all'"
                            class="px-2 py-1 text-xs sm:text-sm rounded-md transition-colors"
                            :class="discoveryFilter === 'all' ? (darkMode ? 'bg-blue-600' : 'bg-blue-500 text-white') : (darkMode ? 'bg-gray-700' : 'bg-gray-200')"
                    >
                        {{ translate({de: 'Alle', en: 'All'}) }}
                    </button>
                    <button
                            @click="discoveryFilter = 'element'"
                            class="px-2 py-1 text-xs sm:text-sm rounded-md transition-colors"
                            :class="discoveryFilter === 'element' ? (darkMode ? 'bg-blue-600' : 'bg-blue-500 text-white') : (darkMode ? 'bg-gray-700' : 'bg-gray-200')"
                    >
                        {{ translate({de: 'Elemente', en: 'Elements'}) }}
                    </button>
                    <button
                            @click="discoveryFilter = 'molecule'"
                            class="px-2 py-1 text-xs sm:text-sm rounded-md transition-colors"
                            :class="discoveryFilter === 'molecule' ? (darkMode ? 'bg-blue-600' : 'bg-blue-500 text-white') : (darkMode ? 'bg-gray-700' : 'bg-gray-200')"
                    >
                        {{ translate({de: 'Moleküle', en: 'Molecules'}) }}
                    </button>
                    <button
                            @click="discoveryFilter = 'compound'"
                            class="px-2 py-1 text-xs sm:text-sm rounded-md transition-colors"
                            :class="discoveryFilter === 'compound' ? (darkMode ? 'bg-blue-600' : 'bg-blue-500 text-white') : (darkMode ? 'bg-gray-700' : 'bg-gray-200')"
                    >
                        {{ translate({de: 'Verbindungen', en: 'Compounds'}) }}
                    </button>
                    <button
                            @click="discoveryFilter = 'mixture'"
                            class="px-2 py-1 text-xs sm:text-sm rounded-md transition-colors"
                            :class="discoveryFilter === 'mixture' ? (darkMode ? 'bg-blue-600' : 'bg-blue-500 text-white') : (darkMode ? 'bg-gray-700' : 'bg-gray-200')"
                    >
                        {{ translate({de: 'Gemische', en: 'Mixtures'}) }}
                    </button>
                    <button
                            @click="discoveryFilter = 'reaction'"
                            class="px-2 py-1 text-xs sm:text-sm rounded-md transition-colors"
                            :class="discoveryFilter === 'reaction' ? (darkMode ? 'bg-blue-600' : 'bg-blue-500 text-white') : (darkMode ? 'bg-gray-700' : 'bg-gray-200')"
                    >
                        {{ translate({de: 'Reaktionen', en: 'Reactions'}) }}
                    </button>
                </div>

                <!-- Search bar -->
                <div class="mb-2 sm:mb-4">
                    <input
                            type="text"
                            v-model="searchQuery"
                            :placeholder="translate({ de: 'Suche nach Entdeckungen...', en: 'Search discoveries...' })"
                            class="w-full p-2 rounded-md text-sm"
                            :class="darkMode ? 'bg-gray-700 border-gray-600' : 'bg-white border-gray-300'"
                    >
                </div>

                <div v-if="filteredDiscoveries.length === 0"
                     class="text-center py-6 sm:py-8 text-gray-500 italic text-sm">
            <span v-if="discoveredItems.length === 0">
              {{ translate({
                de: 'Noch keine Entdeckungen gemacht. Kombiniere Elemente, um zu beginnen!',
                en: 'No discoveries yet. Combine elements to start!'
            }) }}
            </span>
                    <span v-else>
              {{ translate({
                        de: 'Keine Entdeckungen entsprechen deinen Filterkriterien.',
                        en: 'No discoveries match your filter criteria.'
                    }) }}
            </span>
                </div>

                <div v-else class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-2 sm:gap-3">
                    <div v-for="item in filteredDiscoveries" :key="item.id"
                         class="discovered-item cursor-grab p-2 sm:p-3 rounded-lg shadow-md relative text-xs sm:text-sm"
                         :class="[getElementClass(item), {'new-discovery': newlyDiscovered.includes(item.id)}]"
                         draggable="true"
                         @dragstart="onDragStart($event, item, null, 'discoveries')"
                         @click="showDiscoveryDetails(item)">
                        <div class="font-bold text-base sm:text-lg">{{ item.symbol }}</div>
                        <div class="text-xs">{{ item.name }}</div>
                        <div class="text-xs mt-1 opacity-70 line-clamp-2">{{ item.description }}</div>
                        <div v-if="item.state" class="text-xs mt-1 italic">
                            {{ translate({de: 'Zustand', en: 'State'}) }}: {{ translateState(item.state) }}
                        </div>
                    </div>
                </div>

                <!-- Pagination Controls -->
                <div v-if="filteredDiscoveries.length > itemsPerPage" class="mt-4 sm:mt-6 flex justify-center">
                    <div class="flex space-x-1 sm:space-x-2">
                        <button
                                @click="currentPage = Math.max(1, currentPage - 1)"
                                :disabled="currentPage === 1"
                                class="px-2 sm:px-3 py-1 rounded text-xs sm:text-sm"
                                :class="currentPage === 1 ? 'opacity-50 cursor-not-allowed' : 'hover:bg-gray-200 dark:hover:bg-gray-700'"
                        >
                            {{ translate({de: 'Zurück', en: 'Previous'}) }}
                        </button>
                        <div class="flex space-x-1">
                            <button
                                    v-for="page in paginationPages"
                                    :key="page"
                                    @click="currentPage = page"
                                    class="w-6 h-6 sm:w-8 sm:h-8 flex items-center justify-center rounded text-xs sm:text-sm"
                                    :class="currentPage === page ? (darkMode ? 'bg-blue-600' : 'bg-blue-500 text-white') : 'hover:bg-gray-200 dark:hover:bg-gray-700'"
                            >
                                {{ page }}
                            </button>
                        </div>
                        <button
                                @click="currentPage = Math.min(totalPages, currentPage + 1)"
                                :disabled="currentPage === totalPages"
                                class="px-2 sm:px-3 py-1 rounded text-xs sm:text-sm"
                                :class="currentPage === totalPages ? 'opacity-50 cursor-not-allowed' : 'hover:bg-gray-200 dark:hover:bg-gray-700'"
                        >
                            {{ translate({de: 'Weiter', en: 'Next'}) }}
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Periodic Table Tab -->
        <div v-if="activeTab === 'elements'" class="tab-content active">
            <div class="p-3 sm:p-4 rounded-lg shadow-md"
                 :class="darkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200'">
                <h2 class="text-lg sm:text-xl font-bold mb-2">{{ translate({
                    de: 'Periodensystem der Elemente',
                    en: 'Periodic Table of Elements'
                }) }}</h2>
                <p class="mb-3 text-xs sm:text-sm">{{ translate({
                    de: 'Klicke auf ein Element für mehr Informationen.',
                    en: 'Click on an element to learn more.'
                }) }}</p>

                <!-- Simplified Periodic Table - Mobile Optimized -->
                <div class="overflow-x-auto pb-2">
                    <div class="grid grid-cols-18 gap-1 min-w-[600px]">
                        <!-- First Row -->
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(1)" @click="showElementInfo(1)">
                            <div class="text-xs font-bold">H</div>
                            <div class="text-xs">1</div>
                        </div>
                        <div class="col-span-16"></div>
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(2)" @click="showElementInfo(2)">
                            <div class="text-xs font-bold">He</div>
                            <div class="text-xs">2</div>
                        </div>

                        <!-- Second Row -->
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(3)" @click="showElementInfo(3)">
                            <div class="text-xs font-bold">Li</div>
                            <div class="text-xs">3</div>
                        </div>
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(4)" @click="showElementInfo(4)">
                            <div class="text-xs font-bold">Be</div>
                            <div class="text-xs">4</div>
                        </div>
                        <div class="col-span-10"></div>
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(5)" @click="showElementInfo(5)">
                            <div class="text-xs font-bold">B</div>
                            <div class="text-xs">5</div>
                        </div>
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(6)" @click="showElementInfo(6)">
                            <div class="text-xs font-bold">C</div>
                            <div class="text-xs">6</div>
                        </div>
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(7)" @click="showElementInfo(7)">
                            <div class="text-xs font-bold">N</div>
                            <div class="text-xs">7</div>
                        </div>
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(8)" @click="showElementInfo(8)">
                            <div class="text-xs font-bold">O</div>
                            <div class="text-xs">8</div>
                        </div>
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(9)" @click="showElementInfo(9)">
                            <div class="text-xs font-bold">F</div>
                            <div class="text-xs">9</div>
                        </div>
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(10)" @click="showElementInfo(10)">
                            <div class="text-xs font-bold">Ne</div>
                            <div class="text-xs">10</div>
                        </div>

                        <!-- Third Row -->
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(11)" @click="showElementInfo(11)">
                            <div class="text-xs font-bold">Na</div>
                            <div class="text-xs">11</div>
                        </div>
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(12)" @click="showElementInfo(12)">
                            <div class="text-xs font-bold">Mg</div>
                            <div class="text-xs">12</div>
                        </div>
                        <div class="col-span-10"></div>
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(13)" @click="showElementInfo(13)">
                            <div class="text-xs font-bold">Al</div>
                            <div class="text-xs">13</div>
                        </div>
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(14)" @click="showElementInfo(14)">
                            <div class="text-xs font-bold">Si</div>
                            <div class="text-xs">14</div>
                        </div>
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(15)" @click="showElementInfo(15)">
                            <div class="text-xs font-bold">P</div>
                            <div class="text-xs">15</div>
                        </div>
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(16)" @click="showElementInfo(16)">
                            <div class="text-xs font-bold">S</div>
                            <div class="text-xs">16</div>
                        </div>
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(17)" @click="showElementInfo(17)">
                            <div class="text-xs font-bold">Cl</div>
                            <div class="text-xs">17</div>
                        </div>
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(18)" @click="showElementInfo(18)">
                            <div class="text-xs font-bold">Ar</div>
                            <div class="text-xs">18</div>
                        </div>

                        <!-- Fourth Row (partial) -->
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(19)" @click="showElementInfo(19)">
                            <div class="text-xs font-bold">K</div>
                            <div class="text-xs">19</div>
                        </div>
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(20)" @click="showElementInfo(20)">
                            <div class="text-xs font-bold">Ca</div>
                            <div class="text-xs">20</div>
                        </div>
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(26)" @click="showElementInfo(26)">
                            <div class="text-xs font-bold">Fe</div>
                            <div class="text-xs">26</div>
                        </div>
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(29)" @click="showElementInfo(29)">
                            <div class="text-xs font-bold">Cu</div>
                            <div class="text-xs">29</div>
                        </div>
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(30)" @click="showElementInfo(30)">
                            <div class="text-xs font-bold">Zn</div>
                            <div class="text-xs">30</div>
                        </div>
                        <div class="col-span-7"></div>
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(35)" @click="showElementInfo(35)">
                            <div class="text-xs font-bold">Br</div>
                            <div class="text-xs">35</div>
                        </div>
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(36)" @click="showElementInfo(36)">
                            <div class="text-xs font-bold">Kr</div>
                            <div class="text-xs">36</div>
                        </div>

                        <!-- Fifth Row (partial - just the most important elements) -->
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(47)" @click="showElementInfo(47)">
                            <div class="text-xs font-bold">Ag</div>
                            <div class="text-xs">47</div>
                        </div>
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(53)" @click="showElementInfo(53)">
                            <div class="text-xs font-bold">I</div>
                            <div class="text-xs">53</div>
                        </div>
                        <div class="col-span-16"></div>

                        <!-- Sixth Row (partial - just Au and Hg) -->
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(79)" @click="showElementInfo(79)">
                            <div class="text-xs font-bold">Au</div>
                            <div class="text-xs">79</div>
                        </div>
                        <div class="element p-1 rounded-sm text-center cursor-pointer"
                             :class="getPeriodicElementClass(80)" @click="showElementInfo(80)">
                            <div class="text-xs font-bold">Hg</div>
                            <div class="text-xs">80</div>
                        </div>
                        <div class="col-span-16"></div>
                    </div>
                </div>

                <!-- Element information (when clicking on periodic table) -->
                <div v-if="selectedElement" class="mt-4 p-3 sm:p-4 rounded-lg"
                     :class="darkMode ? 'bg-gray-700' : 'bg-blue-50'">
                    <div class="flex justify-between items-start">
                        <div>
                            <div class="flex items-baseline">
                                <h3 class="text-base sm:text-xl font-bold">{{ selectedElement.name }}</h3>
                                <span class="ml-2 text-xs sm:text-sm opacity-70">{{ selectedElement.symbol }}</span>
                            </div>
                            <div class="grid grid-cols-1 sm:grid-cols-2 mt-2 gap-y-1 sm:gap-y-2 text-xs sm:text-sm">
                                <div class="text-xs sm:text-sm">
                                    {{ translate({de: 'Ordnungszahl', en: 'Atomic Number'}) }}:
                                    {{ selectedElement.atomicNumber }}
                                </div>
                                <div class="text-xs sm:text-sm">
                                    {{ translate({de: 'Atomgewicht', en: 'Atomic Weight'}) }}:
                                    {{ selectedElement.atomicWeight }}
                                </div>
                                <div class="text-xs sm:text-sm">
                                    {{ translate({de: 'Kategorie', en: 'Category'}) }}: {{ selectedElement.category }}
                                </div>
                                <div class="text-xs sm:text-sm">
                                    {{ translate({de: 'Phase bei RT', en: 'Phase at RT'}) }}:
                                    {{ translateState(selectedElement.phase) }}
                                </div>
                            </div>
                            <p class="mt-2 text-xs sm:text-sm">{{ selectedElement.description }}</p>
                        </div>
                        <button @click="selectedElement = null" class="text-gray-500 hover:text-gray-700">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 sm:h-5 sm:w-5" fill="none"
                                 viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                      d="M6 18L18 6M6 6l12 12"/>
                            </svg>
                        </button>
                    </div>
                    <div class="mt-3 sm:mt-4">
                        <button
                                v-if="isElementAvailable(selectedElement.symbol)"
                                @click="addElementToWorkspace(selectedElement.symbol)"
                                class="px-2 py-1 text-xs sm:text-sm rounded-md"
                                :class="darkMode ? 'bg-green-600 hover:bg-green-500' : 'bg-green-500 text-white hover:bg-green-600'"
                        >
                            {{ translate({de: 'Zum Arbeitsbereich hinzufügen', en: 'Add to Workspace'}) }}
                        </button>
                        <div v-else class="text-xs sm:text-sm text-yellow-500">
                            {{ translate({
                            de: 'Entdecke dieses Element, um es zu nutzen',
                            en: 'Discover this element to use it'
                        }) }}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Game Progress Footer -->
    <footer class="fixed bottom-0 left-0 right-0 p-2 sm:p-3 z-30"
            :class="darkMode ? 'bg-gray-800 border-t border-gray-700' : 'bg-white border-t border-gray-200 shadow-md'">
        <div class="container mx-auto">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-1 sm:space-x-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 sm:h-5 sm:w-5"
                         :class="darkMode ? 'text-yellow-400' : 'text-yellow-500'" viewBox="0 0 20 20"
                         fill="currentColor">
                        <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118l-2.8-2.034c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                    </svg>
                    <span class="text-xs sm:text-sm">{{ Math.round((discoveredItems.length / recipeCount) * 100)
                        }}%</span>
                </div>

                <div class="w-1/3 sm:w-1/2 bg-gray-300 rounded-full h-2 sm:h-2.5 overflow-hidden">
                    <div class="h-full rounded-full"
                         :style="{ width: `${Math.round((discoveredItems.length / recipeCount) * 100)}%` }"
                         :class="darkMode ? 'bg-green-500' : 'bg-blue-600'"></div>
                </div>

                <div class="text-xs sm:text-sm">
                    {{ translate({de: 'Nächstes Level', en: 'Next Level'}) }}: {{ currentLevelProgress
                    }}/{{ currentLevelTarget }}
                </div>
            </div>
        </div>
    </footer>

    <!-- Modals -->
    <!-- Missions Modal -->
    <div v-if="showMissionsModal"
         class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto modal-content">
            <div class="p-4 sm:p-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-lg sm:text-xl font-bold">{{ translate({
                        de: 'Missionen & Errungenschaften',
                        en: 'Missions & Achievements'
                    }) }}</h2>
                    <button @click="showMissionsModal = false" class="text-gray-500 hover:text-gray-700">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 sm:h-6 sm:w-6" fill="none"
                             viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>

                <div class="mb-4">
                    <h3 class="font-semibold text-base sm:text-lg mb-2">{{ translate({
                        de: 'Aktuelle Missionen',
                        en: 'Current Missions'
                    }) }}</h3>
                    <div v-if="availableMissions.length === 0" class="text-center py-4 italic text-gray-500 text-sm">
                        {{ translate({
                        de: 'Keine Missionen verfügbar. Entdecke mehr Verbindungen, um neue Missionen freizuschalten!',
                        en: 'No missions available. Discover more compounds to unlock new missions!'
                    }) }}
                    </div>
                    <div v-else>
                        <div v-for="mission in availableMissions" :key="mission.id"
                             class="mb-3 p-3 rounded-lg text-sm"
                             :class="darkMode ? 'bg-gray-700' : 'bg-gray-100'">
                            <div class="flex justify-between">
                                <h4 class="font-semibold">{{ mission.title }}</h4>
                                <span class="text-xs px-2 py-0.5 rounded-full"
                                      :class="mission.completed ? 'bg-green-500 text-white' : (darkMode ? 'bg-gray-600' : 'bg-gray-300')">
            {{ mission.completed ? translate({de: 'Abgeschlossen', en: 'Completed'}) : translate({
                                    de: 'Offen',
                                    en: 'Open'
                                }) }}
        </span>
                            </div>
                            <p class="text-xs sm:text-sm mt-1">{{ mission.description }}</p>
                            <div class="mt-2 w-full bg-gray-300 dark:bg-gray-600 rounded-full h-2">
                                <div class="bg-blue-600 h-2 rounded-full"
                                     :style="{ width: `${calculateMissionProgress(mission)}%` }"></div>
                            </div>
                            <div class="flex justify-between mt-1 text-xs">
                                <span>{{ getMissionProgressText(mission) }}</span>
                                <span>{{ translate({de: 'Belohnung', en: 'Reward'}) }}: {{ mission.reward }}</span>
                            </div>

                            <!-- Mission Hints (collapsed by default) -->
                            <div v-if="!mission.completed" class="mt-2">
                                <button @click="mission.showHints = !mission.showHints" class="text-xs text-blue-500 flex items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 mr-1" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                    </svg>
                                    {{ mission.showHints ? translate({de: 'Hinweise ausblenden', en: 'Hide Hints'}) : translate({de: 'Hinweise anzeigen', en: 'Show Hints'}) }}
                                </button>

                                <div v-if="mission.showHints" class="mt-2 p-2 bg-blue-50 dark:bg-blue-900 rounded-md">
                                    <h5 class="text-xs font-semibold mb-1">{{ translate({de: 'Hinweise', en: 'Hints'}) }}:</h5>
                                    <ul class="space-y-1 list-disc pl-5 text-xs">
                                        <li v-for="(hint, idx) in getMissionHints(mission)" :key="idx">{{ hint }}</li>
                                    </ul>

                                    <h5 class="text-xs font-semibold mt-2 mb-1">{{ translate({de: 'Benötigte Zutaten', en: 'Required Ingredients'}) }}:</h5>
                                    <div v-for="req in mission.requirements" :key="req.id" class="mb-1">
                                        <div v-if="req.type === 'discover'" class="flex items-center text-xs">
                    <span :class="discoveredItems.some(item => item.id === req.id) ? 'line-through opacity-50' : ''">
                        {{ getElementSymbolById(req.id) }}:
                    </span>

                                            <div v-if="getMissionIngredients(mission, req.id)" class="flex items-center ml-2">
                        <span v-for="(ingredient, idx) in getMissionIngredients(mission, req.id).ingredients" :key="idx"
                              class="mx-1 px-1 rounded"
                              :class="isIngredientAvailable(ingredient) ? 'bg-green-100 dark:bg-green-800' : 'bg-red-100 dark:bg-red-800'">
                            {{ getElementSymbolById(ingredient) }}
                        </span>

                                                <span v-if="getMissionIngredients(mission, req.id).equipmentNeeded.length > 0" class="ml-2">
                            +
                            <span v-for="(eq, idx) in getMissionIngredients(mission, req.id).equipmentNeeded" :key="idx"
                                  class="mx-1 px-1 rounded"
                                  :class="activeEquipment.some(e => e.id === eq) ? 'bg-green-100 dark:bg-green-800' : 'bg-red-100 dark:bg-red-800'">
                                {{ getEquipmentNameById(eq) }}
                            </span>
                        </span>

                                                <span v-if="getMissionIngredients(mission, req.id).temperature" class="ml-2">
                            {{ translate({de: 'Temp', en: 'Temp'}) }}:
                            <span class="mx-1 px-1 rounded"
                                  :class="temperature >= getMissionIngredients(mission, req.id).temperature.min &&
                                         temperature <= getMissionIngredients(mission, req.id).temperature.max ?
                                         'bg-green-100 dark:bg-green-800' : 'bg-red-100 dark:bg-red-800'">
                                {{ getMissionIngredients(mission, req.id).temperature.min }}-{{ getMissionIngredients(mission, req.id).temperature.max }}°C
                            </span>
                        </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <button
                                    v-if="!mission.completed && !activeMission"
                                    @click="selectActiveMission(mission)"
                                    class="mt-2 px-2 py-1 text-xs sm:text-sm rounded-md bg-blue-500 text-white hover:bg-blue-600"
                            >
                                {{ translate({de: 'Aktivieren', en: 'Activate'}) }}
                            </button>
                            <button
                                    v-else-if="activeMission && activeMission.id === mission.id"
                                    @click="activeMission = null"
                                    class="mt-2 px-2 py-1 text-xs sm:text-sm rounded-md bg-gray-500 text-white hover:bg-gray-600"
                            >
                                {{ translate({de: 'Deaktivieren', en: 'Deactivate'}) }}
                            </button>
                        </div>
                    </div>
                </div>

                <div>
                    <h3 class="font-semibold text-base sm:text-lg mb-2">{{ translate({
                        de: 'Errungenschaften',
                        en: 'Achievements'
                    }) }}</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-2 sm:gap-3">
                        <div v-for="achievement in achievements" :key="achievement.id"
                             class="p-2 sm:p-3 rounded-lg text-sm"
                             :class="[
                     achievement.unlocked
                       ? (darkMode ? 'bg-green-800 bg-opacity-30' : 'bg-green-100')
                       : (darkMode ? 'bg-gray-700 opacity-70' : 'bg-gray-100 opacity-70')
                   ]">
                            <div class="flex items-center">
                                <div class="mr-2 sm:mr-3 text-xl sm:text-2xl" v-if="achievement.unlocked">🏆</div>
                                <div class="mr-2 sm:mr-3 text-xl sm:text-2xl" v-else>🔒</div>
                                <div>
                                    <h4 class="font-semibold text-xs sm:text-sm">{{ achievement.title }}</h4>
                                    <p class="text-xs mt-1">{{ achievement.description }}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Discovery Details Modal -->
    <div v-if="selectedDiscovery"
         class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="p-4 sm:p-6">
                <div class="flex justify-between items-center mb-4">
                    <div class="flex items-center">
                        <div class="w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center rounded-lg mr-3 sm:mr-4"
                             :class="getElementClass(selectedDiscovery)">
                            <span class="text-lg sm:text-xl font-bold">{{ selectedDiscovery.symbol }}</span>
                        </div>
                        <h2 class="text-lg sm:text-xl font-bold">{{ selectedDiscovery.name }}</h2>
                    </div>
                    <button @click="selectedDiscovery = null" class="text-gray-500 hover:text-gray-700">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 sm:h-6 sm:w-6" fill="none"
                             viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>

                <div class="mb-4">
                    <div class="grid grid-cols-2 gap-3 sm:gap-4 mb-4 text-sm">
                        <div>
                            <h3 class="text-xs sm:text-sm font-semibold opacity-70">{{ translate({
                                de: 'Kategorie',
                                en: 'Category'
                            }) }}</h3>
                            <p>{{ translateCategory(selectedDiscovery.category) }}</p>
                        </div>
                        <div v-if="selectedDiscovery.formula">
                            <h3 class="text-xs sm:text-sm font-semibold opacity-70">{{ translate({
                                de: 'Formel',
                                en: 'Formula'
                            }) }}</h3>
                            <p>{{ selectedDiscovery.formula }}</p>
                        </div>
                        <div v-if="selectedDiscovery.state">
                            <h3 class="text-xs sm:text-sm font-semibold opacity-70">{{ translate({
                                de: 'Zustand',
                                en: 'State'
                            }) }}</h3>
                            <p>{{ translateState(selectedDiscovery.state) }}</p>
                        </div>
                        <div v-if="selectedDiscovery.meltingPoint">
                            <h3 class="text-xs sm:text-sm font-semibold opacity-70">{{ translate({
                                de: 'Schmelzpunkt',
                                en: 'Melting Point'
                            }) }}</h3>
                            <p>{{ selectedDiscovery.meltingPoint }}°C</p>
                        </div>
                        <div v-if="selectedDiscovery.boilingPoint">
                            <h3 class="text-xs sm:text-sm font-semibold opacity-70">{{ translate({
                                de: 'Siedepunkt',
                                en: 'Boiling Point'
                            }) }}</h3>
                            <p>{{ selectedDiscovery.boilingPoint }}°C</p>
                        </div>
                    </div>

                    <div class="mb-4">
                        <h3 class="text-xs sm:text-sm font-semibold opacity-70">{{ translate({
                            de: 'Beschreibung',
                            en: 'Description'
                        }) }}</h3>
                        <p class="text-xs sm:text-sm">{{ selectedDiscovery.description }}</p>
                    </div>

                    <div v-if="getDiscoveryRecipe(selectedDiscovery)" class="mb-4">
                        <h3 class="text-xs sm:text-sm font-semibold opacity-70">{{ translate({
                            de: 'Herstellung',
                            en: 'Creation'
                        }) }}</h3>
                        <div class="mt-1 p-2 sm:p-3 rounded-lg text-xs sm:text-sm"
                             :class="darkMode ? 'bg-gray-700' : 'bg-gray-100'">
                            <div class="flex flex-wrap items-center">
                                <template v-for="(inputId, idx) in getDiscoveryRecipe(selectedDiscovery).inputs">
                                    <div v-if="idx > 0" class="mx-1 sm:mx-2">+</div>
                                    <div class="element py-1 px-2 rounded-md text-center text-xs"
                                         :class="getElementClassById(inputId)">
                                        {{ getElementSymbolById(inputId) }}
                                    </div>
                                </template>
                                <div class="mx-1 sm:mx-2">→</div>
                                <div class="element py-1 px-2 rounded-md text-center text-xs"
                                     :class="getElementClass(selectedDiscovery)">
                                    {{ selectedDiscovery.symbol }}
                                </div>
                            </div>
                            <div v-if="getDiscoveryRecipe(selectedDiscovery).requiredEquipment" class="mt-2 text-xs">
                                {{ translate({de: 'Benötigte Ausrüstung', en: 'Required Equipment'}) }}:
                                {{ getDiscoveryRecipe(selectedDiscovery).requiredEquipment.map(eq => getEquipmentNameById(eq)).join(', ')
                                }}
                            </div>
                            <div v-if="getDiscoveryRecipe(selectedDiscovery).requiredTemperature" class="mt-1 text-xs">
                                {{ translate({de: 'Benötigte Temperatur', en: 'Required Temperature'}) }}:
                                {{ getDiscoveryRecipe(selectedDiscovery).requiredTemperature.min }} -
                                {{ getDiscoveryRecipe(selectedDiscovery).requiredTemperature.max }}°C
                            </div>
                        </div>
                    </div>

                    <div v-if="getRelatedDiscoveries(selectedDiscovery).length > 0" class="mb-4">
                        <h3 class="text-xs sm:text-sm font-semibold opacity-70">
                            {{ translate({de: 'Verwandte Entdeckungen', en: 'Related Discoveries'}) }}</h3>
                        <div class="flex flex-wrap gap-1 sm:gap-2 mt-1">
                            <div v-for="item in getRelatedDiscoveries(selectedDiscovery)" :key="item.id"
                                 class="element py-1 px-2 rounded-md text-center cursor-pointer text-xs"
                                 :class="getElementClass(item)"
                                 @click="showDiscoveryDetails(item)">
                                {{ item.symbol }}
                            </div>
                        </div>
                    </div>
                </div>

                <div class="flex space-x-2 sm:space-x-3">
                    <button
                            @click="addToWorkspace(selectedDiscovery); selectedDiscovery = null"
                            class="px-3 py-1 sm:px-4 sm:py-2 bg-blue-500 text-white rounded hover:bg-blue-600 text-xs sm:text-sm"
                    >
                        {{ translate({de: 'Zum Arbeitsbereich hinzufügen', en: 'Add to Workspace'}) }}
                    </button>
                    <button
                            @click="selectedDiscovery = null"
                            class="px-3 py-1 sm:px-4 sm:py-2 bg-gray-300 dark:bg-gray-700 rounded hover:bg-gray-400 dark:hover:bg-gray-600 text-xs sm:text-sm"
                    >
                        {{ translate({de: 'Schließen', en: 'Close'}) }}
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Reaction Animation -->
    <div v-if="showReactionAnimation" class="reaction-animation">
        <div class="text-center p-4">
            <div class="text-3xl sm:text-4xl mb-3 sm:mb-4"
                 :class="{'bouncing': reactionResult.success, 'rotating': !reactionResult.success}">
                {{ reactionResult.symbol || '⚗️' }}
            </div>
            <h3 class="text-lg sm:text-xl font-bold text-white mb-2">{{ reactionResult.title }}</h3>
            <p class="text-white mb-3 sm:mb-4 text-sm sm:text-base">{{ reactionResult.message }}</p>
            <button
                    @click="showReactionAnimation = false"
                    class="px-3 py-1 sm:px-4 sm:py-2 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm sm:text-base"
            >
                {{ translate({de: 'Fortfahren', en: 'Continue'}) }}
            </button>
        </div>
    </div>
</div>

<script>
	function translate(translations) {
		const language = localStorage.getItem('elementcraft-language') || 'de';
		return translations[language] || translations['en'] || 'Translation missing';
	}

	const {createApp, ref, computed, onMounted, watch} = Vue;

	createApp({
		setup() {
			// Game state
			const darkMode = ref(localStorage.getItem('elementcraft-dark-mode') === 'true');
			const currentLanguage = ref(localStorage.getItem('elementcraft-language') || 'de');
			const workspace = ref([]);
			const discoveredItems = ref([]);
			const newlyDiscovered = ref([]);
			const notifications = ref([]);
			const showMissionsModal = ref(false);
			const playerLevel = ref(1);
			const currentLevelProgress = ref(0);
			const currentLevelTarget = computed(() => playerLevel.value * 5);
			const activeEquipment = ref([]);
			const temperature = ref(25); // Default room temperature
			const maxTemperature = ref(1000); // Maximum possible temperature
			const activeTab = ref('lab');
			const selectedDiscovery = ref(null);
			const selectedElement = ref(null);
			const currentPage = ref(1);
			const itemsPerPage = ref(15);
			const discoveryFilter = ref('all');
			const searchQuery = ref('');
			const activeMission = ref(null);
			const showReactionAnimation = ref(false);
			const reactionResult = ref({});

			// Tabs for the main interface
			const tabs = [
				{
					id: 'lab',
					name: translate({de: 'Labor', en: 'Laboratory'}),
					icon: {
						template: '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z" /></svg>'
					}
				},
				{
					id: 'elements',
					name: translate({de: 'Periodensystem', en: 'Periodic Table'}),
					icon: {
						template: '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z" /></svg>'
					}
				},
				{
					id: 'discoveries',
					name: translate({de: 'Entdeckungen', en: 'Discoveries'}),
					icon: {
						template: '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>'
					}
				}
			];

			// Basic elements that are always available
			const basicElements = ref([
				{
					id: 'H',
					symbol: 'H',
					name: translate({de: 'Wasserstoff', en: 'Hydrogen'}),
					category: 'element',
					color: 'blue',
					atomicNumber: 1,
					atomicWeight: 1.008,
					phase: 'gas',
					description: translate({
						de: 'Leichtestes Element, brennbar und sehr reaktiv.',
						en: 'Lightest element, flammable and highly reactive.'
					}),
					meltingPoint: -259.16,
					boilingPoint: -252.87
				},
				{
					id: 'O',
					symbol: 'O',
					name: translate({de: 'Sauerstoff', en: 'Oxygen'}),
					category: 'element',
					color: 'red',
					atomicNumber: 8,
					atomicWeight: 15.999,
					phase: 'gas',
					description: translate({
						de: 'Unterstützt Verbrennung, notwendig für Atmung.',
						en: 'Supports combustion, necessary for respiration.'
					}),
					meltingPoint: -218.79,
					boilingPoint: -182.95
				},
				{
					id: 'C',
					symbol: 'C',
					name: translate({de: 'Kohlenstoff', en: 'Carbon'}),
					category: 'element',
					color: 'gray',
					atomicNumber: 6,
					atomicWeight: 12.011,
					phase: 'solid',
					description: translate({
						de: 'Grundlage organischer Verbindungen, kommt in verschiedenen Allotropen vor.',
						en: 'Basis of organic compounds, exists in various allotropes.'
					}),
					meltingPoint: 3550,
					boilingPoint: 4027
				},
				{
					id: 'N',
					symbol: 'N',
					name: translate({de: 'Stickstoff', en: 'Nitrogen'}),
					category: 'element',
					color: 'green',
					atomicNumber: 7,
					atomicWeight: 14.007,
					phase: 'gas',
					description: translate({
						de: 'Hauptbestandteil der Erdatmosphäre, wichtig für Proteine.',
						en: 'Main component of Earth\'s atmosphere, important for proteins.'
					}),
					meltingPoint: -210.0,
					boilingPoint: -195.8
				},
				{
					id: 'Na',
					symbol: 'Na',
					name: translate({de: 'Natrium', en: 'Sodium'}),
					category: 'element',
					color: 'purple',
					atomicNumber: 11,
					atomicWeight: 22.990,
					phase: 'solid',
					description: translate({
						de: 'Silbrig-weißes, weiches Alkalimetall, reagiert heftig mit Wasser.',
						en: 'Silvery-white, soft alkali metal, reacts vigorously with water.'
					}),
					meltingPoint: 97.79,
					boilingPoint: 882.9
				},
				{
					id: 'Cl',
					symbol: 'Cl',
					name: translate({de: 'Chlor', en: 'Chlorine'}),
					category: 'element',
					color: 'yellow',
					atomicNumber: 17,
					atomicWeight: 35.45,
					phase: 'gas',
					description: translate({
						de: 'Gelblich-grünes Gas, stark oxidierend, wird zur Wasseraufbereitung verwendet.',
						en: 'Yellowish-green gas, strongly oxidizing, used for water treatment.'
					}),
					meltingPoint: -101.5,
					boilingPoint: -34.04
				},
				{
					id: 'Fe',
					symbol: 'Fe',
					name: translate({de: 'Eisen', en: 'Iron'}),
					category: 'element',
					color: 'orange',
					atomicNumber: 26,
					atomicWeight: 55.845,
					phase: 'solid',
					description: translate({
						de: 'Häufigstes Übergangselement, magnetisch, grundlegendes Metall für Industrie.',
						en: 'Most common transition element, magnetic, fundamental metal for industry.'
					}),
					meltingPoint: 1538,
					boilingPoint: 2862
				},
				{
					id: 'S',
					symbol: 'S',
					name: translate({de: 'Schwefel', en: 'Sulfur'}),
					category: 'element',
					color: 'yellow',
					atomicNumber: 16,
					atomicWeight: 32.06,
					phase: 'solid',
					description: translate({
						de: 'Gelber, spröder Nichtmetall mit charakteristischem Geruch.',
						en: 'Yellow, brittle non-metal with a characteristic odor.'
					}),
					meltingPoint: 115.21,
					boilingPoint: 444.61
				},
				{
					id: 'P',
					symbol: 'P',
					name: translate({de: 'Phosphor', en: 'Phosphorus'}),
					category: 'element',
					color: 'red',
					atomicNumber: 15,
					atomicWeight: 30.974,
					phase: 'solid',
					description: translate({
						de: 'Nichtmetallisches Element mit mehreren Allotropen, hohe Reaktivität.',
						en: 'Non-metallic element with several allotropes, highly reactive.'
					}),
					meltingPoint: 44.1,
					boilingPoint: 280.5
				},
				{
					id: 'Si',
					symbol: 'Si',
					name: translate({de: 'Silizium', en: 'Silicon'}),
					category: 'element',
					color: 'gray',
					atomicNumber: 14,
					atomicWeight: 28.085,
					phase: 'solid',
					description: translate({
						de: 'Halbmetall, wichtig für Elektronik und als Bestandteil von Glas.',
						en: 'Metalloid, important for electronics and as a component of glass.'
					}),
					meltingPoint: 1414,
					boilingPoint: 3265
				}
			]);

			// Additional elements to be discovered
			const advancedElements = ref([
				{
					id: 'Cu',
					symbol: 'Cu',
					name: translate({de: 'Kupfer', en: 'Copper'}),
					category: 'element',
					color: 'brown',
					atomicNumber: 29,
					atomicWeight: 63.546,
					phase: 'solid',
					description: translate({
						de: 'Rötliches Metall, guter Leiter für Wärme und Elektrizität.',
						en: 'Reddish metal, good conductor of heat and electricity.'
					}),
					meltingPoint: 1084.62,
					boilingPoint: 2562
				},
				{
					id: 'Ag',
					symbol: 'Ag',
					name: translate({de: 'Silber', en: 'Silver'}),
					category: 'element',
					color: 'silver',
					atomicNumber: 47,
					atomicWeight: 107.868,
					phase: 'solid',
					description: translate({
						de: 'Glänzendes, weiches Edelmetall mit höchster elektrischer Leitfähigkeit.',
						en: 'Lustrous, soft precious metal with highest electrical conductivity.'
					}),
					meltingPoint: 961.78,
					boilingPoint: 2162
				},
				{
					id: 'Au',
					symbol: 'Au',
					name: translate({de: 'Gold', en: 'Gold'}),
					category: 'element',
					color: 'gold',
					atomicNumber: 79,
					atomicWeight: 196.967,
					phase: 'solid',
					description: translate({
						de: 'Glänzendes, gelbes Edelmetall, sehr beständig gegen Korrosion.',
						en: 'Lustrous, yellow precious metal, highly resistant to corrosion.'
					}),
					meltingPoint: 1064.18,
					boilingPoint: 2856
				},
				{
					id: 'Hg',
					symbol: 'Hg',
					name: translate({de: 'Quecksilber', en: 'Mercury'}),
					category: 'element',
					color: 'silver',
					atomicNumber: 80,
					atomicWeight: 200.59,
					phase: 'liquid',
					description: translate({
						de: 'Silbriges Metall, flüssig bei Raumtemperatur, giftig.',
						en: 'Silvery metal, liquid at room temperature, toxic.'
					}),
					meltingPoint: -38.83,
					boilingPoint: 356.73
				},
				{
					id: 'He',
					symbol: 'He',
					name: translate({de: 'Helium', en: 'Helium'}),
					category: 'element',
					color: 'yellow',
					atomicNumber: 2,
					atomicWeight: 4.0026,
					phase: 'gas',
					description: translate({
						de: 'Leichtes, inertes Edelgas, bekannt für seinen Einsatz in Ballons.',
						en: 'Light, inert noble gas, known for its use in balloons.'
					}),
					meltingPoint: -272.2,
					boilingPoint: -268.93
				},
				{
					id: 'F',
					symbol: 'F',
					name: translate({de: 'Fluor', en: 'Fluorine'}),
					category: 'element',
					color: 'green',
					atomicNumber: 9,
					atomicWeight: 18.998,
					phase: 'gas',
					description: translate({
						de: 'Blass-gelbes Gas, höchst reaktiv, bildet starke Bindungen mit fast allen Elementen.',
						en: 'Pale yellow gas, highly reactive, forms strong bonds with nearly all elements.'
					}),
					meltingPoint: -219.67,
					boilingPoint: -188.11
				},
				{
					id: 'Br',
					symbol: 'Br',
					name: translate({de: 'Brom', en: 'Bromine'}),
					category: 'element',
					color: 'red',
					atomicNumber: 35,
					atomicWeight: 79.904,
					phase: 'liquid',
					description: translate({
						de: 'Rötlich-braune Flüssigkeit, einziges nichtmetallische Element, das bei Raumtemperatur flüssig ist.',
						en: 'Reddish-brown liquid, only non-metallic element that is liquid at room temperature.'
					}),
					meltingPoint: -7.2,
					boilingPoint: 58.8
				},
				{
					id: 'I',
					symbol: 'I',
					name: translate({de: 'Iod', en: 'Iodine'}),
					category: 'element',
					color: 'purple',
					atomicNumber: 53,
					atomicWeight: 126.90,
					phase: 'solid',
					description: translate({
						de: 'Glänzender, violett-schwarzer Feststoff, der bei Erhitzen sublimiert und violette Dämpfe bildet.',
						en: 'Lustrous, violet-black solid that sublimes upon heating forming purple vapors.'
					}),
					meltingPoint: 113.7,
					boilingPoint: 184.3
				},
				{
					id: 'Zn',
					symbol: 'Zn',
					name: translate({de: 'Zink', en: 'Zinc'}),
					category: 'element',
					color: 'blue',
					atomicNumber: 30,
					atomicWeight: 65.38,
					phase: 'solid',
					description: translate({
						de: 'Bläulich-weißes Metall, wird für Galvanisierung und in Legierungen verwendet.',
						en: 'Bluish-white metal, used for galvanizing and in alloys.'
					}),
					meltingPoint: 419.53,
					boilingPoint: 907
				},
				{
					id: 'Sn',
					symbol: 'Sn',
					name: translate({de: 'Zinn', en: 'Tin'}),
					category: 'element',
					color: 'silver',
					atomicNumber: 50,
					atomicWeight: 118.71,
					phase: 'solid',
					description: translate({
						de: 'Silbriges, weiches Metall, resistent gegen Korrosion, verwendet in Legierungen und Lötmaterialien.',
						en: 'Silvery, soft metal, resistant to corrosion, used in alloys and soldering materials.'
					}),
					meltingPoint: 231.93,
					boilingPoint: 2602
				},
				{
					id: 'K',
					symbol: 'K',
					name: translate({de: 'Kalium', en: 'Potassium'}),
					category: 'element',
					color: 'purple',
					atomicNumber: 19,
					atomicWeight: 39.098,
					phase: 'solid',
					description: translate({
						de: 'Silbriges, weiches Alkalimetall, reagiert heftig mit Wasser, wichtig für Lebewesen.',
						en: 'Silvery, soft alkali metal, reacts vigorously with water, important for living organisms.'
					}),
					meltingPoint: 63.38,
					boilingPoint: 759
				},
				{
					id: 'Ca',
					symbol: 'Ca',
					name: translate({de: 'Calcium', en: 'Calcium'}),
					category: 'element',
					color: 'white',
					atomicNumber: 20,
					atomicWeight: 40.078,
					phase: 'solid',
					description: translate({
						de: 'Silberweißes Erdalkalimetall, wichtig für Knochen und Zähne, reagiert mit Wasser.',
						en: 'Silvery-white alkaline earth metal, important for bones and teeth, reacts with water.'
					}),
					meltingPoint: 842,
					boilingPoint: 1484
				},
				{
					id: 'Ar',
					symbol: 'Ar',
					name: translate({de: 'Argon', en: 'Argon'}),
					category: 'element',
					color: 'purple',
					atomicNumber: 18,
					atomicWeight: 39.948,
					phase: 'gas',
					description: translate({
						de: 'Farbloses, inertes Edelgas, wird als Schutzgas und in Glühbirnen verwendet.',
						en: 'Colorless, inert noble gas, used as shielding gas and in light bulbs.'
					}),
					meltingPoint: -189.35,
					boilingPoint: -185.85
				}
			]);

			// Laboratory equipment
			const availableEquipment = ref([
				{
					id: 'bunsen_burner',
					symbol: '🔥',
					name: translate({de: 'Bunsenbrenner', en: 'Bunsen Burner'}),
					category: 'equipment',
					color: 'red',
					description: translate({
						de: 'Erzeugt eine heiße Flamme für Experimente, die hohe Temperaturen erfordern.',
						en: 'Creates a hot flame for experiments requiring high temperatures.'
					}),
					enables: [translate({de: 'Erhitzen', en: 'Heating'}), translate({
						de: 'Verbrennung',
						en: 'Combustion'
					})]
				},
				{
					id: 'test_tube',
					symbol: '🧪',
					name: translate({de: 'Reagenzglas', en: 'Test Tube'}),
					category: 'equipment',
					color: 'blue',
					description: translate({
						de: 'Schmaler Glasbehälter für kleine Experimente und Reaktionen.',
						en: 'Narrow glass container for small experiments and reactions.'
					}),
					enables: [translate({de: 'Mischen', en: 'Mixing'}), translate({
						de: 'Kleine Reaktionen',
						en: 'Small Reactions'
					})]
				},
				{
					id: 'beaker',
					symbol: '🧫',
					name: translate({de: 'Becherglas', en: 'Beaker'}),
					category: 'equipment',
					color: 'cyan',
					description: translate({
						de: 'Größerer Behälter für Flüssigkeiten und größere Reaktionen.',
						en: 'Larger container for liquids and bigger reactions.'
					}),
					enables: [translate({
						de: 'Größere Mengen',
						en: 'Larger Volumes'
					}), translate({de: 'Komplexe Mischungen', en: 'Complex Mixtures'})]
				},
				{
					id: 'scale',
					symbol: '⚖️',
					name: translate({de: 'Waage', en: 'Scale'}),
					category: 'equipment',
					color: 'purple',
					description: translate({
						de: 'Misst die Masse von Substanzen für präzise Experimente.',
						en: 'Measures the mass of substances for precise experiments.'
					}),
					enables: [translate({
						de: 'Präzise Messungen',
						en: 'Precise Measurements'
					}), translate({de: 'Stöchiometrie', en: 'Stoichiometry'})]
				},
				{
					id: 'filter',
					symbol: '🧻',
					name: translate({de: 'Filter', en: 'Filter'}),
					category: 'equipment',
					color: 'white',
					description: translate({
						de: 'Trennt Feststoffe von Flüssigkeiten durch Filtration.',
						en: 'Separates solids from liquids through filtration.'
					}),
					enables: [translate({de: 'Filtration', en: 'Filtration'}), translate({
						de: 'Trennung',
						en: 'Separation'
					})]
				},
				{
					id: 'electricity',
					symbol: '⚡',
					name: translate({de: 'Elektrizität', en: 'Electricity'}),
					category: 'equipment',
					color: 'yellow',
					description: translate({
						de: 'Liefert elektrischen Strom für Elektrolyse und andere elektrochemische Prozesse.',
						en: 'Provides electric current for electrolysis and other electrochemical processes.'
					}),
					enables: [translate({de: 'Elektrolyse', en: 'Electrolysis'}), translate({
						de: 'Elektrochemie',
						en: 'Electrochemistry'
					})]
				},
				{
					id: 'uv_light',
					symbol: '☀️',
					name: translate({de: 'UV-Licht', en: 'UV Light'}),
					category: 'equipment',
					color: 'purple',
					description: translate({
						de: 'Bestrahlt Proben mit ultraviolettem Licht für photochemische Reaktionen.',
						en: 'Irradiates samples with ultraviolet light for photochemical reactions.'
					}),
					enables: [translate({de: 'Photochemie', en: 'Photochemistry'}), translate({
						de: 'UV-Katalyse',
						en: 'UV Catalysis'
					})]
				},
				{
					id: 'catalyst',
					symbol: '✨',
					name: translate({de: 'Katalysator', en: 'Catalyst'}),
					category: 'equipment',
					color: 'green',
					description: translate({
						de: 'Beschleunigt chemische Reaktionen ohne selbst verbraucht zu werden.',
						en: 'Accelerates chemical reactions without being consumed.'
					}),
					enables: [translate({
						de: 'Beschleunigte Reaktionen',
						en: 'Accelerated Reactions'
					}), translate({de: 'Niedrigere Aktivierungsenergie', en: 'Lower Activation Energy'})]
				},
				{
					id: 'distillation',
					symbol: '🔄',
					name: translate({de: 'Destillationsapparat', en: 'Distillation Apparatus'}),
					category: 'equipment',
					color: 'blue',
					description: translate({
						de: 'Trennt Flüssigkeiten auf Basis ihrer unterschiedlichen Siedepunkte.',
						en: 'Separates liquids based on their different boiling points.'
					}),
					enables: [translate({
						de: 'Destillation',
						en: 'Distillation'
					}), translate({de: 'Trennung von Flüssigkeiten', en: 'Liquid Separation'})]
				}
			]);

			// All possible combinations/recipes in the game (significantly expanded)
			const recipes = ref([
				// Basic combinations
				{
					inputs: ['H', 'H'],
					output: {
						id: 'H2',
						symbol: 'H₂',
						name: translate({de: 'Wasserstoffgas', en: 'Hydrogen Gas'}),
						description: translate({
							de: 'Leichtestes Element, brennbar und potenzieller Kraftstoff.',
							en: 'Lightest element, flammable and potential fuel.'
						}),
						category: 'molecule',
						color: 'blue',
						formula: 'H₂',
						state: 'gas'
					}
				},
				{
					inputs: ['O', 'O'],
					output: {
						id: 'O2',
						symbol: 'O₂',
						name: translate({de: 'Sauerstoffgas', en: 'Oxygen Gas'}),
						description: translate({
							de: 'Notwendig zum Atmen und für Verbrennungsreaktionen.',
							en: 'Necessary for breathing and combustion reactions.'
						}),
						category: 'molecule',
						color: 'red',
						formula: 'O₂',
						state: 'gas'
					}
				},
				{
					inputs: ['H', 'H', 'O'],
					output: {
						id: 'H2O',
						symbol: 'H₂O',
						name: translate({de: 'Wasser', en: 'Water'}),
						description: translate({
							de: 'Die grundlegende Verbindung des Lebens, Lösungsmittel für viele Reaktionen.',
							en: 'The fundamental compound of life, solvent for many reactions.'
						}),
						category: 'molecule',
						color: 'blue',
						formula: 'H₂O',
						state: 'liquid'
					}
				},
				{
					inputs: ['H', 'Cl'],
					output: {
						id: 'HCl',
						symbol: 'HCl',
						name: translate({de: 'Salzsäure', en: 'Hydrochloric Acid'}),
						description: translate({
							de: 'Eine starke Säure, die in der Industrie und im Magen vorkommt.',
							en: 'A strong acid found in industry and in the stomach.'
						}),
						category: 'molecule',
						color: 'yellow',
						formula: 'HCl',
						state: 'aqueous'
					}
				},
				{
					inputs: ['Na', 'Cl'],
					output: {
						id: 'NaCl',
						symbol: 'NaCl',
						name: translate({de: 'Kochsalz', en: 'Table Salt'}),
						description: translate({
							de: 'Grundlegendes Mineral für Leben und Kochen, Ionenverbindung.',
							en: 'Essential mineral for life and cooking, ionic compound.'
						}),
						category: 'compound',
						color: 'white',
						formula: 'NaCl',
						state: 'solid'
					}
				},
				{
					inputs: ['C', 'O', 'O'],
					output: {
						id: 'CO2',
						symbol: 'CO₂',
						name: translate({de: 'Kohlendioxid', en: 'Carbon Dioxide'}),
						description: translate({
							de: 'Gas in der Atmosphäre, Produkt der Verbrennung und Atmung.',
							en: 'Atmospheric gas, product of combustion and respiration.'
						}),
						category: 'molecule',
						color: 'gray',
						formula: 'CO₂',
						state: 'gas'
					}
				},
				{
					inputs: ['N', 'H', 'H', 'H'],
					output: {
						id: 'NH3',
						symbol: 'NH₃',
						name: translate({de: 'Ammoniak', en: 'Ammonia'}),
						description: translate({
							de: 'Stechend riechendes Gas, wichtig für Düngemittel.',
							en: 'Pungent-smelling gas, important for fertilizers.'
						}),
						category: 'molecule',
						color: 'green',
						formula: 'NH₃',
						state: 'gas'
					}
				},

				// Reactions with water
				{
					inputs: ['H2O', 'CO2'],
					output: {
						id: 'H2CO3',
						symbol: 'H₂CO₃',
						name: translate({de: 'Kohlensäure', en: 'Carbonic Acid'}),
						description: translate({
							de: 'Macht Getränke sprudelnd, zerfällt leicht in Wasser und CO₂.',
							en: 'Makes drinks fizzy, easily decomposes into water and CO₂.'
						}),
						category: 'molecule',
						color: 'blue',
						formula: 'H₂CO₃',
						state: 'aqueous'
					}
				},
				{
					inputs: ['H2O', 'NaCl'],
					output: {
						id: 'saline',
						symbol: 'NaCl(aq)',
						name: translate({de: 'Kochsalzlösung', en: 'Saline Solution'}),
						description: translate({
							de: 'Salzwasser, wichtig für medizinische Anwendungen.',
							en: 'Salt water, important for medical applications.'
						}),
						category: 'mixture',
						color: 'blue',
						formula: 'NaCl(aq)',
						state: 'liquid'
					}
				},

				// Reactions with acids and bases
				{
					inputs: ['Na', 'O', 'H'],
					output: {
						id: 'NaOH',
						symbol: 'NaOH',
						name: translate({de: 'Natronlauge', en: 'Sodium Hydroxide'}),
						description: translate({
							de: 'Starke Base, ätzend, wird in Reinigungsmitteln verwendet.',
							en: 'Strong base, caustic, used in cleaning products.'
						}),
						category: 'compound',
						color: 'purple',
						formula: 'NaOH',
						state: 'solid'
					}
				},
				{
					inputs: ['NaOH', 'HCl'],
					requiredEquipment: ['test_tube'],
					output: {
						id: 'NaCl_H2O',
						symbol: 'NaCl+H₂O',
						name: translate({de: 'Neutralisation', en: 'Neutralization'}),
						description: translate({
							de: 'Säure-Base-Reaktion, erzeugt Salz und Wasser.',
							en: 'Acid-base reaction, produces salt and water.'
						}),
						category: 'reaction',
						color: 'blue',
						formula: 'NaOH + HCl → NaCl + H₂O',
						state: 'aqueous'
					}
				},

				// Metal reactions
				{
					inputs: ['Fe', 'O2'],
					output: {
						id: 'Fe2O3',
						symbol: 'Fe₂O₃',
						name: translate({de: 'Rost', en: 'Rust'}),
						description: translate({
							de: 'Eisenoxid, Ergebnis der Oxidation von Eisen an feuchter Luft.',
							en: 'Iron oxide, result of iron oxidation in moist air.'
						}),
						category: 'compound',
						color: 'orange',
						formula: 'Fe₂O₃',
						state: 'solid'
					}
				},
				{
					inputs: ['Fe2O3', 'C'],
					requiredEquipment: ['bunsen_burner'],
					requiredTemperature: {min: 700, max: 1200},
					output: {
						id: 'Fe_CO2',
						symbol: 'Fe+CO₂',
						name: translate({de: 'Eisengewinnung', en: 'Iron Smelting'}),
						description: translate({
							de: 'Metallurgischer Prozess zur Gewinnung von Eisen aus Erz.',
							en: 'Metallurgical process to extract iron from ore.'
						}),
						category: 'reaction',
						color: 'orange',
						formula: 'Fe₂O₃ + 3C → 2Fe + 3CO₂',
						state: 'solid'
					}
				},

				// Carbon compounds
				{
					inputs: ['C', 'H', 'H', 'H', 'H'],
					output: {
						id: 'CH4',
						symbol: 'CH₄',
						name: translate({de: 'Methan', en: 'Methane'}),
						description: translate({
							de: 'Einfachster Kohlenwasserstoff, Hauptbestandteil von Erdgas.',
							en: 'Simplest hydrocarbon, main component of natural gas.'
						}),
						category: 'molecule',
						color: 'gray',
						formula: 'CH₄',
						state: 'gas'
					}
				},
				{
					inputs: ['CH4', 'O2'],
					requiredEquipment: ['bunsen_burner'],
					output: {
						id: 'combustion',
						symbol: '🔥',
						name: translate({de: 'Verbrennung', en: 'Combustion'}),
						description: translate({
							de: 'Exotherme Reaktion mit Sauerstoff, erzeugt Wärme und Licht.',
							en: 'Exothermic reaction with oxygen, produces heat and light.'
						}),
						category: 'reaction',
						color: 'red',
						formula: 'CH₄ + 2O₂ → CO₂ + 2H₂O + Energie',
						state: 'gas'
					}
				},
				{
					inputs: ['C', 'H', 'H', 'O', 'H'],
					output: {
						id: 'CH3OH',
						symbol: 'CH₃OH',
						name: translate({de: 'Methanol', en: 'Methanol'}),
						description: translate({
							de: 'Einfacher Alkohol, giftig, wird als Lösungsmittel verwendet.',
							en: 'Simple alcohol, toxic, used as a solvent.'
						}),
						category: 'molecule',
						color: 'indigo',
						formula: 'CH₃OH',
						state: 'liquid'
					}
				},

				// Oxidation reactions
				{
					inputs: ['H', 'O', 'H', 'O'],
					output: {
						id: 'H2O2',
						symbol: 'H₂O₂',
						name: translate({de: 'Wasserstoffperoxid', en: 'Hydrogen Peroxide'}),
						description: translate({
							de: 'Oxidationsmittel, Bleichmittel, zerfällt zu Wasser und Sauerstoff.',
							en: 'Oxidizing agent, bleach, decomposes to water and oxygen.'
						}),
						category: 'molecule',
						color: 'cyan',
						formula: 'H₂O₂',
						state: 'liquid'
					}
				},
				{
					inputs: ['S', 'O', 'O'],
					output: {
						id: 'SO2',
						symbol: 'SO₂',
						name: translate({de: 'Schwefeldioxid', en: 'Sulfur Dioxide'}),
						description: translate({
							de: 'Reizgas, entsteht bei Verbrennung schwefelhaltiger Brennstoffe.',
							en: 'Irritant gas, produced by burning sulfur-containing fuels.'
						}),
						category: 'molecule',
						color: 'yellow',
						formula: 'SO₂',
						state: 'gas'
					}
				},

				// FIXED: Electrolysis reactions (now equipment-based)
				{
					inputs: ['H2O'],
					requiredEquipment: ['electricity', 'beaker'],
					output: {
						id: 'electrolysis',
						symbol: 'H₂+O₂',
						name: translate({de: 'Elektrolyse', en: 'Electrolysis'}),
						description: translate({
							de: 'Zerlegung durch Strom, spaltet Wasser in Wasserstoff und Sauerstoff.',
							en: 'Decomposition by electricity, splits water into hydrogen and oxygen.'
						}),
						category: 'reaction',
						color: 'blue',
						formula: '2H₂O → 2H₂ + O₂',
						state: 'gas'
					}
				},
				{
					inputs: ['NaCl', 'H2O'],
					requiredEquipment: ['electricity', 'beaker'],
					output: {
						id: 'NaCl_electrolysis',
						symbol: 'Na+Cl₂',
						name: translate({de: 'Chlor-Alkali-Prozess', en: 'Chlor-Alkali Process'}),
						description: translate({
							de: 'Elektrolyse von Salzlösung, erzeugt Chlorgas und Natronlauge.',
							en: 'Electrolysis of salt solution, produces chlorine gas and sodium hydroxide.'
						}),
						category: 'reaction',
						color: 'green',
						formula: '2NaCl + 2H₂O → Cl₂ + 2NaOH + H₂',
						state: 'mixed'
					}
				},
				{
					inputs: ['Cu', 'SO4'],
					requiredEquipment: ['electricity', 'beaker'],
					output: {
						id: 'copper_plating',
						symbol: 'Cu²⁺',
						name: translate({de: 'Kupferplattierung', en: 'Copper Plating'}),
						description: translate({
							de: 'Elektrolytische Abscheidung von Kupfer auf einer Oberfläche.',
							en: 'Electrolytic deposition of copper on a surface.'
						}),
						category: 'reaction',
						color: 'brown',
						formula: 'Cu²⁺ + 2e⁻ → Cu',
						state: 'solid'
					}
				},

				// Metallurgy and alloys
				{
					inputs: ['Fe', 'C'],
					requiredEquipment: ['bunsen_burner'],
					requiredTemperature: {min: 800, max: 1200},
					output: {
						id: 'steel',
						symbol: 'Fe-C',
						name: translate({de: 'Stahl', en: 'Steel'}),
						description: translate({
							de: 'Legierung aus Eisen und Kohlenstoff, härter und stärker als reines Eisen.',
							en: 'Alloy of iron and carbon, harder and stronger than pure iron.'
						}),
						category: 'compound',
						color: 'gray',
						formula: 'Fe + C',
						state: 'solid'
					}
				},
				{
					inputs: ['Cu', 'Zn'],
					requiredEquipment: ['bunsen_burner'],
					requiredTemperature: {min: 900, max: 1000},
					output: {
						id: 'brass',
						symbol: 'CuZn',
						name: translate({de: 'Messing', en: 'Brass'}),
						description: translate({
							de: 'Legierung aus Kupfer und Zink, goldfarben und korrosionsbeständig.',
							en: 'Alloy of copper and zinc, gold-colored and corrosion-resistant.'
						}),
						category: 'compound',
						color: 'gold',
						formula: 'Cu + Zn',
						state: 'solid'
					}
				},
				{
					inputs: ['Cu', 'Sn'],
					requiredEquipment: ['bunsen_burner'],
					requiredTemperature: {min: 950, max: 1050},
					output: {
						id: 'bronze',
						symbol: 'CuSn',
						name: translate({de: 'Bronze', en: 'Bronze'}),
						description: translate({
							de: 'Legierung aus Kupfer und Zinn, historisch wichtig für Werkzeuge und Waffen.',
							en: 'Alloy of copper and tin, historically important for tools and weapons.'
						}),
						category: 'compound',
						color: 'brown',
						formula: 'Cu + Sn',
						state: 'solid'
					}
				},

				// More advanced compounds
				{
					inputs: ['N', 'O'],
					output: {
						id: 'NO',
						symbol: 'NO',
						name: translate({de: 'Stickstoffmonoxid', en: 'Nitric Oxide'}),
						description: translate({
							de: 'Signalmolekül im Körper, wichtig für Blutgefäßerweiterung.',
							en: 'Signaling molecule in the body, important for blood vessel dilation.'
						}),
						category: 'molecule',
						color: 'green',
						formula: 'NO',
						state: 'gas'
					}
				},
				{
					inputs: ['NO', 'O2'],
					output: {
						id: 'NO2',
						symbol: 'NO₂',
						name: translate({de: 'Stickstoffdioxid', en: 'Nitrogen Dioxide'}),
						description: translate({
							de: 'Braunes Gas, Luftschadstoff, entsteht bei Verbrennungsprozessen.',
							en: 'Brown gas, air pollutant, produced in combustion processes.'
						}),
						category: 'molecule',
						color: 'brown',
						formula: 'NO₂',
						state: 'gas'
					}
				},
				{
					inputs: ['S', 'O', 'O', 'O'],
					output: {
						id: 'SO3',
						symbol: 'SO₃',
						name: translate({de: 'Schwefeltrioxid', en: 'Sulfur Trioxide'}),
						description: translate({
							de: 'Reaktives Gas, reagiert mit Wasser zu Schwefelsäure.',
							en: 'Reactive gas, reacts with water to form sulfuric acid.'
						}),
						category: 'molecule',
						color: 'yellow',
						formula: 'SO₃',
						state: 'gas'
					}
				},
				{
					inputs: ['SO3', 'H2O'],
					requiredEquipment: ['beaker'],
					output: {
						id: 'H2SO4',
						symbol: 'H₂SO₄',
						name: translate({de: 'Schwefelsäure', en: 'Sulfuric Acid'}),
						description: translate({
							de: 'Starke, korrosive Säure, wichtig in der Industrie.',
							en: 'Strong, corrosive acid, important in industry.'
						}),
						category: 'compound',
						color: 'yellow',
						formula: 'H₂SO₄',
						state: 'liquid'
					}
				},

				// Photochemical reactions
				{
					inputs: ['Ag', 'Br'],
					requiredEquipment: ['uv_light'],
					output: {
						id: 'AgBr',
						symbol: 'AgBr',
						name: translate({de: 'Silberbromid', en: 'Silver Bromide'}),
						description: translate({
							de: 'Lichtempfindliches Salz, verwendet in der Fotografie.',
							en: 'Light-sensitive salt, used in photography.'
						}),
						category: 'compound',
						color: 'silver',
						formula: 'AgBr',
						state: 'solid'
					}
				},
				{
					inputs: ['AgBr', 'H2O'],
					requiredEquipment: ['uv_light'],
					output: {
						id: 'photography',
						symbol: '📷',
						name: translate({de: 'Fotografische Reaktion', en: 'Photographic Reaction'}),
						description: translate({
							de: 'Lichtinduzierte Reduktion von Silberbromid zu metallischem Silber.',
							en: 'Light-induced reduction of silver bromide to metallic silver.'
						}),
						category: 'reaction',
						color: 'silver',
						formula: '2AgBr + H₂O + Licht → 2Ag + 2HBr + ½O₂',
						state: 'solid'
					}
				},

				// Catalytic reactions
				{
					inputs: ['N2', 'H2'],
					requiredEquipment: ['catalyst', 'beaker'],
					output: {
						id: 'haber_process',
						symbol: 'NH₃',
						name: translate({de: 'Haber-Prozess', en: 'Haber Process'}),
						description: translate({
							de: 'Katalytische Synthese von Ammoniak aus Stickstoff und Wasserstoff.',
							en: 'Catalytic synthesis of ammonia from nitrogen and hydrogen.'
						}),
						category: 'reaction',
						color: 'green',
						formula: 'N₂ + 3H₂ ⇌ 2NH₃',
						state: 'gas'
					}
				},
				{
					inputs: ['C2H4', 'O2'],
					requiredEquipment: ['catalyst'],
					output: {
						id: 'ethylene_oxide',
						symbol: 'C₂H₄O',
						name: translate({de: 'Ethylenoxid', en: 'Ethylene Oxide'}),
						description: translate({
							de: 'Katalytische Oxidation von Ethylen, wichtig für die Produktion von Polyethylen.',
							en: 'Catalytic oxidation of ethylene, important for polyethylene production.'
						}),
						category: 'molecule',
						color: 'indigo',
						formula: 'C₂H₄ + ½O₂ → C₂H₄O',
						state: 'gas'
					}
				},

				// Distillation processes
				{
					inputs: ['crude_oil'],
					requiredEquipment: ['distillation', 'bunsen_burner'],
					requiredTemperature: {min: 25, max: 400},
					output: {
						id: 'petroleum_distillation',
						symbol: '🛢️',
						name: translate({de: 'Erdöldestillation', en: 'Petroleum Distillation'}),
						description: translate({
							de: 'Fraktionierte Destillation von Rohöl zur Trennung in verschiedene Produkte.',
							en: 'Fractional distillation of crude oil to separate into different products.'
						}),
						category: 'reaction',
						color: 'brown',
						formula: 'Rohöl → Benzin + Kerosin + Diesel + ...',
						state: 'mixed'
					}
				},
				{
					inputs: ['fermentation_mix'],
					requiredEquipment: ['distillation', 'bunsen_burner'],
					requiredTemperature: {min: 78, max: 100},
					output: {
						id: 'ethanol_distillation',
						symbol: 'C₂H₅OH',
						name: translate({de: 'Ethanoldestillation', en: 'Ethanol Distillation'}),
						description: translate({
							de: 'Destillation vergorener Maische zur Gewinnung von konzentriertem Ethanol.',
							en: 'Distillation of fermented mash to obtain concentrated ethanol.'
						}),
						category: 'reaction',
						color: 'blue',
						formula: 'Vergorene Maische → Ethanol + Wasser',
						state: 'liquid'
					}
				},
				{
					inputs: ['CaF2', 'H2SO4'],
					requiredEquipment: ['distillation'],
					output: {
						id: 'F',
						symbol: 'F',
						name: translate({de: 'Fluor', en: 'Fluorine'}),
						description: translate({
							de: 'Blass-gelbes Gas, höchst reaktiv, bildet starke Bindungen mit fast allen Elementen.',
							en: 'Pale yellow gas, highly reactive, forms strong bonds with nearly all elements.'
						}),
						category: 'element',
						color: 'yellow',
						state: 'gas'
					}
				},

				// Halogen chemistry
				{
					inputs: ['H', 'F'],
					output: {
						id: 'HF',
						symbol: 'HF',
						name: translate({de: 'Fluorwasserstoff', en: 'Hydrogen Fluoride'}),
						description: translate({
							de: 'Stark korrosive Säure, ätzt Glas, sehr gefährlich.',
							en: 'Highly corrosive acid, etches glass, very dangerous.'
						}),
						category: 'molecule',
						color: 'green',
						formula: 'HF',
						state: 'gas'
					}
				},
				{
					inputs: ['HF', 'SiO2'],
					requiredEquipment: ['beaker'],
					output: {
						id: 'glass_etching',
						symbol: 'SiF₄',
						name: translate({de: 'Glasätzung', en: 'Glass Etching'}),
						description: translate({
							de: 'Reaktion von Fluorwasserstoff mit Siliziumdioxid, ätzt Glasoberflächen.',
							en: 'Reaction of hydrogen fluoride with silicon dioxide, etches glass surfaces.'
						}),
						category: 'reaction',
						color: 'cyan',
						formula: 'SiO₂ + 4HF → SiF₄ + 2H₂O',
						state: 'gas'
					}
				},

				// Organic chemistry
				{
					inputs: ['C2H5OH', 'CH3COOH'],
					requiredEquipment: ['beaker', 'catalyst'],
					output: {
						id: 'esterification',
						symbol: 'CH₃COOC₂H₅',
						name: translate({de: 'Veresterung', en: 'Esterification'}),
						description: translate({
							de: 'Reaktion zwischen Alkohol und Säure zur Bildung eines Esters mit fruchtigem Geruch.',
							en: 'Reaction between alcohol and acid to form an ester with fruity smell.'
						}),
						category: 'reaction',
						color: 'pink',
						formula: 'C₂H₅OH + CH₃COOH → CH₃COOC₂H₅ + H₂O',
						state: 'liquid'
					}
				},
				{
					inputs: ['C6H12O6'],
					requiredEquipment: ['beaker'],
					output: {
						id: 'fermentation',
						symbol: '🍺',
						name: translate({de: 'Fermentation', en: 'Fermentation'}),
						description: translate({
							de: 'Biologischer Prozess der Umwandlung von Zucker in Alkohol und CO₂.',
							en: 'Biological process of converting sugar into alcohol and CO₂.'
						}),
						category: 'reaction',
						color: 'amber',
						formula: 'C₆H₁₂O₆ → 2C₂H₅OH + 2CO₂',
						state: 'liquid'
					}
				},
				{
					inputs: ['C', 'O'],
					output: {
						id: 'CO',
						symbol: 'CO',
						name: translate({de: 'Kohlenmonoxid', en: 'Carbon Monoxide'}),
						description: translate({
							de: 'Farb- und geruchloses, giftiges Gas, bindet an Hämoglobin.',
							en: 'Colorless, odorless, toxic gas, binds to hemoglobin.'
						}),
						category: 'molecule',
						color: 'gray',
						formula: 'CO',
						state: 'gas'
					}
				},
				{
					inputs: ['N', 'N'],
					output: {
						id: 'N2',
						symbol: 'N₂',
						name: translate({de: 'Stickstoffgas', en: 'Nitrogen Gas'}),
						description: translate({
							de: 'Farb- und geruchloses Gas, Hauptbestandteil der Erdatmosphäre.',
							en: 'Colorless, odorless gas, main component of Earth\'s atmosphere.'
						}),
						category: 'molecule',
						color: 'green',
						formula: 'N₂',
						state: 'gas'
					}
				},
				{
					inputs: ['C', 'C', 'H', 'H', 'H', 'H'],
					output: {
						id: 'C2H4',
						symbol: 'C₂H₄',
						name: translate({de: 'Ethylen', en: 'Ethylene'}),
						description: translate({
							de: 'Einfachster ungesättigter Kohlenwasserstoff, wichtig für die Kunststoffherstellung.',
							en: 'Simplest unsaturated hydrocarbon, important for plastic production.'
						}),
						category: 'molecule',
						color: 'indigo',
						formula: 'C₂H₄',
						state: 'gas'
					}
				},
				{
					inputs: ['C', 'C', 'H', 'H', 'H', 'H', 'H', 'O', 'H'],
					output: {
						id: 'C2H5OH',
						symbol: 'C₂H₅OH',
						name: translate({de: 'Ethanol', en: 'Ethanol'}),
						description: translate({
							de: 'Alkohol in alkoholischen Getränken, wird auch als Kraftstoff verwendet.',
							en: 'Alcohol in alcoholic beverages, also used as fuel.'
						}),
						category: 'molecule',
						color: 'blue',
						formula: 'C₂H₅OH',
						state: 'liquid'
					}
				},
				{
					inputs: ['C', 'C', 'H', 'H', 'H', 'O', 'O', 'H'],
					output: {
						id: 'CH3COOH',
						symbol: 'CH₃COOH',
						name: translate({de: 'Essigsäure', en: 'Acetic Acid'}),
						description: translate({
							de: 'Organische Säure, Hauptbestandteil von Essig, saurer Geschmack.',
							en: 'Organic acid, main component of vinegar, sour taste.'
						}),
						category: 'molecule',
						color: 'yellow',
						formula: 'CH₃COOH',
						state: 'liquid'
					}
				},
				{
					inputs: ['C', 'C', 'C', 'C', 'C', 'C', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'O', 'O', 'O', 'O', 'O', 'O'],
					requiredEquipment: ['catalyst'],
					output: {
						id: 'C6H12O6',
						symbol: 'C₆H₁₂O₆',
						name: translate({de: 'Glukose', en: 'Glucose'}),
						description: translate({
							de: 'Einfacher Zucker, wichtige Energiequelle für Lebewesen.',
							en: 'Simple sugar, important energy source for living organisms.'
						}),
						category: 'molecule',
						color: 'amber',
						formula: 'C₆H₁₂O₆',
						state: 'solid'
					}
				},
				{
					inputs: ['S', 'O', 'O', 'O', 'O'],
					output: {
						id: 'SO4',
						symbol: 'SO₄²⁻',
						name: translate({de: 'Sulfat', en: 'Sulfate'}),
						description: translate({
							de: 'Anion der Schwefelsäure, bildet verschiedene Salze.',
							en: 'Anion of sulfuric acid, forms various salts.'
						}),
						category: 'molecule',
						color: 'yellow',
						formula: 'SO₄²⁻',
						state: 'aqueous'
					}
				},
				{
					inputs: ['C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H'],
					requiredEquipment: ['beaker'],
					output: {
						id: 'crude_oil',
						symbol: '🛢️',
						name: translate({de: 'Rohöl', en: 'Crude Oil'}),
						description: translate({
							de: 'Komplexe Mischung aus verschiedenen Kohlenwasserstoffen, Grundlage für Treibstoffe und Petrochemikalien.',
							en: 'Complex mixture of various hydrocarbons, basis for fuels and petrochemicals.'
						}),
						category: 'mixture',
						color: 'brown',
						formula: 'C₁₅H₃₂ + C₈H₁₈ + ...',
						state: 'liquid'
					}
				},
				{
					inputs: ['C6H12O6', 'H2O'],
					requiredEquipment: ['beaker'],
					output: {
						id: 'fermentation_mix',
						symbol: '🍶',
						name: translate({de: 'Gärungsgemisch', en: 'Fermentation Mix'}),
						description: translate({
							de: 'Mischung von Zucker und Wasser mit Hefen, Grundlage für alkoholische Getränke.',
							en: 'Mixture of sugar and water with yeasts, basis for alcoholic beverages.'
						}),
						category: 'mixture',
						color: 'amber',
						formula: 'C₆H₁₂O₆ + H₂O + Hefen',
						state: 'liquid'
					}
				},
				{
					inputs: ['Si', 'O', 'O'],
					output: {
						id: 'SiO2',
						symbol: 'SiO₂',
						name: translate({de: 'Siliziumdioxid', en: 'Silicon Dioxide'}),
						description: translate({
							de: 'Hauptbestandteil von Sand und Quarz, wird für Glas und Elektronik verwendet.',
							en: 'Main component of sand and quartz, used for glass and electronics.'
						}),
						category: 'compound',
						color: 'white',
						formula: 'SiO₂',
						state: 'solid'
					}
				},
				{
					inputs: ['CO', 'O'],
					output: {
						id: 'CO2',
						symbol: 'CO₂',
						name: translate({de: 'Kohlendioxid', en: 'Carbon Dioxide'}),
						description: translate({
							de: 'Gas in der Atmosphäre, Produkt der Verbrennung und Atmung.',
							en: 'Atmospheric gas, product of combustion and respiration.'
						}),
						category: 'molecule',
						color: 'gray',
						formula: 'CO₂',
						state: 'gas'
					}
				},
				// Anorganische Säuren und Basen
				{
					inputs: ['N', 'O', 'O', 'H'],
					requiredEquipment: ['beaker', 'catalyst'],
					output: {
						id: 'HNO3',
						symbol: 'HNO₃',
						name: translate({de: 'Salpetersäure', en: 'Nitric Acid'}),
						description: translate({
							de: 'Starke Mineralsäure, stark oxidierend, wichtig für Düngemittel und Sprengstoff.',
							en: 'Strong mineral acid, highly oxidizing, important for fertilizers and explosives.'
						}),
						category: 'compound',
						color: 'yellow',
						formula: 'HNO₃',
						state: 'liquid'
					}
				},
				{
					inputs: ['N', 'O', 'O'],
					requiredEquipment: ['catalyst'],
					requiredTemperature: {min: 300, max: 600},
					output: {
						id: 'ostwald',
						symbol: 'HNO₃',
						name: translate({de: 'Ostwald-Verfahren', en: 'Ostwald Process'}),
						description: translate({
							de: 'Industrielles Verfahren zur Herstellung von Salpetersäure aus Ammoniak.',
							en: 'Industrial process for producing nitric acid from ammonia.'
						}),
						category: 'reaction',
						color: 'yellow',
						formula: '4NH₃ + 5O₂ → 4NO + 6H₂O → 4HNO₃',
						state: 'mixed'
					}
				},
				{
					inputs: ['P', 'O', 'O', 'O', 'O', 'H', 'H', 'H'],
					requiredEquipment: ['beaker'],
					output: {
						id: 'H3PO4',
						symbol: 'H₃PO₄',
						name: translate({de: 'Phosphorsäure', en: 'Phosphoric Acid'}),
						description: translate({
							de: 'Mittelstarke Säure, wird in Düngemitteln und Lebensmitteln verwendet.',
							en: 'Medium-strong acid, used in fertilizers and food products.'
						}),
						category: 'compound',
						color: 'blue',
						formula: 'H₃PO₄',
						state: 'liquid'
					}
				},
				{
					inputs: ['K', 'O', 'H'],
					output: {
						id: 'KOH',
						symbol: 'KOH',
						name: translate({de: 'Kaliumhydroxid', en: 'Potassium Hydroxide'}),
						description: translate({
							de: 'Starke Base, ätzend, wird in Seifen und Batterien verwendet.',
							en: 'Strong base, caustic, used in soaps and batteries.'
						}),
						category: 'compound',
						color: 'purple',
						formula: 'KOH',
						state: 'solid'
					}
				},
				{
					inputs: ['Ca', 'O', 'H', 'O', 'H'],
					output: {
						id: 'Ca(OH)2',
						symbol: 'Ca(OH)₂',
						name: translate({de: 'Löschkalk', en: 'Slaked Lime'}),
						description: translate({
							de: 'Weiße Base, verwendet in Mörtel, Putzen und zur Wasseraufbereitung.',
							en: 'White base, used in mortar, plaster, and water treatment.'
						}),
						category: 'compound',
						color: 'white',
						formula: 'Ca(OH)₂',
						state: 'solid'
					}
				},

// Organische Verbindungen
				{
					inputs: ['C', 'C', 'H', 'H', 'H', 'H', 'O'],
					requiredEquipment: ['catalyst'],
					output: {
						id: 'CH3CHO',
						symbol: 'CH₃CHO',
						name: translate({de: 'Acetaldehyd', en: 'Acetaldehyde'}),
						description: translate({
							de: 'Organische Verbindung mit Aldehydgruppe, wichtiges Zwischenprodukt in der organischen Synthese.',
							en: 'Organic compound with an aldehyde group, important intermediate in organic synthesis.'
						}),
						category: 'molecule',
						color: 'indigo',
						formula: 'CH₃CHO',
						state: 'liquid'
					}
				},
				{
					inputs: ['C', 'C', 'C', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'O', 'O', 'O'],
					requiredEquipment: ['beaker', 'catalyst'],
					output: {
						id: 'C3H8O3',
						symbol: 'C₃H₈O₃',
						name: translate({de: 'Glycerin', en: 'Glycerol'}),
						description: translate({
							de: 'Viskose, süßlich schmeckende Flüssigkeit, wird in Kosmetika und Pharmazeutika verwendet.',
							en: 'Viscous, sweet-tasting liquid, used in cosmetics and pharmaceuticals.'
						}),
						category: 'molecule',
						color: 'blue',
						formula: 'C₃H₈O₃',
						state: 'liquid'
					}
				},
				{
					inputs: ['C', 'H', 'O', 'O', 'H'],
					output: {
						id: 'HCOOH',
						symbol: 'HCOOH',
						name: translate({de: 'Ameisensäure', en: 'Formic Acid'}),
						description: translate({
							de: 'Einfachste Carbonsäure, kommt in Ameisen vor, ätzend.',
							en: 'Simplest carboxylic acid, found in ants, corrosive.'
						}),
						category: 'molecule',
						color: 'green',
						formula: 'HCOOH',
						state: 'liquid'
					}
				},
				{
					inputs: ['C', 'C', 'C', 'H', 'H', 'H', 'H', 'H', 'H', 'O'],
					requiredEquipment: ['distillation'],
					output: {
						id: 'C3H6O',
						symbol: 'C₃H₆O',
						name: translate({de: 'Aceton', en: 'Acetone'}),
						description: translate({
							de: 'Farbloses, leicht flüchtiges Lösungsmittel mit charakteristischem Geruch.',
							en: 'Colorless, volatile solvent with characteristic odor.'
						}),
						category: 'molecule',
						color: 'blue',
						formula: 'C₃H₆O',
						state: 'liquid'
					}
				},
				{
					inputs: ['C6H12O6', 'C6H12O6'],
					requiredEquipment: ['catalyst', 'beaker'],
					output: {
						id: 'C12H22O11',
						symbol: 'C₁₂H₂₂O₁₁',
						name: translate({de: 'Saccharose', en: 'Sucrose'}),
						description: translate({
							de: 'Gewöhnlicher Haushaltszucker, süß, aus Zuckerrohr oder Zuckerrüben.',
							en: 'Common table sugar, sweet, from sugar cane or sugar beets.'
						}),
						category: 'molecule',
						color: 'white',
						formula: 'C₁₂H₂₂O₁₁',
						state: 'solid'
					}
				},

// Gase und Elemente
				{
					inputs: ['Ar'],
					output: {
						id: 'Ar',
						symbol: 'Ar',
						name: translate({de: 'Argon', en: 'Argon'}),
						description: translate({
							de: 'Inertes Edelgas, verwendet in Glühlampen und als Schutzgas beim Schweißen.',
							en: 'Inert noble gas, used in light bulbs and as shielding gas in welding.'
						}),
						category: 'element',
						color: 'purple',
						atomicNumber: 18,
						atomicWeight: 39.948,
						phase: 'gas',
						state: 'gas'
					}
				},
				{
					inputs: ['O', 'O', 'O'],
					requiredEquipment: ['electricity'],
					output: {
						id: 'O3',
						symbol: 'O₃',
						name: translate({de: 'Ozon', en: 'Ozone'}),
						description: translate({
							de: 'Reaktives Gas mit charakteristischem Geruch, schützt vor UV-Strahlung in der Stratosphäre.',
							en: 'Reactive gas with characteristic odor, protects from UV radiation in the stratosphere.'
						}),
						category: 'molecule',
						color: 'blue',
						formula: 'O₃',
						state: 'gas'
					}
				},
				{
					inputs: ['H', 'H', 'S'],
					output: {
						id: 'H2S',
						symbol: 'H₂S',
						name: translate({de: 'Schwefelwasserstoff', en: 'Hydrogen Sulfide'}),
						description: translate({
							de: 'Farbloses, giftiges Gas mit charakteristischem Geruch nach faulen Eiern.',
							en: 'Colorless, toxic gas with characteristic rotten egg smell.'
						}),
						category: 'molecule',
						color: 'yellow',
						formula: 'H₂S',
						state: 'gas'
					}
				},
				{
					inputs: ['N', 'N', 'O'],
					requiredEquipment: ['catalyst'],
					output: {
						id: 'N2O',
						symbol: 'N₂O',
						name: translate({de: 'Distickstoffmonoxid', en: 'Nitrous Oxide'}),
						description: translate({
							de: 'Farbloses Gas mit leicht süßlichem Geruch, verwendet als Anästhetikum ("Lachgas").',
							en: 'Colorless gas with slightly sweet odor, used as anesthetic ("laughing gas").'
						}),
						category: 'molecule',
						color: 'green',
						formula: 'N₂O',
						state: 'gas'
					}
				},

// Komplexe Prozesse
				{
					inputs: ['SO2', 'O2', 'H2O'],
					requiredEquipment: ['catalyst', 'beaker'],
					requiredTemperature: {min: 400, max: 600},
					output: {
						id: 'contact_process',
						symbol: 'H₂SO₄',
						name: translate({de: 'Kontaktverfahren', en: 'Contact Process'}),
						description: translate({
							de: 'Industrielles Verfahren zur Herstellung von Schwefelsäure über Schwefeltrioxid.',
							en: 'Industrial process for manufacturing sulfuric acid via sulfur trioxide.'
						}),
						category: 'reaction',
						color: 'yellow',
						formula: 'SO₂ + ½O₂ → SO₃ → H₂SO₄',
						state: 'liquid'
					}
				},
				{
					inputs: ['C2H4', 'C2H4', 'C2H4', 'C2H4'],
					requiredEquipment: ['catalyst', 'beaker'],
					requiredTemperature: {min: 80, max: 250},
					output: {
						id: 'polyethylene',
						symbol: '(C₂H₄)ₙ',
						name: translate({de: 'Polyethylen', en: 'Polyethylene'}),
						description: translate({
							de: 'Polymer aus Ethylen, häufigster Kunststoff, verwendet für Plastiktüten und Verpackungen.',
							en: 'Polymer of ethylene, most common plastic, used for plastic bags and packaging.'
						}),
						category: 'reaction',
						color: 'cyan',
						formula: 'n(C₂H₄) → (C₂H₄)ₙ',
						state: 'solid'
					}
				},
				{
					inputs: ['crude_oil'],
					requiredEquipment: ['catalyst', 'distillation'],
					requiredTemperature: {min: 450, max: 700},
					output: {
						id: 'catalytic_cracking',
						symbol: 'C₂H₄+',
						name: translate({de: 'Katalytisches Cracken', en: 'Catalytic Cracking'}),
						description: translate({
							de: 'Verfahren zur Umwandlung langkettiger Kohlenwasserstoffe in kurzkettige, wichtig für Benzinherstellung.',
							en: 'Process of converting long-chain hydrocarbons into short-chain ones, important for gasoline production.'
						}),
						category: 'reaction',
						color: 'orange',
						formula: 'C₁₅H₃₂ → C₈H₁₈ + C₂H₄ + ...',
						state: 'mixed'
					}
				},

// Metallverbindungen und Minerale
				{
					inputs: ['Ca', 'C', 'O', 'O', 'O'],
					output: {
						id: 'CaCO3',
						symbol: 'CaCO₃',
						name: translate({de: 'Kalkstein', en: 'Limestone'}),
						description: translate({
							de: 'Sedimentgestein aus Calciumcarbonat, verwendet in Bau und Landwirtschaft.',
							en: 'Sedimentary rock composed of calcium carbonate, used in construction and agriculture.'
						}),
						category: 'compound',
						color: 'white',
						formula: 'CaCO₃',
						state: 'solid'
					}
				},
				{
					inputs: ['Fe', 'Fe', 'Fe', 'O', 'O', 'O', 'O'],
					output: {
						id: 'Fe3O4',
						symbol: 'Fe₃O₄',
						name: translate({de: 'Magnetit', en: 'Magnetite'}),
						description: translate({
							de: 'Magnetisches Eisenmineral, natürlicher Magnet, wichtiges Eisenerz.',
							en: 'Magnetic iron mineral, natural magnet, important iron ore.'
						}),
						category: 'compound',
						color: 'black',
						formula: 'Fe₃O₄',
						state: 'solid'
					}
				},
				{
					inputs: ['Cu', 'SO4'],
					requiredEquipment: ['beaker'],
					output: {
						id: 'CuSO4',
						symbol: 'CuSO₄',
						name: translate({de: 'Kupfersulfat', en: 'Copper Sulfate'}),
						description: translate({
							de: 'Blaues kristallines Salz, verwendet als Fungizid und in Laborversuchen.',
							en: 'Blue crystalline salt, used as fungicide and in laboratory experiments.'
						}),
						category: 'compound',
						color: 'blue',
						formula: 'CuSO₄',
						state: 'solid'
					}
				},
				{
					inputs: ['K', 'N', 'O', 'O', 'O'],
					output: {
						id: 'KNO3',
						symbol: 'KNO₃',
						name: translate({de: 'Kaliumnitrat', en: 'Potassium Nitrate'}),
						description: translate({
							de: 'Auch als Salpeter bekannt, verwendet in Düngemitteln, Konservierungsmitteln und Schießpulver.',
							en: 'Also known as saltpeter, used in fertilizers, preservatives, and gunpowder.'
						}),
						category: 'compound',
						color: 'white',
						formula: 'KNO₃',
						state: 'solid'
					}
				},
				{
					inputs: ['Ag', 'N', 'O', 'O', 'O'],
					requiredEquipment: ['beaker'],
					output: {
						id: 'AgNO3',
						symbol: 'AgNO₃',
						name: translate({de: 'Silbernitrat', en: 'Silver Nitrate'}),
						description: translate({
							de: 'Farbloses, lichtempfindliches Salz, verwendet in der Fotografie und Medizin.',
							en: 'Colorless, light-sensitive salt, used in photography and medicine.'
						}),
						category: 'compound',
						color: 'white',
						formula: 'AgNO₃',
						state: 'solid'
					}
				},

// Industrielle Chemikalien
				{
					inputs: ['H2O2', 'H2O2'],
					requiredEquipment: ['distillation'],
					output: {
						id: 'H2O2_conc',
						symbol: 'H₂O₂',
						name: translate({
							de: 'Wasserstoffperoxid (konzentriert)',
							en: 'Hydrogen Peroxide (concentrated)'
						}),
						description: translate({
							de: 'Hochkonzentriertes Oxidationsmittel, verwendbar als Treibstoff und Bleichmittel.',
							en: 'Highly concentrated oxidizing agent, usable as propellant and bleaching agent.'
						}),
						category: 'compound',
						color: 'cyan',
						formula: 'H₂O₂',
						state: 'liquid'
					}
				},
				{
					inputs: ['Cl', 'Na', 'O'],
					requiredEquipment: ['beaker'],
					output: {
						id: 'NaClO',
						symbol: 'NaClO',
						name: translate({de: 'Natriumhypochlorit', en: 'Sodium Hypochlorite'}),
						description: translate({
							de: 'Bleichmittel, Hauptbestandteil von Chlorbleiche, Desinfektionsmittel.',
							en: 'Bleaching agent, main component of chlorine bleach, disinfectant.'
						}),
						category: 'compound',
						color: 'yellow',
						formula: 'NaClO',
						state: 'aqueous'
					}
				},
				{
					inputs: ['NH3', 'HNO3'],
					requiredEquipment: ['beaker'],
					output: {
						id: 'NH4NO3',
						symbol: 'NH₄NO₃',
						name: translate({de: 'Ammoniumnitrat', en: 'Ammonium Nitrate'}),
						description: translate({
							de: 'Weißes, kristallines Salz, verwendet als Düngemittel und in Kältekompression.',
							en: 'White, crystalline salt, used as fertilizer and in cold packs.'
						}),
						category: 'compound',
						color: 'white',
						formula: 'NH₄NO₃',
						state: 'solid'
					}
				},
				{
					inputs: ['H2SO4', 'H2SO4'],
					requiredEquipment: ['distillation'],
					output: {
						id: 'H2SO4_conc',
						symbol: 'H₂SO₄',
						name: translate({de: 'Schwefelsäure (konzentriert)', en: 'Sulfuric Acid (concentrated)'}),
						description: translate({
							de: 'Hochkonzentrierte Schwefelsäure, stark korrosiv, entzieht Wasser aus organischen Materialien.',
							en: 'Highly concentrated sulfuric acid, strongly corrosive, dehydrates organic materials.'
						}),
						category: 'compound',
						color: 'yellow',
						formula: 'H₂SO₄',
						state: 'liquid'
					}
				},

// Zusätzliche natürliche Verbindungen
				{
					inputs: ['KNO3', 'C', 'S'],
					output: {
						id: 'gunpowder',
						symbol: '💥',
						name: translate({de: 'Schwarzpulver', en: 'Gunpowder'}),
						description: translate({
							de: 'Explosive Mischung aus Salpeter, Holzkohle und Schwefel, historisch wichtig für Waffen.',
							en: 'Explosive mixture of saltpeter, charcoal, and sulfur, historically important for weapons.'
						}),
						category: 'mixture',
						color: 'black',
						formula: 'KNO₃ + C + S',
						state: 'solid'
					}
				},
				{
					inputs: ['Ca', 'O'],
					requiredTemperature: {min: 800, max: 1000},
					output: {
						id: 'CaO',
						symbol: 'CaO',
						name: translate({de: 'Calciumoxid', en: 'Calcium Oxide'}),
						description: translate({
							de: 'Auch als Branntkalk bekannt, stark hygroskopisch, reagiert heftig mit Wasser.',
							en: 'Also known as quicklime, highly hygroscopic, reacts vigorously with water.'
						}),
						category: 'compound',
						color: 'white',
						formula: 'CaO',
						state: 'solid'
					}
				},
				{
					inputs: ['CaO', 'H2O'],
					output: {
						id: 'lime_slaking',
						symbol: 'Ca(OH)₂',
						name: translate({de: 'Kalklöschen', en: 'Lime Slaking'}),
						description: translate({
							de: 'Exotherme Reaktion von Calciumoxid mit Wasser zu Calciumhydroxid.',
							en: 'Exothermic reaction of calcium oxide with water to form calcium hydroxide.'
						}),
						category: 'reaction',
						color: 'white',
						formula: 'CaO + H₂O → Ca(OH)₂',
						state: 'solid'
					}
				}
			]);

			// Missions
			const missions = ref([
				{
					id: 'mission1',
					title: translate({de: 'Erste Schritte', en: 'First Steps'}),
					description: translate({
						de: 'Entdecke die grundlegenden Moleküle Wasser (H₂O) und Wasserstoffgas (H₂).',
						en: 'Discover the basic molecules Water (H₂O) and Hydrogen Gas (H₂).'
					}),
					hints: [
						translate({
							de: 'Kombiniere zwei Wasserstoffatome (H), um Wasserstoffgas (H₂) zu erzeugen.',
							en: 'Combine two Hydrogen atoms (H) to create Hydrogen Gas (H₂).'
						}),
						translate({
							de: 'Für Wasser (H₂O), kombiniere zwei Wasserstoffatome (H) mit einem Sauerstoffatom (O).',
							en: 'For Water (H₂O), combine two Hydrogen atoms (H) with one Oxygen atom (O).'
						})
					],
					requirementDetails: [
						{
							id: 'H2',
							ingredients: ['H', 'H'],
							equipmentNeeded: []
						},
						{
							id: 'H2O',
							ingredients: ['H', 'H', 'O'],
							equipmentNeeded: []
						}
					],
					requirements: [
						{type: 'discover', id: 'H2O'},
						{type: 'discover', id: 'H2'}
					],
					reward: translate({de: 'Freischaltung des Bunsenbrenners', en: 'Unlocks the Bunsen Burner'}),
					completed: false,
					progress: 0,
					unlockLevel: 1,
					onComplete: () => {
						// Make sure bunsen burner is available in equipment
						const bunsenBurner = availableEquipment.value.find(e => e.id === 'bunsen_burner');
						if (bunsenBurner) {
							bunsenBurner.disabled = false;
						}
					}
				},
				{
					id: 'mission2',
					title: translate({de: 'Säuren und Basen', en: 'Acids and Bases'}),
					description: translate({
						de: 'Erzeuge Salzsäure (HCl) und führe eine Neutralisationsreaktion durch.',
						en: 'Create Hydrochloric Acid (HCl) and perform a neutralization reaction.'
					}),
					hints: [
						translate({
							de: 'Kombiniere Wasserstoff (H) mit Chlor (Cl), um Salzsäure (HCl) zu erzeugen.',
							en: 'Combine Hydrogen (H) with Chlorine (Cl) to create Hydrochloric Acid (HCl).'
						}),
						translate({
							de: 'Stelle Natronlauge (NaOH) her, indem du Natrium (Na), Sauerstoff (O) und Wasserstoff (H) kombinierst.',
							en: 'Create Sodium Hydroxide (NaOH) by combining Sodium (Na), Oxygen (O), and Hydrogen (H).'
						}),
						translate({
							de: 'Nutze ein Reagenzglas, um Salzsäure mit Natronlauge zu neutralisieren.',
							en: 'Use a test tube to neutralize Hydrochloric Acid with Sodium Hydroxide.'
						})
					],
					requirementDetails: [
						{
							id: 'HCl',
							ingredients: ['H', 'Cl'],
							equipmentNeeded: []
						},
						{
							id: 'NaOH',
							ingredients: ['Na', 'O', 'H'],
							equipmentNeeded: []
						},
						{
							id: 'NaCl_H2O',
							ingredients: ['HCl', 'NaOH'],
							equipmentNeeded: ['test_tube']
						}
					],
					requirements: [
						{type: 'discover', id: 'HCl'},
						{type: 'discover', id: 'NaOH'},
						{type: 'discover', id: 'NaCl_H2O'}
					],
					reward: translate({de: 'Freischaltung der Elektrizität', en: 'Unlocks Electricity'}),
					completed: false,
					progress: 0,
					unlockLevel: 2,
					onComplete: () => {
						// Make sure electricity is available in equipment
						const electricityEquipment = availableEquipment.value.find(e => e.id === 'electricity');
						if (electricityEquipment) {
							electricityEquipment.disabled = false;
						}

						// Unlock nitrogen needed for mission 3
						if (!discoveredItems.value.some(i => i.id === 'N2')) {
							discoveredItems.value.push({
								id: 'N2',
								symbol: 'N₂',
								name: translate({de: 'Stickstoffgas', en: 'Nitrogen Gas'}),
								description: translate({
									de: 'Farb- und geruchloses Gas, Hauptbestandteil der Erdatmosphäre.',
									en: 'Colorless, odorless gas, main component of Earth\'s atmosphere.'
								}),
								category: 'molecule',
								color: 'green',
								formula: 'N₂',
								state: 'gas'
							});
						}
					}
				},
				{
					id: 'mission3',
					title: translate({de: 'Kohlenstoffchemie', en: 'Carbon Chemistry'}),
					description: translate({
						de: 'Entdecke verschiedene Kohlenstoffverbindungen: CO₂, CO und CH₄.',
						en: 'Discover various carbon compounds: CO₂, CO, and CH₄.'
					}),
					hints: [
						translate({
							de: 'Kombiniere Kohlenstoff (C) mit Sauerstoff (O), um Kohlenmonoxid (CO) zu erzeugen.',
							en: 'Combine Carbon (C) with Oxygen (O) to create Carbon Monoxide (CO).'
						}),
						translate({
							de: 'Füge einem weiteren Sauerstoffatom (O) zu CO hinzu, um Kohlendioxid (CO₂) zu erzeugen.',
							en: 'Add another Oxygen atom (O) to CO to create Carbon Dioxide (CO₂).'
						}),
						translate({
							de: 'Für Methan (CH₄), kombiniere Kohlenstoff (C) mit vier Wasserstoffatomen (H).',
							en: 'For Methane (CH₄), combine Carbon (C) with four Hydrogen atoms (H).'
						})
					],
					requirementDetails: [
						{
							id: 'CO2',
							ingredients: ['C', 'O', 'O'],
							equipmentNeeded: []
						},
						{
							id: 'CO',
							ingredients: ['C', 'O'],
							equipmentNeeded: []
						},
						{
							id: 'CH4',
							ingredients: ['C', 'H', 'H', 'H', 'H'],
							equipmentNeeded: []
						}
					],
					requirements: [
						{type: 'discover', id: 'CO2'},
						{type: 'discover', id: 'CO'},
						{type: 'discover', id: 'CH4'}
					],
					reward: translate({de: 'Freischaltung des UV-Lichts', en: 'Unlocks UV Light'}),
					completed: false,
					progress: 0,
					unlockLevel: 3,
					onComplete: () => {
						// Make sure UV light is available in equipment
						const uvLightEquipment = availableEquipment.value.find(e => e.id === 'uv_light');
						if (uvLightEquipment) {
							uvLightEquipment.disabled = false;
						}

						// Unlock O2 needed for mission 4
						if (!discoveredItems.value.some(i => i.id === 'O2')) {
							discoveredItems.value.push({
								id: 'O2',
								symbol: 'O₂',
								name: translate({de: 'Sauerstoffgas', en: 'Oxygen Gas'}),
								description: translate({
									de: 'Notwendig zum Atmen und für Verbrennungsreaktionen.',
									en: 'Necessary for breathing and combustion reactions.'
								}),
								category: 'molecule',
								color: 'red',
								formula: 'O₂',
								state: 'gas'
							});
						}
					}
				},
				{
					id: 'mission4',
					title: translate({de: 'Metallverarbeitung', en: 'Metal Processing'}),
					description: translate({
						de: 'Erzeuge Rost und führe einen Schmelzprozess durch, um Stahl herzustellen.',
						en: 'Create rust and perform a smelting process to produce steel.'
					}),
					hints: [
						translate({
							de: 'Kombiniere Eisen (Fe) mit Sauerstoff (O₂), um Rost (Fe₂O₃) zu erzeugen.',
							en: 'Combine Iron (Fe) with Oxygen (O₂) to create Rust (Fe₂O₃).'
						}),
						translate({
							de: 'Für die Eisengewinnung brauchst du Rost (Fe₂O₃), Kohlenstoff (C) und den Bunsenbrenner. Stelle eine Temperatur zwischen 700°C und 1200°C ein.',
							en: 'For Iron Smelting, you need Rust (Fe₂O₃), Carbon (C), and the Bunsen Burner. Set a temperature between 700°C and 1200°C.'
						}),
						translate({
							de: 'Erzeuge Stahl, indem du Eisen (Fe) und Kohlenstoff (C) mit dem Bunsenbrenner bei 800°C bis 1200°C kombinierst.',
							en: 'Create Steel by combining Iron (Fe) and Carbon (C) with the Bunsen Burner at 800°C to 1200°C.'
						})
					],
					requirementDetails: [
						{
							id: 'Fe2O3',
							ingredients: ['Fe', 'O2'],
							equipmentNeeded: []
						},
						{
							id: 'Fe_CO2',
							ingredients: ['Fe2O3', 'C'],
							equipmentNeeded: ['bunsen_burner'],
							temperature: {min: 700, max: 1200}
						},
						{
							id: 'steel',
							ingredients: ['Fe', 'C'],
							equipmentNeeded: ['bunsen_burner'],
							temperature: {min: 800, max: 1200}
						}
					],
					requirements: [
						{type: 'discover', id: 'Fe2O3'},
						{type: 'discover', id: 'Fe_CO2'},
						{type: 'discover', id: 'steel'}
					],
					reward: translate({
						de: 'Freischaltung fortgeschrittener Metalle: Cu, Ag, Au',
						en: 'Unlocks advanced metals: Cu, Ag, Au'
					}),
					completed: false,
					progress: 0,
					unlockLevel: 4,
					onComplete: () => {
						// Unlock advanced metals
						advancedElements.value
							.filter(e => ['Cu', 'Ag', 'Au'].includes(e.id))
							.forEach(metal => {
								if (!discoveredItems.value.some(i => i.id === metal.id)) {
									discoveredItems.value.push({
										...metal,
										category: 'element'
									});
								}
							});

						// Ensure Zn and Br are available for missions 5-7
						['Zn', 'Br'].forEach(elementId => {
							const element = advancedElements.value.find(e => e.id === elementId);
							if (element && !discoveredItems.value.some(i => i.id === elementId)) {
								discoveredItems.value.push({
									...element,
									category: 'element'
								});
							}
						});
					}
				},
				{
					id: 'mission5',
					title: translate({de: 'Elektrolyse', en: 'Electrolysis'}),
					description: translate({
						de: 'Führe Elektrolyse von Wasser und Salzlösung durch.',
						en: 'Perform electrolysis of water and salt solution.'
					}),
					hints: [
						translate({
							de: 'Für die Wasserelektrolyse benötigst du Wasser (H₂O), Elektrizität und ein Becherglas.',
							en: 'For water electrolysis, you need Water (H₂O), Electricity, and a Beaker.'
						}),
						translate({
							de: 'Für den Chlor-Alkali-Prozess kombiniere Kochsalz (NaCl), Wasser (H₂O), Elektrizität und ein Becherglas.',
							en: 'For the Chlor-Alkali Process, combine Table Salt (NaCl), Water (H₂O), Electricity, and a Beaker.'
						})
					],
					requirementDetails: [
						{
							id: 'electrolysis',
							ingredients: ['H2O'],
							equipmentNeeded: ['electricity', 'beaker']
						},
						{
							id: 'NaCl_electrolysis',
							ingredients: ['NaCl', 'H2O'],
							equipmentNeeded: ['electricity', 'beaker']
						}
					],
					requirements: [
						{type: 'discover', id: 'electrolysis'},
						{type: 'discover', id: 'NaCl_electrolysis'}
					],
					reward: translate({de: 'Freischaltung des Katalysators', en: 'Unlocks Catalyst'}),
					completed: false,
					progress: 0,
					unlockLevel: 5,
					onComplete: () => {
						// Make sure catalyst is available in equipment
						const catalystEquipment = availableEquipment.value.find(e => e.id === 'catalyst');
						if (catalystEquipment) {
							catalystEquipment.disabled = false;
						}

						// Unlock Fluor for halogen mission
						advancedElements.value
							.filter(e => ['F'].includes(e.id))
							.forEach(element => {
								if (!discoveredItems.value.some(i => i.id === element.id)) {
									discoveredItems.value.push({
										...element,
										category: 'element'
									});
								}
							});

						// Add SiO2 which is needed for mission 6
						if (!discoveredItems.value.some(i => i.id === 'SiO2')) {
							discoveredItems.value.push({
								id: 'SiO2',
								symbol: 'SiO₂',
								name: translate({de: 'Siliziumdioxid', en: 'Silicon Dioxide'}),
								description: translate({
									de: 'Hauptbestandteil von Sand und Quarz, wird für Glas und Elektronik verwendet.',
									en: 'Main component of sand and quartz, used for glass and electronics.'
								}),
								category: 'compound',
								color: 'white',
								formula: 'SiO₂',
								state: 'solid'
							});
						}
					}
				},
				{
					id: 'mission6',
					title: translate({de: 'Halogenchemie', en: 'Halogen Chemistry'}),
					description: translate({
						de: 'Erforsche die reaktiven Halogene und stelle Fluorwasserstoff her.',
						en: 'Explore reactive halogens and create hydrogen fluoride.'
					}),
					hints: [
						translate({
							de: 'Kombiniere Wasserstoff (H) mit Fluor (F), um Fluorwasserstoff (HF) zu erzeugen.',
							en: 'Combine Hydrogen (H) with Fluorine (F) to create Hydrogen Fluoride (HF).'
						}),
						translate({
							de: 'Für die Glasätzung benötigst du Fluorwasserstoff (HF), Siliziumdioxid (SiO₂) und ein Becherglas.',
							en: 'For Glass Etching, you need Hydrogen Fluoride (HF), Silicon Dioxide (SiO₂), and a Beaker.'
						})
					],
					requirementDetails: [
						{
							id: 'HF',
							ingredients: ['H', 'F'],
							equipmentNeeded: []
						},
						{
							id: 'glass_etching',
							ingredients: ['HF', 'SiO2'],
							equipmentNeeded: ['beaker']
						}
					],
					requirements: [
						{type: 'discover', id: 'HF'},
						{type: 'discover', id: 'glass_etching'}
					],
					reward: translate({
						de: 'Freischaltung des Destillationsapparats',
						en: 'Unlocks Distillation Apparatus'
					}),
					completed: false,
					progress: 0,
					unlockLevel: 6,
					onComplete: () => {
						// Make sure distillation apparatus is available in equipment
						const distillationEquipment = availableEquipment.value.find(e => e.id === 'distillation');
						if (distillationEquipment) {
							distillationEquipment.disabled = false;
						}
					}
				},
				{
					id: 'mission7',
					title: translate({de: 'Fotografische Chemie', en: 'Photographic Chemistry'}),
					description: translate({
						de: 'Entdecke lichtempfindliche Silberverbindungen für die Fotografie.',
						en: 'Discover light-sensitive silver compounds for photography.'
					}),
					hints: [
						translate({
							de: 'Kombiniere Silber (Ag) mit Brom (Br), um Silberbromid (AgBr) herzustellen. Verwende das UV-Licht als Ausrüstung.',
							en: 'Combine Silver (Ag) with Bromine (Br) to create Silver Bromide (AgBr). Use the UV Light equipment.'
						}),
						translate({
							de: 'Für die fotografische Reaktion kombiniere Silberbromid (AgBr) mit Wasser (H₂O) und verwende das UV-Licht.',
							en: 'For the Photographic Reaction, combine Silver Bromide (AgBr) with Water (H₂O) and use the UV Light.'
						})
					],
					requirementDetails: [
						{
							id: 'AgBr',
							ingredients: ['Ag', 'Br'],
							equipmentNeeded: ['uv_light']
						},
						{
							id: 'photography',
							ingredients: ['AgBr', 'H2O'],
							equipmentNeeded: ['uv_light']
						}
					],
					requirements: [
						{type: 'discover', id: 'AgBr'},
						{type: 'discover', id: 'photography'}
					],
					reward: translate({
						de: 'Freischaltung fortgeschrittener Ausrüstung',
						en: 'Unlocks Advanced Equipment'
					}),
					completed: false,
					progress: 0,
					unlockLevel: 7,
					onComplete: () => {
						// This mission unlocks materials needed for organic synthesis
						const organicMaterials = [
							{
								id: 'C2H5OH',
								symbol: 'C₂H₅OH',
								name: translate({de: 'Ethanol', en: 'Ethanol'}),
								description: translate({
									de: 'Alkohol in alkoholischen Getränken, wird auch als Kraftstoff verwendet.',
									en: 'Alcohol in alcoholic beverages, also used as fuel.'
								}),
								category: 'molecule',
								color: 'blue',
								formula: 'C₂H₅OH',
								state: 'liquid'
							},
							{
								id: 'CH3COOH',
								symbol: 'CH₃COOH',
								name: translate({de: 'Essigsäure', en: 'Acetic Acid'}),
								description: translate({
									de: 'Organische Säure, Hauptbestandteil von Essig, saurer Geschmack.',
									en: 'Organic acid, main component of vinegar, sour taste.'
								}),
								category: 'molecule',
								color: 'yellow',
								formula: 'CH₃COOH',
								state: 'liquid'
							},
							{
								id: 'C6H12O6',
								symbol: 'C₆H₁₂O₆',
								name: translate({de: 'Glukose', en: 'Glucose'}),
								description: translate({
									de: 'Einfacher Zucker, wichtige Energiequelle für Lebewesen.',
									en: 'Simple sugar, important energy source for living organisms.'
								}),
								category: 'molecule',
								color: 'amber',
								formula: 'C₆H₁₂O₆',
								state: 'solid'
							}
						];

						organicMaterials.forEach(material => {
							if (!discoveredItems.value.some(i => i.id === material.id)) {
								discoveredItems.value.push(material);
							}
						});

						addNotification(
							translate({de: 'Neue Fähigkeiten', en: 'New Capabilities'}),
							translate({
								de: 'Du kannst nun fortgeschrittene fotochemische Reaktionen durchführen!',
								en: 'You can now perform advanced photochemical reactions!'
							}),
							'info'
						);
					}
				},
				{
					id: 'mission8',
					title: translate({de: 'Organische Synthese', en: 'Organic Synthesis'}),
					description: translate({
						de: 'Führe organische Reaktionen und Veresterung durch.',
						en: 'Conduct organic reactions and esterification.'
					}),
					hints: [
						translate({
							de: 'Für die Fermentation brauchst du Glukose (C₆H₁₂O₆) und ein Becherglas.',
							en: 'For Fermentation, you need Glucose (C₆H₁₂O₆) and a Beaker.'
						}),
						translate({
							de: 'Für die Veresterung kombiniere Ethanol (C₂H₅OH) mit Essigsäure (CH₃COOH) und verwende ein Becherglas und einen Katalysator.',
							en: 'For Esterification, combine Ethanol (C₂H₅OH) with Acetic Acid (CH₃COOH) and use a Beaker and a Catalyst.'
						})
					],
					requirementDetails: [
						{
							id: 'fermentation',
							ingredients: ['C6H12O6'],
							equipmentNeeded: ['beaker']
						},
						{
							id: 'esterification',
							ingredients: ['C2H5OH', 'CH3COOH'],
							equipmentNeeded: ['beaker', 'catalyst']
						}
					],
					requirements: [
						{type: 'discover', id: 'fermentation'},
						{type: 'discover', id: 'esterification'}
					],
					reward: translate({
						de: 'Freischaltung komplexer organischer Reaktionen',
						en: 'Unlocks Complex Organic Reactions'
					}),
					completed: false,
					progress: 0,
					unlockLevel: 8,
					onComplete: () => {
						// Unlock materials needed for industrial processes
						const industrialMaterials = [
							{
								id: 'crude_oil',
								symbol: '🛢️',
								name: translate({de: 'Rohöl', en: 'Crude Oil'}),
								description: translate({
									de: 'Komplexe Mischung aus verschiedenen Kohlenwasserstoffen, Grundlage für Treibstoffe und Petrochemikalien.',
									en: 'Complex mixture of various hydrocarbons, basis for fuels and petrochemicals.'
								}),
								category: 'mixture',
								color: 'brown',
								formula: 'C₁₅H₃₂ + C₈H₁₈ + ...',
								state: 'liquid'
							},
							{
								id: 'H2',
								symbol: 'H₂',
								name: translate({de: 'Wasserstoffgas', en: 'Hydrogen Gas'}),
								description: translate({
									de: 'Leichtestes Element, brennbar und potenzieller Kraftstoff.',
									en: 'Lightest element, flammable and potential fuel.'
								}),
								category: 'molecule',
								color: 'blue',
								formula: 'H₂',
								state: 'gas'
							}
						];

						industrialMaterials.forEach(material => {
							if (!discoveredItems.value.some(i => i.id === material.id)) {
								discoveredItems.value.push(material);
							}
						});

						addNotification(
							translate({de: 'Organische Meisterschaft', en: 'Organic Mastery'}),
							translate({
								de: 'Du hast die Kunst der organischen Synthese gemeistert!',
								en: 'You have mastered the art of organic synthesis!'
							}),
							'info'
						);
					}
				},
				{
					id: 'mission9',
					title: translate({de: 'Industrielle Prozesse', en: 'Industrial Processes'}),
					description: translate({
						de: 'Führe industriell wichtige Prozesse wie den Haber-Prozess durch.',
						en: 'Conduct industrially important processes like the Haber process.'
					}),
					hints: [
						translate({
							de: 'Für den Haber-Prozess kombiniere Stickstoff (N₂) mit Wasserstoff (H₂) und verwende einen Katalysator und ein Becherglas.',
							en: 'For the Haber Process, combine Nitrogen (N₂) with Hydrogen (H₂) and use a Catalyst and a Beaker.'
						}),
						translate({
							de: 'Für die Erdöldestillation brauchst du Rohöl, den Destillationsapparat und den Bunsenbrenner. Die Temperatur sollte zwischen 25°C und 400°C liegen.',
							en: 'For Petroleum Distillation, you need Crude Oil, the Distillation Apparatus, and the Bunsen Burner. Temperature should be between 25°C and 400°C.'
						})
					],
					requirementDetails: [
						{
							id: 'haber_process',
							ingredients: ['N2', 'H2'],
							equipmentNeeded: ['catalyst', 'beaker']
						},
						{
							id: 'petroleum_distillation',
							ingredients: ['crude_oil'],
							equipmentNeeded: ['distillation', 'bunsen_burner'],
							temperature: {min: 25, max: 400}
						}
					],
					requirements: [
						{type: 'discover', id: 'haber_process'},
						{type: 'discover', id: 'petroleum_distillation'}
					],
					reward: translate({
						de: 'Freischaltung fortgeschrittener industrieller Prozesse',
						en: 'Unlocks Advanced Industrial Processes'
					}),
					completed: false,
					progress: 0,
					unlockLevel: 9,
					onComplete: () => {
						// Unlock remaining metals needed for the final mission
						advancedElements.value
							.filter(e => ['Sn'].includes(e.id))
							.forEach(element => {
								if (!discoveredItems.value.some(i => i.id === element.id)) {
									discoveredItems.value.push({
										...element,
										category: 'element'
									});
								}
							});

						addNotification(
							translate({de: 'Industrielle Revolution', en: 'Industrial Revolution'}),
							translate({
								de: 'Du kannst nun fortgeschrittene industrielle Prozesse durchführen!',
								en: 'You can now perform advanced industrial processes!'
							}),
							'info'
						);
					}
				},
				{
					id: 'mission10',
					title: translate({de: 'Materialien der Zukunft', en: 'Materials of the Future'}),
					description: translate({
						de: 'Erforsche moderne Materialien und Legierungen.',
						en: 'Research modern materials and alloys.'
					}),
					hints: [
						translate({
							de: 'Für Messing kombiniere Kupfer (Cu) mit Zink (Zn) und verwende den Bunsenbrenner. Die Temperatur sollte zwischen 900°C und 1000°C liegen.',
							en: 'For Brass, combine Copper (Cu) with Zinc (Zn) and use the Bunsen Burner. Temperature should be between 900°C and 1000°C.'
						}),
						translate({
							de: 'Für Bronze kombiniere Kupfer (Cu) mit Zinn (Sn) und verwende den Bunsenbrenner. Die Temperatur sollte zwischen 950°C und 1050°C liegen.',
							en: 'For Bronze, combine Copper (Cu) with Tin (Sn) and use the Bunsen Burner. Temperature should be between 950°C and 1050°C.'
						})
					],
					requirementDetails: [
						{
							id: 'brass',
							ingredients: ['Cu', 'Zn'],
							equipmentNeeded: ['bunsen_burner'],
							temperature: {min: 900, max: 1000}
						},
						{
							id: 'bronze',
							ingredients: ['Cu', 'Sn'],
							equipmentNeeded: ['bunsen_burner'],
							temperature: {min: 950, max: 1050}
						}
					],
					requirements: [
						{type: 'discover', id: 'brass'},
						{type: 'discover', id: 'bronze'}
					],
					reward: translate({de: 'Meister der Chemie Auszeichnung', en: 'Master of Chemistry Achievement'}),
					completed: false,
					progress: 0,
					unlockLevel: 10,
					onComplete: () => {
						// Award final achievement
						const masterAchievement = achievements.value.find(a => a.id === 'achievement10');
						if (masterAchievement && !masterAchievement.unlocked) {
							masterAchievement.unlocked = true;
							addNotification(
								translate({de: 'Meisterschaft erreicht!', en: 'Mastery Achieved!'}),
								translate({
									de: 'Du bist ein wahrer Meister der Chemie geworden!',
									en: 'You have become a true master of chemistry!'
								}),
								'achievement'
							);
						}
					}
				},
				{
					id: 'mission11',
					title: translate({de: 'Säurechemie', en: 'Acid Chemistry'}),
					description: translate({
						de: 'Erzeuge verschiedene Mineralsäuren und untersuche ihre Eigenschaften.',
						en: 'Create various mineral acids and study their properties.'
					}),
					hints: [
						translate({
							de: 'Für Salpetersäure (HNO₃) kombiniere Stickstoff (N), Sauerstoff (O), Sauerstoff (O) und Wasserstoff (H). Verwende ein Becherglas und einen Katalysator.',
							en: 'For Nitric Acid (HNO₃), combine Nitrogen (N), Oxygen (O), Oxygen (O), and Hydrogen (H). Use a Beaker and a Catalyst.'
						}),
						translate({
							de: 'Für Phosphorsäure (H₃PO₄) kombiniere Phosphor (P), vier Sauerstoffatome (O) und drei Wasserstoffatome (H) mit einem Becherglas.',
							en: 'For Phosphoric Acid (H₃PO₄), combine Phosphorus (P), four Oxygen atoms (O), and three Hydrogen atoms (H) with a Beaker.'
						}),
						translate({
							de: 'Für konzentrierte Schwefelsäure verwende zwei Schwefelsäuremoleküle (H₂SO₄) mit dem Destillationsapparat.',
							en: 'For concentrated Sulfuric Acid, use two Sulfuric Acid molecules (H₂SO₄) with the Distillation Apparatus.'
						})
					],
					requirementDetails: [
						{
							id: 'HNO3',
							ingredients: ['N', 'O', 'O', 'H'],
							equipmentNeeded: ['beaker', 'catalyst']
						},
						{
							id: 'H3PO4',
							ingredients: ['P', 'O', 'O', 'O', 'O', 'H', 'H', 'H'],
							equipmentNeeded: ['beaker']
						},
						{
							id: 'H2SO4_conc',
							ingredients: ['H2SO4', 'H2SO4'],
							equipmentNeeded: ['distillation']
						}
					],
					requirements: [
						{type: 'discover', id: 'HNO3'},
						{type: 'discover', id: 'H3PO4'},
						{type: 'discover', id: 'H2SO4_conc'}
					],
					reward: translate({
						de: 'Freischaltung erweiterter Säurereaktionen',
						en: 'Unlocks advanced acid reactions'
					}),
					completed: false,
					progress: 0,
					unlockLevel: 11,
					onComplete: () => {
						// Ensure H2SO4 is unlocked for mission 12
						if (!discoveredItems.value.some(i => i.id === 'H2SO4')) {
							discoveredItems.value.push({
								id: 'H2SO4',
								symbol: 'H₂SO₄',
								name: translate({de: 'Schwefelsäure', en: 'Sulfuric Acid'}),
								description: translate({
									de: 'Starke, korrosive Säure, wichtig in der Industrie.',
									en: 'Strong, corrosive acid, important in industry.'
								}),
								category: 'compound',
								color: 'yellow',
								formula: 'H₂SO₄',
								state: 'liquid'
							});
						}

						// Ensure SO2 is unlocked for mission 12
						if (!discoveredItems.value.some(i => i.id === 'SO2')) {
							discoveredItems.value.push({
								id: 'SO2',
								symbol: 'SO₂',
								name: translate({de: 'Schwefeldioxid', en: 'Sulfur Dioxide'}),
								description: translate({
									de: 'Reizgas, entsteht bei Verbrennung schwefelhaltiger Brennstoffe.',
									en: 'Irritant gas, produced by burning sulfur-containing fuels.'
								}),
								category: 'molecule',
								color: 'yellow',
								formula: 'SO₂',
								state: 'gas'
							});
						}

						addNotification(
							translate({de: 'Säure-Meister', en: 'Acid Master'}),
							translate({
								de: 'Du beherrschst nun die Herstellung und Anwendung starker Säuren!',
								en: 'You now master the production and application of strong acids!'
							}),
							'info'
						);
					}
				},
				{
					id: 'mission12',
					title: translate({de: 'Industrielle Revolution', en: 'Industrial Revolution'}),
					description: translate({
						de: 'Führe industrielle Verfahren wie das Kontaktverfahren und das Ostwald-Verfahren durch.',
						en: 'Conduct industrial processes like the Contact Process and Ostwald Process.'
					}),
					hints: [
						translate({
							de: 'Für das Kontaktverfahren kombiniere Schwefeldioxid (SO₂), Sauerstoff (O₂) und Wasser (H₂O) mit einem Katalysator und einem Becherglas. Die Temperatur sollte zwischen 400°C und 600°C liegen.',
							en: 'For the Contact Process, combine Sulfur Dioxide (SO₂), Oxygen (O₂), and Water (H₂O) with a Catalyst and a Beaker. Temperature should be between 400°C and 600°C.'
						}),
						translate({
							de: 'Für das Ostwald-Verfahren kombiniere Stickstoff (N), Sauerstoff (O) und Sauerstoff (O) mit einem Katalysator. Die Temperatur sollte zwischen 300°C und 600°C liegen.',
							en: 'For the Ostwald Process, combine Nitrogen (N), Oxygen (O), and Oxygen (O) with a Catalyst. Temperature should be between 300°C and 600°C.'
						}),
						translate({
							de: 'Für das katalytische Cracken brauchst du Rohöl, einen Katalysator und den Destillationsapparat. Die Temperatur sollte zwischen 450°C und 700°C liegen.',
							en: 'For Catalytic Cracking, you need Crude Oil, a Catalyst, and the Distillation Apparatus. Temperature should be between 450°C and 700°C.'
						})
					],
					requirementDetails: [
						{
							id: 'contact_process',
							ingredients: ['SO2', 'O2', 'H2O'],
							equipmentNeeded: ['catalyst', 'beaker'],
							temperature: {min: 400, max: 600}
						},
						{
							id: 'ostwald',
							ingredients: ['N', 'O', 'O'],
							equipmentNeeded: ['catalyst'],
							temperature: {min: 300, max: 600}
						},
						{
							id: 'catalytic_cracking',
							ingredients: ['crude_oil'],
							equipmentNeeded: ['catalyst', 'distillation'],
							temperature: {min: 450, max: 700}
						}
					],
					requirements: [
						{type: 'discover', id: 'contact_process'},
						{type: 'discover', id: 'ostwald'},
						{type: 'discover', id: 'catalytic_cracking'}
					],
					reward: translate({
						de: 'Freischaltung modernster Katalysatoren',
						en: 'Unlocks cutting-edge catalysts'
					}),
					completed: false,
					progress: 0,
					unlockLevel: 12,
					onComplete: () => {
						// Ensure C2H4 is unlocked for mission 13
						if (!discoveredItems.value.some(i => i.id === 'C2H4')) {
							discoveredItems.value.push({
								id: 'C2H4',
								symbol: 'C₂H₄',
								name: translate({de: 'Ethylen', en: 'Ethylene'}),
								description: translate({
									de: 'Einfachster ungesättigter Kohlenwasserstoff, wichtig für die Kunststoffherstellung.',
									en: 'Simplest unsaturated hydrocarbon, important for plastic production.'
								}),
								category: 'molecule',
								color: 'indigo',
								formula: 'C₂H₄',
								state: 'gas'
							});
						}

						addNotification(
							translate({de: 'Industrieexperte', en: 'Industry Expert'}),
							translate({
								de: 'Du beherrschst nun die komplexesten industriellen Prozesse!',
								en: 'You now master the most complex industrial processes!'
							}),
							'info'
						);
					}
				},
				{
					id: 'mission13',
					title: translate({de: 'Organische Chemie', en: 'Organic Chemistry'}),
					description: translate({
						de: 'Synthetisiere komplexe organische Verbindungen und Polymere.',
						en: 'Synthesize complex organic compounds and polymers.'
					}),
					hints: [
						translate({
							de: 'Für Glycerin (C₃H₈O₃) kombiniere drei Kohlenstoffatome (C), acht Wasserstoffatome (H) und drei Sauerstoffatome (O) mit einem Becherglas und einem Katalysator.',
							en: 'For Glycerol (C₃H₈O₃), combine three Carbon atoms (C), eight Hydrogen atoms (H), and three Oxygen atoms (O) with a Beaker and a Catalyst.'
						}),
						translate({
							de: 'Für Aceton (C₃H₆O) kombiniere drei Kohlenstoffatome (C), sechs Wasserstoffatome (H) und ein Sauerstoffatom (O) mit dem Destillationsapparat.',
							en: 'For Acetone (C₃H₆O), combine three Carbon atoms (C), six Hydrogen atoms (H), and one Oxygen atom (O) with the Distillation Apparatus.'
						}),
						translate({
							de: 'Für Polyethylen verbinde vier Ethylenmoleküle (C₂H₄) mit einem Katalysator und einem Becherglas. Die Temperatur sollte zwischen 80°C und 250°C liegen.',
							en: 'For Polyethylene, connect four Ethylene molecules (C₂H₄) with a Catalyst and a Beaker. Temperature should be between 80°C and 250°C.'
						})
					],
					requirementDetails: [
						{
							id: 'C3H8O3',
							ingredients: ['C', 'C', 'C', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'O', 'O', 'O'],
							equipmentNeeded: ['beaker', 'catalyst']
						},
						{
							id: 'C3H6O',
							ingredients: ['C', 'C', 'C', 'H', 'H', 'H', 'H', 'H', 'H', 'O'],
							equipmentNeeded: ['distillation']
						},
						{
							id: 'polyethylene',
							ingredients: ['C2H4', 'C2H4', 'C2H4', 'C2H4'],
							equipmentNeeded: ['catalyst', 'beaker'],
							temperature: {min: 80, max: 250}
						}
					],
					requirements: [
						{type: 'discover', id: 'C3H8O3'},
						{type: 'discover', id: 'C3H6O'},
						{type: 'discover', id: 'polyethylene'}
					],
					reward: translate({
						de: 'Freischaltung biochemischer Reaktionen',
						en: 'Unlocks biochemical reactions'
					}),
					completed: false,
					progress: 0,
					unlockLevel: 13,
					onComplete: () => {
						addNotification(
							translate({de: 'Organischer Chemiker', en: 'Organic Chemist'}),
							translate({
								de: 'Du hast die Fähigkeiten eines organischen Chemikers erlangt!',
								en: 'You have gained the skills of an organic chemist!'
							}),
							'info'
						);

						// Add final achievement
						const masterAchievement = achievements.value.find(a => a.id === 'achievement10');
						if (masterAchievement && !masterAchievement.unlocked) {
							masterAchievement.unlocked = true;
							addNotification(
								translate({de: 'Der ultimative Chemiker', en: 'The Ultimate Chemist'}),
								translate({
									de: 'Du hast alle Geheimnisse der Chemie gemeistert!',
									en: 'You have mastered all the secrets of chemistry!'
								}),
								'achievement'
							);
						}

						// Unlock all missing elements
						advancedElements.value
							.forEach(element => {
								if (!discoveredItems.value.some(i => i.id === element.id)) {
									discoveredItems.value.push({
										...element,
										category: 'element'
									});
								}
							});
					}
				}
			]);

			function getMissionHints(mission) {
				if (!mission || !mission.hints) return [];
				return mission.hints;
			}

			function getMissionIngredients(mission, requirementId) {
				if (!mission || !mission.requirementDetails) return null;
				return mission.requirementDetails.find(detail => detail.id === requirementId);
			}

			function isIngredientAvailable(ingredientId) {
				return basicElements.value.some(el => el.id === ingredientId) ||
					discoveredItems.value.some(item => item.id === ingredientId);
			}

			// Available missions based on level
			const availableMissions = computed(() => {
				return missions.value.filter(mission => mission.unlockLevel <= playerLevel.value);
			});

			// Achievements
			const achievements = ref([
				{
					id: 'achievement1',
					title: translate({de: 'Chemiker in Ausbildung', en: 'Chemist in Training'}),
					description: translate({
						de: 'Entdecke 5 verschiedene Verbindungen.',
						en: 'Discover 5 different compounds.'
					}),
					requirement: {type: 'discoveryCount', count: 5},
					unlocked: false
				},
				{
					id: 'achievement2',
					title: translate({de: 'Laborassistent', en: 'Lab Assistant'}),
					description: translate({
						de: 'Schließe deine erste Mission ab.',
						en: 'Complete your first mission.'
					}),
					requirement: {type: 'missionCount', count: 1},
					unlocked: false
				},
				{
					id: 'achievement3',
					title: translate({de: 'Elementar, mein Lieber!', en: 'Elementary, My Dear!'}),
					description: translate({de: 'Entdecke alle Grundelemente.', en: 'Discover all basic elements.'}),
					requirement: {
						type: 'elementCount',
						count: basicElements.value.length + advancedElements.value.length
					},
					unlocked: false
				},
				{
					id: 'achievement4',
					title: translate({de: 'Meister der Mischungen', en: 'Master of Mixtures'}),
					description: translate({
						de: 'Erzeuge 3 verschiedene Gemische.',
						en: 'Create 3 different mixtures.'
					}),
					requirement: {type: 'categoryCount', category: 'mixture', count: 3},
					unlocked: false
				},
				{
					id: 'achievement5',
					title: translate({de: 'Reaktionsexperte', en: 'Reaction Expert'}),
					description: translate({
						de: 'Führe 5 verschiedene Reaktionen durch.',
						en: 'Perform 5 different reactions.'
					}),
					requirement: {type: 'categoryCount', category: 'reaction', count: 5},
					unlocked: false
				},
				{
					id: 'achievement6',
					title: translate({de: 'Alchemist', en: 'Alchemist'}),
					description: translate({de: 'Erreiche Level 10.', en: 'Reach Level 10.'}),
					requirement: {type: 'level', level: 10},
					unlocked: false
				},
				// NEW ACHIEVEMENTS
				{
					id: 'achievement7',
					title: translate({de: 'Moleküldesigner', en: 'Molecule Designer'}),
					description: translate({
						de: 'Entdecke 15 verschiedene Moleküle.',
						en: 'Discover 15 different molecules.'
					}),
					requirement: {type: 'categoryCount', category: 'molecule', count: 15},
					unlocked: false
				},
				{
					id: 'achievement8',
					title: translate({de: 'Industriechemiker', en: 'Industrial Chemist'}),
					description: translate({
						de: 'Führe 10 komplexe Reaktionen durch, die Ausrüstung erfordern.',
						en: 'Perform 10 complex reactions requiring equipment.'
					}),
					requirement: {type: 'equipmentReactionCount', count: 10},
					unlocked: false
				},
				{
					id: 'achievement9',
					title: translate({de: 'Metallurgie-Meister', en: 'Master Metallurgist'}),
					description: translate({
						de: 'Entdecke alle Metalle und Legierungen.',
						en: 'Discover all metals and alloys.'
					}),
					requirement: {type: 'metalCount', count: 5},
					unlocked: false
				},
				{
					id: 'achievement10',
					title: translate({de: 'Chemie-Virtuose', en: 'Chemistry Virtuoso'}),
					description: translate({de: 'Schließe alle Missionen ab.', en: 'Complete all missions.'}),
					requirement: {type: 'completeMissions', count: missions.value.length},
					unlocked: false
				}
			]);

			// Total number of recipes that can be discovered
			const recipeCount = computed(() => {
				return recipes.value.length;
			});

			// Check achievements
			function checkAchievements() {
				achievements.value.forEach(achievement => {
					if (!achievement.unlocked) {
						let completed = false;

						if (achievement.requirement.type === 'discoveryCount') {
							completed = discoveredItems.value.length >= achievement.requirement.count;
						} else if (achievement.requirement.type === 'missionCount') {
							completed = missions.value.filter(m => m.completed).length >= achievement.requirement.count;
						} else if (achievement.requirement.type === 'elementCount') {
							const elements = discoveredItems.value.filter(item => item.category === 'element');
							completed = elements.length >= achievement.requirement.count;
						} else if (achievement.requirement.type === 'categoryCount') {
							const items = discoveredItems.value.filter(item => item.category === achievement.requirement.category);
							completed = items.length >= achievement.requirement.count;
						} else if (achievement.requirement.type === 'level') {
							completed = playerLevel.value >= achievement.requirement.level;
						} else if (achievement.requirement.type === 'equipmentReactionCount') {
							// Count reactions that required equipment
							const recipes = discoveredItems.value.filter(item =>
								item.category === 'reaction' &&
								getDiscoveryRecipe(item)?.requiredEquipment?.length > 0
							);
							completed = recipes.length >= achievement.requirement.count;
						} else if (achievement.requirement.type === 'metalCount') {
							// Count discovered metals and alloys
							const metalIds = ['Cu', 'Ag', 'Au', 'Fe', 'steel', 'brass', 'bronze'];
							const discoveredMetals = discoveredItems.value.filter(item => metalIds.includes(item.id));
							completed = discoveredMetals.length >= achievement.requirement.count;
						} else if (achievement.requirement.type === 'completeMissions') {
							// Check if all missions are completed
							completed = missions.value.filter(m => m.completed).length >= achievement.requirement.count;
						}

						if (completed) {
							achievement.unlocked = true;
							addNotification(
								translate({de: 'Errungenschaft freigeschaltet!', en: 'Achievement Unlocked!'}),
								achievement.title,
								'achievement'
							);
						}
					}
				});
			}

			// Calculate mission progress
			function calculateMissionProgress(mission) {
				if (mission.completed) return 100;

				const totalRequirements = mission.requirements.length;
				const completedRequirements = mission.requirements.filter(req => {
					if (req.type === 'discover') {
						return discoveredItems.value.some(item => item.id === req.id);
					}
					return false;
				}).length;

				mission.progress = completedRequirements;
				return Math.round((completedRequirements / totalRequirements) * 100);
			}

			// Get mission progress text
			function getMissionProgressText(mission) {
				return `${mission.progress}/${mission.requirements.length}`;
			}

			// Check mission completion
			function checkMissions(runCompletionCode) {
				if (runCompletionCode) {
					// When the mission is completed, ensure, that the complete-script is executed
					missions.value.forEach(mission => {
						if (mission.completed) {
							if (mission.onComplete && typeof mission.onComplete === 'function') {
								mission.onComplete();
							}
						}
					});
                }

				missions.value.forEach(mission => {
					if (!mission.completed) {
						// Calculate progress based on current discoveries
						const progress = calculateMissionProgress(mission);

						// Update mission progress
						mission.progress = mission.requirements.filter(req => {
							if (req.type === 'discover') {
								return discoveredItems.value.some(item => item.id === req.id);
							}
							return false;
						}).length;

						if (progress === 100) {
							mission.completed = true;

							// Run mission-specific completion code
							if (mission.onComplete && typeof mission.onComplete === 'function') {
								mission.onComplete();
							}

							addNotification(
								translate({de: 'Mission abgeschlossen!', en: 'Mission Completed!'}),
								mission.title,
								'mission'
							);

							// Level up
							playerLevel.value += 1;
							currentLevelProgress.value = 0;

							// Check if active mission was completed
							if (activeMission.value && activeMission.value.id === mission.id) {
								activeMission.value = null;
							}
						}
					}
				});
			}

			// Select active mission
			function selectActiveMission(mission) {
				// Initialize showHints property if not present
				if (mission.showHints === undefined) {
					mission.showHints = false;
				}

				activeMission.value = mission;
				showMissionsModal.value = false;

				// Show a helpful notification with the first hint
				if (mission.hints && mission.hints.length > 0) {
					addNotification(
						translate({de: 'Missionshinweis', en: 'Mission Hint'}),
						mission.hints[0],
						'info'
					);
				}
			}

			// Open missions modal
			function openMissionsModal() {
				showMissionsModal.value = true;
			}

			// Get element class for periodic table
			function getPeriodicElementClass(atomicNumber) {
				let category = '';

				// Simplified category determination based on atomic number
				if ([1, 2, 3, 4, 11, 12].includes(atomicNumber)) {
					category = 'metal'; // Actually H is non-metal, He is noble gas, but simplifying
				} else if ([5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 17, 18].includes(atomicNumber)) {
					category = 'nonmetal';
				}

				let discovered = basicElements.value.some(e => e.atomicNumber === atomicNumber) ||
					discoveredItems.value.some(i => i.atomicNumber === atomicNumber);

				let baseClass = 'cursor-pointer';

				if (category === 'metal') {
					baseClass += darkMode.value
						? (discovered ? ' bg-blue-700' : ' bg-gray-700')
						: (discovered ? ' bg-blue-200' : ' bg-gray-200');
				} else if (category === 'nonmetal') {
					baseClass += darkMode.value
						? (discovered ? ' bg-green-700' : ' bg-gray-700')
						: (discovered ? ' bg-green-200' : ' bg-gray-200');
				} else {
					baseClass += darkMode.value ? ' bg-gray-700' : ' bg-gray-200';
				}

				return baseClass;
			}

			// Show element information
			function showElementInfo(atomicNumber) {
				// Find element in basic or advanced elements
				const element = [...basicElements.value, ...advancedElements.value].find(e => e.atomicNumber === atomicNumber);

				if (element) {
					selectedElement.value = element;
				}
			}

			// Check if an element is available to use
			function isElementAvailable(symbol) {
				return basicElements.value.some(e => e.symbol === symbol) ||
					discoveredItems.value.some(i => i.symbol === symbol);
			}

			function getWorkspaceSuggestions() {
				if (!activeMission.value) return null;

				// Find the first incomplete requirement
				const incompleteReq = activeMission.value.requirements.find(req =>
					!discoveredItems.value.some(item => item.id === req.id)
				);

				if (!incompleteReq) return null;

				// Get the details for this requirement
				const details = getMissionIngredients(activeMission.value, incompleteReq.id);
				if (!details) return null;

				// Return structured suggestion
				return {
					targetCompound: incompleteReq.id,
					ingredients: details.ingredients,
					equipment: details.equipmentNeeded
				};
			}

			function displayWorkspaceHint() {
				const suggestion = getWorkspaceSuggestions();
				if (!suggestion) return null;

				const workspaceIds = workspace.value.map(item => item.id);
				const missingIngredients = suggestion.ingredients.filter(
					ing => !workspaceIds.includes(ing) && isIngredientAvailable(ing)
				);

				const activeEquipmentIds = activeEquipment.value.map(eq => eq.id);
				const missingEquipment = suggestion.equipment.filter(
					eq => !activeEquipmentIds.includes(eq)
				);

				return {
					target: getElementSymbolById(suggestion.targetCompound),
					missingIngredients: missingIngredients.map(id => getElementSymbolById(id)),
					missingEquipment: missingEquipment.map(id => getEquipmentNameById(id))
				};
			}

			// Add element to workspace by symbol
			function addElementToWorkspace(symbol) {
				const element = [...basicElements.value, ...discoveredItems.value].find(e => e.symbol === symbol || e.id === symbol);
				if (element) {
					addToWorkspace(element);
				}
			}

			// Show discovery details
			function showDiscoveryDetails(discovery) {
				selectedDiscovery.value = discovery;
			}

			// Get the recipe for a discovery
			function getDiscoveryRecipe(discovery) {
				return recipes.value.find(recipe => recipe.output.id === discovery.id);
			}

			// Get related discoveries
			function getRelatedDiscoveries(discovery) {
				// Find discoveries that share elements or are part of the same reaction
				const recipe = getDiscoveryRecipe(discovery);
				if (!recipe) return [];

				const relatedIds = recipe.inputs;

				// Get discoveries that are made from or with this discovery
				const relatedByUse = recipes.value
					.filter(r => r.inputs.includes(discovery.id))
					.map(r => r.output.id);

				return discoveredItems.value.filter(item =>
					relatedIds.includes(item.id) || relatedByUse.includes(item.id)
				);
			}

			// Get element symbol by ID
			function getElementSymbolById(id) {
				const element = [...basicElements.value, ...discoveredItems.value].find(e => e.id === id);
				return element ? element.symbol : id;
			}

			// Get element class by ID
			function getElementClassById(id) {
				const element = [...basicElements.value, ...discoveredItems.value].find(e => e.id === id);
				return element ? getElementClass(element) : '';
			}

			// Get equipment name by ID
			function getEquipmentNameById(id) {
				const equipment = availableEquipment.value.find(e => e.id === id);
				return equipment ? equipment.name : id;
			}

			// Translate state
			function translateState(state) {
				if (!state) return '';

				const stateMap = {
					'solid': translate({de: 'Fest', en: 'Solid'}),
					'liquid': translate({de: 'Flüssig', en: 'Liquid'}),
					'gas': translate({de: 'Gasförmig', en: 'Gas'}),
					'aqueous': translate({de: 'Wässrig', en: 'Aqueous'}),
					'mixed': translate({de: 'Gemischt', en: 'Mixed'})
				};

				return stateMap[state] || state;
			}

			// Translate category
			function translateCategory(category) {
				if (!category) return '';

				const categoryMap = {
					'element': translate({de: 'Element', en: 'Element'}),
					'molecule': translate({de: 'Molekül', en: 'Molecule'}),
					'compound': translate({de: 'Verbindung', en: 'Compound'}),
					'mixture': translate({de: 'Gemisch', en: 'Mixture'}),
					'reaction': translate({de: 'Reaktion', en: 'Reaction'}),
					'energy': translate({de: 'Energie', en: 'Energy'}),
					'special': translate({de: 'Spezial', en: 'Special'}),
					'equipment': translate({de: 'Ausrüstung', en: 'Equipment'})
				};

				return categoryMap[category] || category;
			}

			// Get the right class for elements based on their category and color
			function getElementClass(element) {
				if (!element) return '';

				let baseClass = '';

				// Base color based on element type
				switch (element.category) {
					case 'element':
						baseClass = darkMode.value ? 'bg-gray-700' : 'bg-gray-200';
						break;
					case 'molecule':
						baseClass = darkMode.value ? 'bg-blue-800' : 'bg-blue-100';
						break;
					case 'compound':
						baseClass = darkMode.value ? 'bg-indigo-800' : 'bg-indigo-100';
						break;
					case 'mixture':
						baseClass = darkMode.value ? 'bg-purple-800' : 'bg-purple-100';
						break;
					case 'reaction':
						baseClass = darkMode.value ? 'bg-red-800' : 'bg-red-100';
						break;
					case 'energy':
						baseClass = darkMode.value ? 'bg-yellow-700' : 'bg-yellow-100';
						break;
					case 'special':
						baseClass = darkMode.value ? 'bg-green-700' : 'bg-green-100';
						break;
					case 'equipment':
						baseClass = darkMode.value ? 'bg-cyan-700' : 'bg-cyan-100';
						break;
					default:
						baseClass = darkMode.value ? 'bg-gray-700' : 'bg-gray-200';
				}

				// Text color
				let textClass = darkMode.value ? 'text-white' : 'text-gray-900';

				// Border color based on element's specific color
				let borderClass = '';
				switch (element.color) {
					case 'blue':
						borderClass = 'border-blue-500';
						break;
					case 'red':
						borderClass = 'border-red-500';
						break;
					case 'green':
						borderClass = 'border-green-500';
						break;
					case 'yellow':
						borderClass = 'border-yellow-500';
						break;
					case 'purple':
						borderClass = 'border-purple-500';
						break;
					case 'gray':
						borderClass = 'border-gray-500';
						break;
					case 'orange':
						borderClass = 'border-orange-500';
						break;
					case 'cyan':
						borderClass = 'border-cyan-500';
						break;
					case 'indigo':
						borderClass = 'border-indigo-500';
						break;
					case 'white':
						borderClass = darkMode.value ? 'border-gray-300' : 'border-gray-400';
						break;
					case 'brown':
						borderClass = 'border-yellow-700';
						break;
					case 'silver':
						borderClass = 'border-gray-400';
						break;
					case 'gold':
						borderClass = 'border-yellow-500';
						break;
					default:
						borderClass = 'border-gray-500';
				}

				return `${baseClass} ${textClass} border-2 ${borderClass}`;
			}

			// Get notification icon class
			function notificationIconClass(type) {
				switch (type) {
					case 'discovery':
						return 'text-green-500';
					case 'mission':
						return 'text-yellow-500';
					case 'achievement':
						return 'text-purple-500';
					default:
						return 'text-blue-500';
				}
			}

			// Element dragging handlers
			function onDragStart(event, item, index, source) {
				event.dataTransfer.effectAllowed = 'copy';
				event.dataTransfer.setData('text/plain', JSON.stringify({
					item,
					index,
					source
				}));
			}

			function onDrop(event) {
				const data = JSON.parse(event.dataTransfer.getData('text/plain'));

				if (data.source === 'workspace') {
					// If it's from the workspace, don't add it again
					return;
				}

				if (data.source === 'equipment') {
					addEquipment(data.item);
				} else {
					addToWorkspace(data.item);
				}

				createParticles(event.clientX, event.clientY);
			}

			// Add element to workspace
			function addToWorkspace(element) {
				workspace.value.push(element);
				createParticles(event.clientX, event.clientY);
			}

			// Add equipment to active equipment
			function addEquipment(equipment) {
				if (!activeEquipment.value.some(eq => eq.id === equipment.id)) {
					activeEquipment.value.push(equipment);
					createParticles(event.clientX, event.clientY);
				}
			}

			// Remove equipment
			function removeEquipment(index) {
				activeEquipment.value.splice(index, 1);
			}

			// Remove element from workspace
			function removeFromWorkspace(index) {
				workspace.value.splice(index, 1);
			}

			// Clear the entire workspace
			function clearWorkspace() {
				workspace.value = [];
			}

			// Visual effects
			function createParticles(x, y) {
				const container = document.querySelector('#app');
				const numParticles = 8;

				for (let i = 0; i < numParticles; i++) {
					const particle = document.createElement('div');
					particle.classList.add('particle');

					// Random size between 5-10px
					const size = Math.random() * 5 + 5;
					particle.style.width = `${size}px`;
					particle.style.height = `${size}px`;

					// Random color
					const colors = ['#4299e1', '#48bb78', '#ed8936', '#ed64a6', '#9f7aea'];
					particle.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];

					// Position at the event coordinates
					particle.style.left = `${x}px`;
					particle.style.top = `${y}px`;

					// Random direction
					const angle = Math.random() * Math.PI * 2;
					const distance = Math.random() * 100 + 50;
					const tx = Math.cos(angle) * distance;
					const ty = Math.sin(angle) * distance;

					particle.style.setProperty('--tx', `${tx}px`);
					particle.style.setProperty('--ty', `${ty}px`);

					container.appendChild(particle);

					// Remove particle after animation completes
					setTimeout(() => {
						particle.remove();
					}, 1000);
				}
			}

			// Dismiss notification
			function dismissNotification(id) {
				const notification = notifications.value.find(n => n.id === id);
				if (notification) {
					notification.exiting = true;
					setTimeout(() => {
						notifications.value = notifications.value.filter(n => n.id !== id);
					}, 500);
				}
			}

			// Add a notification that disappears after a few seconds
			function addNotification(title, message, type = 'info') {
				const id = Date.now();
				const notification = {id, title, message, type, exiting: false};
				notifications.value.push(notification);

				// Remove notification after 8 seconds
				setTimeout(() => {
					dismissNotification(id);
				}, 8000);
			}

			// Try to combine elements in the workspace
			function combineElements() {
				if (workspace.value.length < 2 && (workspace.value.length < 1 || activeEquipment.value.length === 0)) return;

				// Get the ids of all elements in workspace
				const workspaceIds = workspace.value.map(item => item.id);

				// Get active equipment ids
				const equipmentIds = activeEquipment.value.map(item => item.id);

				// Sort the ids to ensure consistent matching regardless of order
				workspaceIds.sort();

				// First, look for recipes that match both the inputs AND equipment
				// This prioritizes equipment-specific reactions
				let matchedRecipe = null;
				let requiresEquipment = false;
				let requiresTemperature = false;
				let missingEquipment = [];
				let temperatureRange = null;

				// First pass: Look for recipes that match with equipment
				for (const recipe of recipes.value) {
					const inputs = [...recipe.inputs].sort();

					// Check if all recipe inputs are in the workspace
					const inputsMatch = arraysMatch(inputs, workspaceIds);

					if (inputsMatch) {
						// Check if recipe requires equipment
						if (recipe.requiredEquipment && recipe.requiredEquipment.length > 0) {
							requiresEquipment = true;

							// Check if required equipment is active
							const hasRequiredEquipment = recipe.requiredEquipment.every(eq => equipmentIds.includes(eq));

							if (hasRequiredEquipment) {
								// Check temperature requirements
								const temperatureOk = !recipe.requiredTemperature ||
									(temperature.value >= recipe.requiredTemperature.min &&
										temperature.value <= recipe.requiredTemperature.max);

								if (temperatureOk) {
									// Found a perfect match with equipment and temperature
									matchedRecipe = recipe;
									break; // Use this recipe immediately
								} else if (recipe.requiredTemperature) {
									requiresTemperature = true;
									temperatureRange = recipe.requiredTemperature;
								}
							} else {
								// Keep track of missing equipment for feedback
								missingEquipment = recipe.requiredEquipment.filter(eq => !equipmentIds.includes(eq));
							}
						}
					}
				}

				// Second pass: Only if we didn't find an equipment match, look for recipes without equipment
				if (!matchedRecipe) {
					for (const recipe of recipes.value) {
						const inputs = [...recipe.inputs].sort();

						// Check if all recipe inputs are in the workspace
						const inputsMatch = arraysMatch(inputs, workspaceIds);

						if (inputsMatch && (!recipe.requiredEquipment || recipe.requiredEquipment.length === 0)) {
							// Check temperature requirements
							const temperatureOk = !recipe.requiredTemperature ||
								(temperature.value >= recipe.requiredTemperature.min &&
									temperature.value <= recipe.requiredTemperature.max);

							if (temperatureOk) {
								matchedRecipe = recipe;
								break;
							} else if (recipe.requiredTemperature) {
								requiresTemperature = true;
								temperatureRange = recipe.requiredTemperature;
							}
						}
					}
				}

				// If we found a matching recipe
				if (matchedRecipe) {
					const output = matchedRecipe.output;

					// Check if already discovered
					if (!discoveredItems.value.some(item => item.id === output.id)) {
						discoveredItems.value.push(output);
						newlyDiscovered.value.push(output.id);

						// Update level progress
						currentLevelProgress.value += 1;
						if (currentLevelProgress.value >= currentLevelTarget.value) {
							playerLevel.value += 1;
							currentLevelProgress.value = 0;

							addNotification(
								translate({de: 'Level aufgestiegen!', en: 'Level Up!'}),
								translate({
									de: `Du bist jetzt Level ${playerLevel.value}!`,
									en: `You are now level ${playerLevel.value}!`
								}),
								'info'
							);
						}

						// Show discovery notification
						addNotification(
							translate({de: 'Neue Entdeckung!', en: 'New Discovery!'}),
							translate({
								de: `Du hast ${output.name} entdeckt!`,
								en: `You discovered ${output.name}!`
							}),
							'discovery'
						);

						// Show reaction animation
						showReactionAnimation.value = true;
						reactionResult.value = {
							success: true,
							symbol: output.symbol,
							title: translate({de: 'Reaktion erfolgreich!', en: 'Reaction Successful!'}),
							message: translate({
								de: `Du hast erfolgreich ${output.name} erzeugt!`,
								en: `You successfully created ${output.name}!`
							})
						};

						// Clear newly discovered flag after a while
						setTimeout(() => {
							newlyDiscovered.value = newlyDiscovered.value.filter(id => id !== output.id);
						}, 5000);

						// Replace workspace with new discovery
						workspace.value = [output];

						// Check missions and achievements
						checkMissions();
						checkAchievements();

						return;
					} else {
						// If already discovered, just show success message
						showReactionAnimation.value = true;
						reactionResult.value = {
							success: true,
							symbol: output.symbol,
							title: translate({de: 'Reaktion erfolgreich!', en: 'Reaction Successful!'}),
							message: translate({
								de: `Du hast ${output.name} erneut erzeugt.`,
								en: `You created ${output.name} again.`
							})
						};

						// Replace workspace with created item
						workspace.value = [discoveredItems.value.find(item => item.id === output.id)];
						return;
					}
				}

				// If we got here, no matching recipe was found
				showReactionAnimation.value = true;

				// Provide meaningful feedback based on what's missing
				if (requiresEquipment && missingEquipment.length > 0) {
					const missingEquipmentNames = missingEquipment
						.map(eq => getEquipmentNameById(eq))
						.join(', ');

					reactionResult.value = {
						success: false,
						symbol: '⚗️',
						title: translate({de: 'Ausrüstung fehlt', en: 'Equipment Needed'}),
						message: translate({
							de: `Du benötigst: ${missingEquipmentNames}`,
							en: `You need: ${missingEquipmentNames}`
						})
					};
				} else if (requiresTemperature && temperatureRange) {
					reactionResult.value = {
						success: false,
						symbol: '🌡️',
						title: translate({de: 'Temperatur nicht passend', en: 'Incorrect Temperature'}),
						message: translate({
							de: `Benötigte Temperatur: ${temperatureRange.min} - ${temperatureRange.max}°C`,
							en: `Required temperature: ${temperatureRange.min} - ${temperatureRange.max}°C`
						})
					};
				} else {
					reactionResult.value = {
						success: false,
						symbol: '❓',
						title: translate({de: 'Keine Reaktion', en: 'No Reaction'}),
						message: translate({
							de: 'Diese Elemente können nicht kombiniert werden.',
							en: 'These elements cannot be combined.'
						})
					};
				}
			}

			// Helper to check if arrays have the same elements
			function arraysMatch(arr1, arr2) {
				if (arr1.length !== arr2.length) return false;

				for (let i = 0; i < arr1.length; i++) {
					if (arr1[i] !== arr2[i]) return false;
				}

				return true;
			}

			// Toggle dark mode
			function toggleDarkMode() {
				darkMode.value = !darkMode.value;
				localStorage.setItem('elementcraft-dark-mode', darkMode.value);
			}

			// Toggle language between German and English
			function toggleLanguage() {
				currentLanguage.value = currentLanguage.value === 'de' ? 'en' : 'de';
				localStorage.setItem('elementcraft-language', currentLanguage.value);
			}

			// Reset the game
			function resetGame() {
				if (confirm(translate({
					de: 'Bist du sicher? Alle Fortschritte gehen verloren!',
					en: 'Are you sure? All progress will be lost!'
				}))) {
					// Clear workspace and equipment
					workspace.value = [];
					activeEquipment.value = [];

					// Reset player progress
					discoveredItems.value = [];
					newlyDiscovered.value = [];
					playerLevel.value = 1;
					currentLevelProgress.value = 0;
					temperature.value = 25;

					// Reset UI state
					activeTab.value = 'lab';
					selectedDiscovery.value = null;
					selectedElement.value = null;
					currentPage.value = 1;
					discoveryFilter.value = 'all';
					searchQuery.value = '';

					// Reset missions
					missions.value.forEach(mission => {
						mission.completed = false;
						mission.progress = 0;
					});
					activeMission.value = null;

					// Reset achievements
					achievements.value.forEach(achievement => {
						achievement.unlocked = false;
					});

					// Clear localStorage
					localStorage.removeItem('elementcraft-save');

					// Also clear any active notification
					notifications.value = [];

					// Show reset notification
					addNotification(
						translate({de: 'Spiel zurückgesetzt', en: 'Game Reset'}),
						translate({
							de: 'Dein Fortschritt wurde zurückgesetzt.',
							en: 'Your progress has been reset.'
						}),
						'info'
					);
				}
			}

			// Load saved game from localStorage
			function loadGame() {
				const savedGame = localStorage.getItem('elementcraft-save');
				if (savedGame) {
					try {
						const gameData = JSON.parse(savedGame);

						// Validate game data before loading
						if (isValidGameData(gameData)) {
							// Load basic game state
							discoveredItems.value = gameData.discovered || [];
							playerLevel.value = gameData.level || 1;
							currentLevelProgress.value = gameData.progress || 0;

							// Load missions
							loadMissionsFromSave(gameData.missions);

							// Load achievements
							if (gameData.achievements) {
								gameData.achievements.forEach(savedAchievement => {
									const achievement = achievements.value.find(a => a.id === savedAchievement.id);
									if (achievement) {
										achievement.unlocked = savedAchievement.unlocked;
									}
								});
							}

							// Load active mission
							if (gameData.activeMission) {
								activeMission.value = missions.value.find(m => m.id === gameData.activeMission);
							}

							// After loading, check if any missions are completed
							checkMissions();

							// Check if achievements are unlocked
							checkAchievements();
						} else {
							// If invalid data, reset the game
							console.error('Invalid saved game data detected. Resetting game state.');
							localStorage.removeItem('elementcraft-save');
							addNotification(
								translate({de: 'Fehler beim Laden', en: 'Loading Error'}),
								translate({
									de: 'Beschädigte Spieldaten wurden erkannt. Das Spiel wurde zurückgesetzt.',
									en: 'Corrupted game data detected. The game has been reset.'
								}),
								'info'
							);
						}
					} catch (e) {
						console.error('Failed to load saved game:', e);
						localStorage.removeItem('elementcraft-save');
					}
				}
			}

			function isValidGameData(gameData) {
				// Check if basic structure is present
				if (!gameData || typeof gameData !== 'object') return false;

				// Validate discovered items
				if (gameData.discovered) {
					if (!Array.isArray(gameData.discovered)) return false;

					// Check each discovered item
					for (const item of gameData.discovered) {
						// Each item should be an object with id, name, category, etc.
						if (!item || typeof item !== 'object' || !item.id || !item.name || !item.category) {
							return false;
						}

						// Validate against known recipes to ensure it's a valid item
						const validRecipe = recipes.value.some(recipe => recipe.output.id === item.id);
						const validElement = [...basicElements.value, ...advancedElements.value].some(el => el.id === item.id);

						if (!validRecipe && !validElement) {
							console.warn(`Invalid discovered item found: ${item.id}`);
							return false;
						}
					}
				}

				// Validate player level
				if (gameData.level !== undefined) {
					if (typeof gameData.level !== 'number' || gameData.level < 1 || gameData.level > 20) {
						return false;
					}
				}

				// Validate progress
				if (gameData.progress !== undefined) {
					if (typeof gameData.progress !== 'number' || gameData.progress < 0) {
						return false;
					}
				}

				// Validate missions
				if (gameData.missions) {
					if (!Array.isArray(gameData.missions)) return false;

					for (const mission of gameData.missions) {
						if (!mission || typeof mission !== 'object' || !mission.id) {
							return false;
						}

						// Check if it's a valid mission ID
						if (!missions.value.some(m => m.id === mission.id)) {
							return false;
						}
					}
				}

				// Validate achievements
				if (gameData.achievements) {
					if (!Array.isArray(gameData.achievements)) return false;

					for (const achievement of gameData.achievements) {
						if (!achievement || typeof achievement !== 'object' || !achievement.id) {
							return false;
						}

						// Check if it's a valid achievement ID
						if (!achievements.value.some(a => a.id === achievement.id)) {
							return false;
						}
					}
				}

				// If active mission is present, validate it
				if (gameData.activeMission) {
					if (typeof gameData.activeMission !== 'string' ||
						!missions.value.some(m => m.id === gameData.activeMission)) {
						return false;
					}
				}

				// All validations passed
				return true;
			}

			// Load missions state from saved game
			function loadMissionsFromSave(savedMissions) {
				if (savedMissions && Array.isArray(savedMissions)) {
					savedMissions.forEach(savedMission => {
						const mission = missions.value.find(m => m.id === savedMission.id);
						if (mission) {
							mission.completed = savedMission.completed;
							mission.progress = savedMission.progress;
						}
					});
				}
			}

			// Save missions state for local storage
			function saveMissionsToObject() {
				return missions.value.map(mission => ({
					id: mission.id,
					completed: mission.completed,
					progress: mission.progress
				}));
			}

			// Save game to localStorage
			function saveGame() {
				const gameData = {
					discovered: discoveredItems.value,
					level: playerLevel.value,
					progress: currentLevelProgress.value,
					missions: saveMissionsToObject(),
					achievements: achievements.value.map(achievement => ({
						id: achievement.id,
						unlocked: achievement.unlocked
					})),
					activeMission: activeMission.value ? activeMission.value.id : null
				};

				localStorage.setItem('elementcraft-save', JSON.stringify(gameData));
			}

			// Setup an autosave
			function setupAutosave() {
				setInterval(saveGame, 30000); // Save every 30 seconds
			}

			// Watch for changes to update translations when language changes
			watch(currentLanguage, () => {
				// Update basic elements translation
				basicElements.value = basicElements.value.map(element => ({
					...element,
					name: translate({
						de: getGermanName(element.id),
						en: getEnglishName(element.id)
					}),
					description: translate({
						de: getGermanDescription(element.id),
						en: getEnglishDescription(element.id)
					})
				}));

				// Update available equipment
				availableEquipment.value = availableEquipment.value.map(equipment => ({
					...equipment,
					name: translate({
						de: getGermanEquipmentName(equipment.id),
						en: getEnglishEquipmentName(equipment.id)
					}),
					description: translate({
						de: getGermanEquipmentDescription(equipment.id),
						en: getEnglishEquipmentDescription(equipment.id)
					}),
					enables: equipment.enables.map(e => translate({
						de: getGermanCapability(e),
						en: e
					}))
				}));

				// Update discovered items
				discoveredItems.value = discoveredItems.value.map(item => ({
					...item,
					name: translate({
						de: getGermanName(item.id),
						en: getEnglishName(item.id)
					}),
					description: translate({
						de: getGermanDescription(item.id),
						en: getEnglishDescription(item.id)
					})
				}));

				// Update tabs
				tabs.forEach((tab, index) => {
					tabs[index].name = translate({
						de: getGermanTabName(tab.id),
						en: getEnglishTabName(tab.id)
					});
				});

				// Update recipes
				recipes.value = recipes.value.map(recipe => ({
					...recipe,
					output: {
						...recipe.output,
						name: translate({
							de: getGermanName(recipe.output.id),
							en: getEnglishName(recipe.output.id)
						}),
						description: translate({
							de: getGermanDescription(recipe.output.id),
							en: getEnglishDescription(recipe.output.id)
						})
					}
				}));

				// Update missions
				missions.value = missions.value.map(mission => ({
					...mission,
					title: translate({
						de: getGermanMissionTitle(mission.id),
						en: getEnglishMissionTitle(mission.id)
					}),
					description: translate({
						de: getGermanMissionDescription(mission.id),
						en: getEnglishMissionDescription(mission.id)
					}),
					reward: translate({
						de: getGermanMissionReward(mission.id),
						en: getEnglishMissionReward(mission.id)
					})
				}));

				// Update achievements
				achievements.value = achievements.value.map(achievement => ({
					...achievement,
					title: translate({
						de: getGermanAchievementTitle(achievement.id),
						en: getEnglishAchievementTitle(achievement.id)
					}),
					description: translate({
						de: getGermanAchievementDescription(achievement.id),
						en: getEnglishAchievementDescription(achievement.id)
					})
				}));
			});

			// Helper functions for tab translations
			function getGermanTabName(id) {
				const nameMap = {
					'lab': 'Labor',
					'elements': 'Periodensystem',
					'discoveries': 'Entdeckungen'
				};
				return nameMap[id] || id;
			}

			function getEnglishTabName(id) {
				const nameMap = {
					'lab': 'Laboratory',
					'elements': 'Periodic Table',
					'discoveries': 'Discoveries'
				};
				return nameMap[id] || id;
			}

			// Helper functions for equipment translations
			function getGermanEquipmentName(id) {
				const nameMap = {
					'bunsen_burner': 'Bunsenbrenner',
					'test_tube': 'Reagenzglas',
					'beaker': 'Becherglas',
					'scale': 'Waage',
					'filter': 'Filter',
					'electricity': 'Elektrizität',
					'uv_light': 'UV-Licht',
					'catalyst': 'Katalysator',
					'distillation': 'Destillationsapparat'
				};
				return nameMap[id] || id;
			}

			function getEnglishEquipmentName(id) {
				const nameMap = {
					'bunsen_burner': 'Bunsen Burner',
					'test_tube': 'Test Tube',
					'beaker': 'Beaker',
					'scale': 'Scale',
					'filter': 'Filter',
					'electricity': 'Electricity',
					'uv_light': 'UV Light',
					'catalyst': 'Catalyst',
					'distillation': 'Distillation Apparatus'
				};
				return nameMap[id] || id;
			}

			function getGermanEquipmentDescription(id) {
				const descMap = {
					'bunsen_burner': 'Erzeugt eine heiße Flamme für Experimente, die hohe Temperaturen erfordern.',
					'test_tube': 'Schmaler Glasbehälter für kleine Experimente und Reaktionen.',
					'beaker': 'Größerer Behälter für Flüssigkeiten und größere Reaktionen.',
					'scale': 'Misst die Masse von Substanzen für präzise Experimente.',
					'filter': 'Trennt Feststoffe von Flüssigkeiten durch Filtration.',
					'electricity': 'Liefert elektrischen Strom für Elektrolyse und andere elektrochemische Prozesse.',
					'uv_light': 'Bestrahlt Proben mit ultraviolettem Licht für photochemische Reaktionen.',
					'catalyst': 'Beschleunigt chemische Reaktionen ohne selbst verbraucht zu werden.',
					'distillation': 'Trennt Flüssigkeiten auf Basis ihrer unterschiedlichen Siedepunkte.'
				};
				return descMap[id] || '';
			}

			function getEnglishEquipmentDescription(id) {
				const descMap = {
					'bunsen_burner': 'Creates a hot flame for experiments requiring high temperatures.',
					'test_tube': 'Narrow glass container for small experiments and reactions.',
					'beaker': 'Larger container for liquids and bigger reactions.',
					'scale': 'Measures the mass of substances for precise experiments.',
					'filter': 'Separates solids from liquids through filtration.',
					'electricity': 'Provides electric current for electrolysis and other electrochemical processes.',
					'uv_light': 'Irradiates samples with ultraviolet light for photochemical reactions.',
					'catalyst': 'Accelerates chemical reactions without being consumed.',
					'distillation': 'Separates liquids based on their different boiling points.'
				};
				return descMap[id] || '';
			}

			function getGermanCapability(capability) {
				const capMap = {
					'Heating': 'Erhitzen',
					'Combustion': 'Verbrennung',
					'Mixing': 'Mischen',
					'Small Reactions': 'Kleine Reaktionen',
					'Larger Volumes': 'Größere Mengen',
					'Complex Mixtures': 'Komplexe Mischungen',
					'Precise Measurements': 'Präzise Messungen',
					'Stoichiometry': 'Stöchiometrie',
					'Filtration': 'Filtration',
					'Separation': 'Trennung',
					'Electrolysis': 'Elektrolyse',
					'Electrochemistry': 'Elektrochemie',
					'Photochemistry': 'Photochemie',
					'UV Catalysis': 'UV-Katalyse',
					'Accelerated Reactions': 'Beschleunigte Reaktionen',
					'Lower Activation Energy': 'Niedrigere Aktivierungsenergie',
					'Distillation': 'Destillation',
					'Liquid Separation': 'Trennung von Flüssigkeiten'
				};
				return capMap[capability] || capability;
			}

			// Helper functions for element and compound name translations
			function getGermanName(id) {
				const nameMap = {
					'H': 'Wasserstoff',
					'O': 'Sauerstoff',
					'C': 'Kohlenstoff',
					'N': 'Stickstoff',
					'Na': 'Natrium',
					'Cl': 'Chlor',
					'Fe': 'Eisen',
					'S': 'Schwefel',
					'P': 'Phosphor',
					'Si': 'Silizium',
					'Cu': 'Kupfer',
					'Ag': 'Silber',
					'Au': 'Gold',
					'Hg': 'Quecksilber',
					'He': 'Helium',
					'F': 'Fluor',
					'Br': 'Brom',
					'I': 'Iod',

					// Compounds and molecules
					'H2': 'Wasserstoffgas',
					'O2': 'Sauerstoffgas',
					'H2O': 'Wasser',
					'HCl': 'Salzsäure',
					'NaCl': 'Kochsalz',
					'CO2': 'Kohlendioxid',
					'CO': 'Kohlenmonoxid',
					'NH3': 'Ammoniak',
					'H2CO3': 'Kohlensäure',
					'Fe2O3': 'Rost',
					'CH4': 'Methan',
					'H2O2': 'Wasserstoffperoxid',
					'NaOH': 'Natronlauge',
					'CH3OH': 'Methanol',
					'SO2': 'Schwefeldioxid',
					'SO3': 'Schwefeltrioxid',
					'H2SO4': 'Schwefelsäure',
					'NO': 'Stickstoffmonoxid',
					'NO2': 'Stickstoffdioxid',
					'HF': 'Fluorwasserstoff',
					'HN3': 'Stickstoffwasserstoffsäure',

					// Reactions and processes
					'combustion': 'Verbrennung',
					'NaCl_H2O': 'Neutralisation',
					'saline': 'Kochsalzlösung',
					'Fe_CO2': 'Eisengewinnung',
					'steel': 'Stahl',
					'brass': 'Messing',
					'bronze': 'Bronze',
					'electrolysis': 'Elektrolyse',
					'NaCl_electrolysis': 'Chlor-Alkali-Prozess',
					'copper_plating': 'Kupferplattierung',
					'AgBr': 'Silberbromid',
					'photography': 'Fotografische Reaktion',
					'haber_process': 'Haber-Prozess',
					'ethylene_oxide': 'Ethylenoxid',
					'petroleum_distillation': 'Erdöldestillation',
					'ethanol_distillation': 'Ethanoldestillation',
					'glass_etching': 'Glasätzung',
					'esterification': 'Veresterung',
					'fermentation': 'Fermentation'
				};
				return nameMap[id] || id;
			}

			function getEnglishName(id) {
				const nameMap = {
					'H': 'Hydrogen',
					'O': 'Oxygen',
					'C': 'Carbon',
					'N': 'Nitrogen',
					'Na': 'Sodium',
					'Cl': 'Chlorine',
					'Fe': 'Iron',
					'S': 'Sulfur',
					'P': 'Phosphorus',
					'Si': 'Silicon',
					'Cu': 'Copper',
					'Ag': 'Silver',
					'Au': 'Gold',
					'Hg': 'Mercury',
					'He': 'Helium',
					'F': 'Fluorine',
					'Br': 'Bromine',
					'I': 'Iodine',

					// Compounds and molecules
					'H2': 'Hydrogen Gas',
					'O2': 'Oxygen Gas',
					'H2O': 'Water',
					'HCl': 'Hydrochloric Acid',
					'NaCl': 'Table Salt',
					'CO2': 'Carbon Dioxide',
					'CO': 'Carbon Monoxide',
					'NH3': 'Ammonia',
					'H2CO3': 'Carbonic Acid',
					'Fe2O3': 'Rust',
					'CH4': 'Methane',
					'H2O2': 'Hydrogen Peroxide',
					'NaOH': 'Sodium Hydroxide',
					'CH3OH': 'Methanol',
					'SO2': 'Sulfur Dioxide',
					'SO3': 'Sulfur Trioxide',
					'H2SO4': 'Sulfuric Acid',
					'NO': 'Nitric Oxide',
					'NO2': 'Nitrogen Dioxide',
					'HF': 'Hydrogen Fluoride',
					'HN3': 'Hydrazoic Acid',

					// Reactions and processes
					'combustion': 'Combustion',
					'NaCl_H2O': 'Neutralization',
					'saline': 'Saline Solution',
					'Fe_CO2': 'Iron Smelting',
					'steel': 'Steel',
					'brass': 'Brass',
					'bronze': 'Bronze',
					'electrolysis': 'Electrolysis',
					'NaCl_electrolysis': 'Chlor-Alkali Process',
					'copper_plating': 'Copper Plating',
					'AgBr': 'Silver Bromide',
					'photography': 'Photographic Reaction',
					'haber_process': 'Haber Process',
					'ethylene_oxide': 'Ethylene Oxide',
					'petroleum_distillation': 'Petroleum Distillation',
					'ethanol_distillation': 'Ethanol Distillation',
					'glass_etching': 'Glass Etching',
					'esterification': 'Esterification',
					'fermentation': 'Fermentation'
				};
				return nameMap[id] || id;
			}

			function getGermanDescription(id) {
				const descMap = {
					'H': 'Leichtestes Element, brennbar und sehr reaktiv.',
					'O': 'Unterstützt Verbrennung, notwendig für Atmung.',
					'C': 'Grundlage organischer Verbindungen, kommt in verschiedenen Allotropen vor.',
					'N': 'Hauptbestandteil der Erdatmosphäre, wichtig für Proteine.',
					'Na': 'Silbrig-weißes, weiches Alkalimetall, reagiert heftig mit Wasser.',
					'Cl': 'Gelblich-grünes Gas, stark oxidierend, wird zur Wasseraufbereitung verwendet.',
					'Fe': 'Häufigstes Übergangselement, magnetisch, grundlegendes Metall für Industrie.',
					'S': 'Gelber, spröder Nichtmetall mit charakteristischem Geruch.',
					'P': 'Nichtmetallisches Element mit mehreren Allotropen, hohe Reaktivität.',
					'Si': 'Halbmetall, wichtig für Elektronik und als Bestandteil von Glas.',
					'Cu': 'Rötliches Metall, guter Leiter für Wärme und Elektrizität.',
					'Ag': 'Glänzendes, weiches Edelmetall mit höchster elektrischer Leitfähigkeit.',
					'Au': 'Glänzendes, gelbes Edelmetall, sehr beständig gegen Korrosion.',
					'Hg': 'Silbriges Metall, flüssig bei Raumtemperatur, giftig.',
					'He': 'Leichtes, inertes Edelgas, bekannt für seinen Einsatz in Ballons.',
					'F': 'Blass-gelbes Gas, höchst reaktiv, bildet starke Bindungen mit fast allen Elementen.',
					'Br': 'Rötlich-braune Flüssigkeit, einziges nichtmetallische Element, das bei Raumtemperatur flüssig ist.',
					'I': 'Glänzender, violett-schwarzer Feststoff, der bei Erhitzen sublimiert und violette Dämpfe bildet.',

					// Compounds
					'H2': 'Leichtestes Element, brennbar und potenzieller Kraftstoff.',
					'O2': 'Notwendig zum Atmen und für Verbrennungsreaktionen.',
					'H2O': 'Die grundlegende Verbindung des Lebens, Lösungsmittel für viele Reaktionen.',
					'HCl': 'Eine starke Säure, die in der Industrie und im Magen vorkommt.',
					'NaCl': 'Grundlegendes Mineral für Leben und Kochen, Ionenverbindung.',
					'CO2': 'Gas in der Atmosphäre, Produkt der Verbrennung und Atmung.',
					'CO': 'Farb- und geruchloses, giftiges Gas, bindet an Hämoglobin.',
					'NH3': 'Stechend riechendes Gas, wichtig für Düngemittel.',
					'H2CO3': 'Macht Getränke sprudelnd, zerfällt leicht in Wasser und CO₂.',
					'Fe2O3': 'Eisenoxid, Ergebnis der Oxidation von Eisen an feuchter Luft.',
					'CH4': 'Einfachster Kohlenwasserstoff, Hauptbestandteil von Erdgas.',
					'H2O2': 'Oxidationsmittel, Bleichmittel, zerfällt zu Wasser und Sauerstoff.',
					'NaOH': 'Starke Base, ätzend, wird in Reinigungsmitteln verwendet.',
					'CH3OH': 'Einfacher Alkohol, giftig, wird als Lösungsmittel verwendet.',
					'SO2': 'Reizgas, entsteht bei Verbrennung schwefelhaltiger Brennstoffe.',
					'SO3': 'Reaktives Gas, reagiert mit Wasser zu Schwefelsäure.',
					'H2SO4': 'Starke, korrosive Säure, wichtig in der Industrie.',
					'NO': 'Signalmolekül im Körper, wichtig für Blutgefäßerweiterung.',
					'NO2': 'Braunes Gas, Luftschadstoff, entsteht bei Verbrennungsprozessen.',
					'HF': 'Stark korrosive Säure, ätzt Glas, sehr gefährlich.',
					'HN3': 'Hochexplosive Verbindung, sehr instabil.',

					// Reactions and processes
					'combustion': 'Exotherme Reaktion mit Sauerstoff, erzeugt Wärme und Licht.',
					'NaCl_H2O': 'Säure-Base-Reaktion, erzeugt Salz und Wasser.',
					'saline': 'Salzwasser, wichtig für medizinische Anwendungen.',
					'Fe_CO2': 'Metallurgischer Prozess zur Gewinnung von Eisen aus Erz.',
					'steel': 'Legierung aus Eisen und Kohlenstoff, härter und stärker als reines Eisen.',
					'brass': 'Legierung aus Kupfer und Zink, goldfarben und korrosionsbeständig.',
					'bronze': 'Legierung aus Kupfer und Zinn, historisch wichtig für Werkzeuge und Waffen.',
					'electrolysis': 'Zerlegung durch Strom, spaltet Wasser in Wasserstoff und Sauerstoff.',
					'NaCl_electrolysis': 'Elektrolyse von Salzlösung, erzeugt Chlorgas und Natronlauge.',
					'copper_plating': 'Elektrolytische Abscheidung von Kupfer auf einer Oberfläche.',
					'AgBr': 'Lichtempfindliches Salz, verwendet in der Fotografie.',
					'photography': 'Lichtinduzierte Reduktion von Silberbromid zu metallischem Silber.',
					'haber_process': 'Katalytische Synthese von Ammoniak aus Stickstoff und Wasserstoff.',
					'ethylene_oxide': 'Katalytische Oxidation von Ethylen, wichtig für die Produktion von Polyethylen.',
					'petroleum_distillation': 'Fraktionierte Destillation von Rohöl zur Trennung in verschiedene Produkte.',
					'ethanol_distillation': 'Destillation vergorener Maische zur Gewinnung von konzentriertem Ethanol.',
					'glass_etching': 'Reaktion von Fluorwasserstoff mit Siliziumdioxid, ätzt Glasoberflächen.',
					'esterification': 'Reaktion zwischen Alkohol und Säure zur Bildung eines Esters mit fruchtigem Geruch.',
					'fermentation': 'Biologischer Prozess der Umwandlung von Zucker in Alkohol und CO₂.'
				};
				return descMap[id] || '';
			}

			function getEnglishDescription(id) {
				const descMap = {
					'H': 'Lightest element, flammable and highly reactive.',
					'O': 'Supports combustion, necessary for respiration.',
					'C': 'Basis of organic compounds, exists in various allotropes.',
					'N': 'Main component of Earth\'s atmosphere, important for proteins.',
					'Na': 'Silvery-white, soft alkali metal, reacts vigorously with water.',
					'Cl': 'Yellowish-green gas, strongly oxidizing, used for water treatment.',
					'Fe': 'Most common transition element, magnetic, fundamental metal for industry.',
					'S': 'Yellow, brittle non-metal with a characteristic odor.',
					'P': 'Non-metallic element with several allotropes, highly reactive.',
					'Si': 'Metalloid, important for electronics and as a component of glass.',
					'Cu': 'Reddish metal, good conductor of heat and electricity.',
					'Ag': 'Lustrous, soft precious metal with highest electrical conductivity.',
					'Au': 'Lustrous, yellow precious metal, highly resistant to corrosion.',
					'Hg': 'Silvery metal, liquid at room temperature, toxic.',
					'He': 'Light, inert noble gas, known for its use in balloons.',
					'F': 'Pale yellow gas, highly reactive, forms strong bonds with nearly all elements.',
					'Br': 'Reddish-brown liquid, only non-metallic element that is liquid at room temperature.',
					'I': 'Lustrous, violet-black solid that sublimes upon heating forming purple vapors.',

					// Compounds
					'H2': 'Lightest element, flammable and potential fuel.',
					'O2': 'Necessary for breathing and combustion reactions.',
					'H2O': 'The fundamental compound of life, solvent for many reactions.',
					'HCl': 'A strong acid found in industry and in the stomach.',
					'NaCl': 'Essential mineral for life and cooking, ionic compound.',
					'CO2': 'Atmospheric gas, product of combustion and respiration.',
					'CO': 'Colorless, odorless, toxic gas, binds to hemoglobin.',
					'NH3': 'Pungent-smelling gas, important for fertilizers.',
					'H2CO3': 'Makes drinks fizzy, easily decomposes into water and CO₂.',
					'Fe2O3': 'Iron oxide, result of iron oxidation in moist air.',
					'CH4': 'Simplest hydrocarbon, main component of natural gas.',
					'H2O2': 'Oxidizing agent, bleach, decomposes to water and oxygen.',
					'NaOH': 'Strong base, caustic, used in cleaning products.',
					'CH3OH': 'Simple alcohol, toxic, used as a solvent.',
					'SO2': 'Irritant gas, produced by burning sulfur-containing fuels.',
					'SO3': 'Reactive gas, reacts with water to form sulfuric acid.',
					'H2SO4': 'Strong, corrosive acid, important in industry.',
					'NO': 'Signaling molecule in the body, important for blood vessel dilation.',
					'NO2': 'Brown gas, air pollutant, produced in combustion processes.',
					'HF': 'Highly corrosive acid, etches glass, very dangerous.',
					'HN3': 'Highly explosive compound, very unstable.',

					// Reactions and processes
					'combustion': 'Exothermic reaction with oxygen, produces heat and light.',
					'NaCl_H2O': 'Acid-base reaction, produces salt and water.',
					'saline': 'Salt water, important for medical applications.',
					'Fe_CO2': 'Metallurgical process to extract iron from ore.',
					'steel': 'Alloy of iron and carbon, harder and stronger than pure iron.',
					'brass': 'Alloy of copper and zinc, gold-colored and corrosion-resistant.',
					'bronze': 'Alloy of copper and tin, historically important for tools and weapons.',
					'electrolysis': 'Decomposition by electricity, splits water into hydrogen and oxygen.',
					'NaCl_electrolysis': 'Electrolysis of salt solution, produces chlorine gas and sodium hydroxide.',
					'copper_plating': 'Electrolytic deposition of copper on a surface.',
					'AgBr': 'Light-sensitive salt, used in photography.',
					'photography': 'Light-induced reduction of silver bromide to metallic silver.',
					'haber_process': 'Catalytic synthesis of ammonia from nitrogen and hydrogen.',
					'ethylene_oxide': 'Catalytic oxidation of ethylene, important for polyethylene production.',
					'petroleum_distillation': 'Fractional distillation of crude oil to separate into different products.',
					'ethanol_distillation': 'Distillation of fermented mash to obtain concentrated ethanol.',
					'glass_etching': 'Reaction of hydrogen fluoride with silicon dioxide, etches glass surfaces.',
					'esterification': 'Reaction between alcohol and acid to form an ester with fruity smell.',
					'fermentation': 'Biological process of converting sugar into alcohol and CO₂.'
				};
				return descMap[id] || '';
			}

			// Helper functions for mission translations
			function getGermanMissionTitle(id) {
				const titleMap = {
					'mission1': 'Erste Schritte',
					'mission2': 'Säuren und Basen',
					'mission3': 'Kohlenstoffchemie',
					'mission4': 'Metallverarbeitung',
					'mission5': 'Elektrolyse',
					'mission6': 'Halogenchemie',
					'mission7': 'Fotografische Chemie',
					'mission8': 'Organische Synthese',
					'mission9': 'Industrielle Prozesse',
					'mission10': 'Materialien der Zukunft'
				};
				return titleMap[id] || id;
			}

			function getEnglishMissionTitle(id) {
				const titleMap = {
					'mission1': 'First Steps',
					'mission2': 'Acids and Bases',
					'mission3': 'Carbon Chemistry',
					'mission4': 'Metal Processing',
					'mission5': 'Electrolysis',
					'mission6': 'Halogen Chemistry',
					'mission7': 'Photographic Chemistry',
					'mission8': 'Organic Synthesis',
					'mission9': 'Industrial Processes',
					'mission10': 'Materials of the Future'
				};
				return titleMap[id] || id;
			}

			function getGermanMissionDescription(id) {
				const descMap = {
					'mission1': 'Entdecke die grundlegenden Moleküle Wasser (H₂O) und Wasserstoffgas (H₂).',
					'mission2': 'Erzeuge Salzsäure (HCl) und führe eine Neutralisationsreaktion durch.',
					'mission3': 'Entdecke verschiedene Kohlenstoffverbindungen: CO₂, CO und CH₄.',
					'mission4': 'Erzeuge Rost und führe einen Schmelzprozess durch, um Stahl herzustellen.',
					'mission5': 'Führe Elektrolyse von Wasser und Salzlösung durch.',
					'mission6': 'Erforsche die reaktiven Halogene und stelle Fluorwasserstoff her.',
					'mission7': 'Entdecke lichtempfindliche Silberverbindungen für die Fotografie.',
					'mission8': 'Führe organische Reaktionen und Veresterung durch.',
					'mission9': 'Führe industriell wichtige Prozesse wie den Haber-Prozess durch.',
					'mission10': 'Erforsche moderne Materialien und Legierungen.'
				};
				return descMap[id] || '';
			}

			function getEnglishMissionDescription(id) {
				const descMap = {
					'mission1': 'Discover the basic molecules Water (H₂O) and Hydrogen Gas (H₂).',
					'mission2': 'Create Hydrochloric Acid (HCl) and perform a neutralization reaction.',
					'mission3': 'Discover various carbon compounds: CO₂, CO, and CH₄.',
					'mission4': 'Create rust and perform a smelting process to produce steel.',
					'mission5': 'Perform electrolysis of water and salt solution.',
					'mission6': 'Explore reactive halogens and create hydrogen fluoride.',
					'mission7': 'Discover light-sensitive silver compounds for photography.',
					'mission8': 'Conduct organic reactions and esterification.',
					'mission9': 'Conduct industrially important processes like the Haber process.',
					'mission10': 'Research modern materials and alloys.'
				};
				return descMap[id] || '';
			}

			function getGermanMissionReward(id) {
				const rewardMap = {
					'mission1': 'Freischaltung des Bunsenbrenners',
					'mission2': 'Freischaltung der Elektrizität',
					'mission3': 'Freischaltung des UV-Lichts',
					'mission4': 'Freischaltung fortgeschrittener Metalle: Cu, Ag, Au',
					'mission5': 'Freischaltung des Katalysators',
					'mission6': 'Freischaltung des Destillationsapparats',
					'mission7': 'Freischaltung fortgeschrittener Ausrüstung',
					'mission8': 'Freischaltung komplexer organischer Reaktionen',
					'mission9': 'Freischaltung fortgeschrittener industrieller Prozesse',
					'mission10': 'Meister der Chemie Auszeichnung'
				};
				return rewardMap[id] || '';
			}

			function getEnglishMissionReward(id) {
				const rewardMap = {
					'mission1': 'Unlocks the Bunsen Burner',
					'mission2': 'Unlocks Electricity',
					'mission3': 'Unlocks UV Light',
					'mission4': 'Unlocks advanced metals: Cu, Ag, Au',
					'mission5': 'Unlocks Catalyst',
					'mission6': 'Unlocks Distillation Apparatus',
					'mission7': 'Unlocks Advanced Equipment',
					'mission8': 'Unlocks Complex Organic Reactions',
					'mission9': 'Unlocks Advanced Industrial Processes',
					'mission10': 'Master of Chemistry Achievement'
				};
				return rewardMap[id] || '';
			}

			// Helper functions for achievement translations
			function getGermanAchievementTitle(id) {
				const titleMap = {
					'achievement1': 'Chemiker in Ausbildung',
					'achievement2': 'Laborassistent',
					'achievement3': 'Elementar, mein Lieber!',
					'achievement4': 'Meister der Mischungen',
					'achievement5': 'Reaktionsexperte',
					'achievement6': 'Alchemist',
					'achievement7': 'Moleküldesigner',
					'achievement8': 'Industriechemiker',
					'achievement9': 'Metallurgie-Meister',
					'achievement10': 'Chemie-Virtuose'
				};
				return titleMap[id] || id;
			}

			function getEnglishAchievementTitle(id) {
				const titleMap = {
					'achievement1': 'Chemist in Training',
					'achievement2': 'Lab Assistant',
					'achievement3': 'Elementary, My Dear!',
					'achievement4': 'Master of Mixtures',
					'achievement5': 'Reaction Expert',
					'achievement6': 'Alchemist',
					'achievement7': 'Molecule Designer',
					'achievement8': 'Industrial Chemist',
					'achievement9': 'Master Metallurgist',
					'achievement10': 'Chemistry Virtuoso'
				};
				return titleMap[id] || id;
			}

			function getGermanAchievementDescription(id) {
				const descMap = {
					'achievement1': 'Entdecke 5 verschiedene Verbindungen.',
					'achievement2': 'Schließe deine erste Mission ab.',
					'achievement3': 'Entdecke alle Grundelemente.',
					'achievement4': 'Erzeuge 3 verschiedene Gemische.',
					'achievement5': 'Führe 5 verschiedene Reaktionen durch.',
					'achievement6': 'Erreiche Level 10.',
					'achievement7': 'Entdecke 15 verschiedene Moleküle.',
					'achievement8': 'Führe 10 komplexe Reaktionen durch, die Ausrüstung erfordern.',
					'achievement9': 'Entdecke alle Metalle und Legierungen.',
					'achievement10': 'Schließe alle Missionen ab.'
				};
				return descMap[id] || '';
			}

			function getEnglishAchievementDescription(id) {
				const descMap = {
					'achievement1': 'Discover 5 different compounds.',
					'achievement2': 'Complete your first mission.',
					'achievement3': 'Discover all basic elements.',
					'achievement4': 'Create 3 different mixtures.',
					'achievement5': 'Perform 5 different reactions.',
					'achievement6': 'Reach Level 10.',
					'achievement7': 'Discover 15 different molecules.',
					'achievement8': 'Perform 10 complex reactions requiring equipment.',
					'achievement9': 'Discover all metals and alloys.',
					'achievement10': 'Complete all missions.'
				};
				return descMap[id] || '';
			}

			// Initialize game on mount
			onMounted(() => {
				loadGame();
				setupAutosave();

				// Check if missions are completed
				checkMissions(true);

				// Check if achievements are unlocked
				checkAchievements();
			});

			// Pagination
			const totalPages = computed(() => {
				return Math.ceil(filteredDiscoveries.value.length / itemsPerPage.value);
			});

			const paginationPages = computed(() => {
				const pages = [];
				for (let i = 1; i <= totalPages.value; i++) {
					pages.push(i);
				}
				return pages;
			});

			// Filtered discoveries based on category and search query
			const filteredDiscoveries = computed(() => {
				let filtered = discoveredItems.value;

				// Apply category filter
				if (discoveryFilter.value !== 'all') {
					filtered = filtered.filter(item => item.category === discoveryFilter.value);
				}

				// Apply search filter
				if (searchQuery.value.trim() !== '') {
					const query = searchQuery.value.toLowerCase();
					filtered = filtered.filter(item =>
						item.name.toLowerCase().includes(query) ||
						item.description.toLowerCase().includes(query) ||
						item.symbol.toLowerCase().includes(query)
					);
				}

				// Sort items by category and name
				filtered = filtered.sort((a, b) => {
					if (a.category !== b.category) {
						const categoryOrder = {'element': 1, 'molecule': 2, 'compound': 3, 'mixture': 4, 'reaction': 5};
						return categoryOrder[a.category] - categoryOrder[b.category];
					}
					return a.name.localeCompare(b.name);
				});

				return filtered;
			});

			return {
				// Game state
				darkMode,
				currentLanguage,
				workspace,
				discoveredItems,
				newlyDiscovered,
				notifications,
				showMissionsModal,
				playerLevel,
				currentLevelProgress,
				currentLevelTarget,
				activeEquipment,
				temperature,
				maxTemperature,
				activeTab,
				tabs,
				selectedDiscovery,
				selectedElement,
				currentPage,
				itemsPerPage,
				discoveryFilter,
				searchQuery,
				activeMission,
				showReactionAnimation,
				reactionResult,

				// Computed properties
				basicElements,
				availableEquipment,
				filteredDiscoveries,
				totalPages,
				paginationPages,
				recipeCount,
				missions,
				availableMissions,
				achievements,

				// Methods
				translate,
				getElementClass,
				onDragStart,
				onDrop,
				addToWorkspace,
				removeFromWorkspace,
				clearWorkspace,
				combineElements,
				toggleDarkMode,
				toggleLanguage,
				resetGame,
				addEquipment,
				removeEquipment,
				openMissionsModal,
				calculateMissionProgress,
				getMissionProgressText,
				selectActiveMission,
				getPeriodicElementClass,
				showElementInfo,
				isElementAvailable,
				addElementToWorkspace,
				showDiscoveryDetails,
				getDiscoveryRecipe,
				getRelatedDiscoveries,
				getElementSymbolById,
				getElementClassById,
				getEquipmentNameById,
				translateState,
				translateCategory,
				dismissNotification,
				notificationIconClass,
                displayWorkspaceHint,
                getMissionHints,
                getMissionIngredients,
                isIngredientAvailable
			};
		}
	}).mount('#app');
</script>
</body>
</html>
