<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ElementCraft: Erweiterte Chemie-Simulation</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.3.4/vue.global.prod.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js"></script>
  <style>
    [v-cloak] { display: none; }
    .element {
      transition: all 0.3s ease;
    }
    .element:hover {
      transform: scale(1.05);
      z-index: 10;
    }
    .workspace-area {
      min-height: 200px;
    }
    .discovered-item {
      transition: all 0.3s;
    }
    .discovered-item:hover {
      transform: translateY(-5px);
    }
    .lab-equipment {
      transition: all 0.3s;
    }
    .lab-equipment:hover {
      transform: scale(1.05);
    }
    .new-discovery {
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(66, 153, 225, 0.7); }
      70% { box-shadow: 0 0 0 10px rgba(66, 153, 225, 0); }
      100% { box-shadow: 0 0 0 0 rgba(66, 153, 225, 0); }
    }
    .notification {
      transition: all 0.5s;
      animation: slideIn 0.5s forwards;
    }
    @keyframes slideIn {
      from { transform: translateY(-100%); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    .notification-exit {
      animation: slideOut 0.5s forwards;
    }
    @keyframes slideOut {
      from { transform: translateY(0); opacity: 1; }
      to { transform: translateY(-100%); opacity: 0; }
    }
    .particle {
      position: absolute;
      border-radius: 50%;
      pointer-events: none;
      animation: particle 1s linear forwards;
    }
    @keyframes particle {
      0% { transform: translate(0, 0); opacity: 1; }
      100% { transform: translate(var(--tx), var(--ty)); opacity: 0; }
    }
    .tooltip {
      visibility: hidden;
      position: absolute;
      z-index: 50;
      width: auto;
      max-width: 250px;
      padding: 0.5rem;
      border-radius: 0.375rem;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      opacity: 0;
      transition: opacity 0.3s;
    }
    *:hover > .tooltip {
      visibility: visible;
      opacity: 1;
    }
    .mission-progress {
      transition: width 0.5s ease-in-out;
    }
    .tab-content {
      display: none;
    }
    .tab-content.active {
      display: block;
    }
    .reaction-animation {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 100;
      background-color: rgba(0, 0, 0, 0.7);
      animation: fadeIn 0.3s forwards;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    .bouncing {
      animation: bounce 1s infinite alternate;
    }
    @keyframes bounce {
      from { transform: translateY(0); }
      to { transform: translateY(-10px); }
    }
    .rotating {
      animation: rotate 2s linear infinite;
    }
    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    .tutorial-highlight {
      position: relative;
      z-index: 5;
      animation: highlight-pulse 2s infinite;
    }
    @keyframes highlight-pulse {
      0% { box-shadow: 0 0 0 0 rgba(66, 153, 225, 0.7); }
      70% { box-shadow: 0 0 0 10px rgba(66, 153, 225, 0); }
      100% { box-shadow: 0 0 0 0 rgba(66, 153, 225, 0); }
    }
    .modal-enter-active, .modal-leave-active {
      transition: opacity 0.3s;
    }
    .modal-enter-from, .modal-leave-to {
      opacity: 0;
    }
    .temperature-bar {
      height: 1.5rem;
      background: linear-gradient(to right, blue, green, yellow, red);
      border-radius: 0.375rem;
      position: relative;
    }
    .temperature-indicator {
      position: absolute;
      top: -8px;
      width: 10px;
      height: 20px;
      background-color: white;
      border: 1px solid black;
      border-radius: 2px;
      transform: translateX(-50%);
      transition: left 0.3s ease;
    }
  </style>
</head>
<body>
  <div id="app" v-cloak :class="darkMode ? 'bg-gray-900 text-white' : 'bg-gray-100 text-gray-900'" class="min-h-screen transition-colors duration-500">
    <!-- Header -->
    <header class="p-4 flex justify-between items-center" :class="darkMode ? 'bg-gray-800' : 'bg-blue-600 text-white'">
      <div class="flex items-center space-x-4">
        <h1 class="text-2xl md:text-3xl font-bold">ElementCraft</h1>
        <div class="hidden md:flex items-center space-x-2 p-2 rounded-lg" :class="darkMode ? 'bg-gray-700' : 'bg-blue-500'">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10 2a4 4 0 00-4 4v1H5a1 1 0 00-.994.89l-1 9A1 1 0 004 18h12a1 1 0 00.994-1.11l-1-9A1 1 0 0015 7h-1V6a4 4 0 00-4-4zm2 5V6a2 2 0 10-4 0v1h4zm-6 3a1 1 0 112 0 1 1 0 01-2 0zm7-1a1 1 0 100 2 1 1 0 000-2z" clip-rule="evenodd" />
          </svg>
          <span>{{ translate({ de: 'Entdeckungen', en: 'Discoveries' }) }}: {{ discoveredItems.length }}/{{ recipeCount }}</span>
        </div>
        <div class="hidden md:flex items-center space-x-2 p-2 rounded-lg" :class="darkMode ? 'bg-gray-700' : 'bg-blue-500'">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
          </svg>
          <span>{{ translate({ de: 'Level', en: 'Level' }) }}: {{ playerLevel }}</span>
        </div>
      </div>
      <div class="flex space-x-4">
        <button @click="openMissionsModal" class="p-2 rounded-lg hover:bg-opacity-80" :class="darkMode ? 'bg-green-700 hover:bg-green-600' : 'bg-green-500'">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
          </svg>
        </button>
        <button @click="openHelpModal" class="p-2 rounded-lg hover:bg-opacity-80" :class="darkMode ? 'bg-blue-700 hover:bg-blue-600' : 'bg-blue-500'">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
        </button>
        <button @click="resetGame" class="p-2 rounded-lg hover:bg-opacity-80" :class="darkMode ? 'bg-red-700 hover:bg-red-600' : 'bg-red-500'">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd" />
          </svg>
        </button>
        <button @click="toggleDarkMode" class="p-2 rounded-lg hover:bg-opacity-80" :class="darkMode ? 'bg-yellow-500 text-gray-900' : 'bg-gray-700'">
          <svg v-if="darkMode" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd" />
          </svg>
          <svg v-else xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z" />
          </svg>
        </button>
        <button @click="toggleLanguage" class="p-2 rounded-lg hover:bg-opacity-80" :class="darkMode ? 'bg-gray-700' : 'bg-gray-700 text-white'">
          {{ currentLanguage.toUpperCase() }}
        </button>
      </div>
    </header>

    <!-- Notifications -->
    <div class="fixed top-20 right-4 w-72 z-50 space-y-2">
      <div v-for="(notification, index) in notifications" :key="notification.id" 
           class="notification p-3 rounded-lg shadow-lg" 
           :class="[
             notification.exiting ? 'notification-exit' : '',
             darkMode ? 'bg-gray-800 border-l-4 border-blue-500' : 'bg-white border-l-4 border-blue-600 text-gray-800'
           ]">
        <div class="flex items-center">
          <div class="mr-3" :class="notificationIconClass(notification.type)">
            <svg v-if="notification.type === 'discovery'" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
            </svg>
            <svg v-else-if="notification.type === 'mission'" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
            </svg>
            <svg v-else xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </div>
          <div class="flex-grow">
            <div class="font-medium">{{ notification.title }}</div>
            <div class="text-sm opacity-90">{{ notification.message }}</div>
          </div>
          <button @click="dismissNotification(notification.id)" class="ml-2 text-gray-500 hover:text-gray-700">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
      </div>
    </div>

    <!-- Tutorial Overlay (when active) -->
    <div v-if="tutorialActive" class="fixed inset-0 bg-black bg-opacity-50 z-40 flex items-center justify-center">
      <div class="relative max-w-md w-full mx-4 bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 z-50">
        <button @click="skipTutorial" class="absolute top-2 right-2 text-gray-500 hover:text-gray-700">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
        <h3 class="text-xl font-bold mb-2">{{ currentTutorialStep.title }}</h3>
        <p class="mb-4">{{ currentTutorialStep.content }}</p>
        <div class="flex justify-between">
          <button 
            v-if="tutorialStepIndex > 0" 
            @click="prevTutorialStep" 
            class="px-4 py-2 bg-gray-300 dark:bg-gray-700 rounded hover:bg-gray-400 dark:hover:bg-gray-600"
          >
            {{ translate({ de: 'Zurück', en: 'Back' }) }}
          </button>
          <div v-else></div>
          <button 
            @click="nextTutorialStep" 
            class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"
          >
            {{ tutorialStepIndex < tutorialSteps.length - 1 
              ? translate({ de: 'Weiter', en: 'Next' }) 
              : translate({ de: 'Fertig', en: 'Finish' }) }}
          </button>
        </div>
      </div>
    </div>

    <!-- Main Game Area -->
    <main class="container mx-auto p-4 pb-24">
      <!-- Introduction Message (first visit) -->
      <div v-if="showWelcome" class="mb-6 p-4 rounded-lg shadow-md" :class="darkMode ? 'bg-gray-800' : 'bg-blue-50 text-blue-800'">
        <div class="flex items-start">
          <svg class="h-6 w-6 mt-1 mr-3 flex-shrink-0" :class="darkMode ? 'text-blue-400' : 'text-blue-600'" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
          </svg>
          <div>
            <h3 class="font-bold text-lg mb-1">{{ translate({ de: 'Willkommen bei ElementCraft!', en: 'Welcome to ElementCraft!' }) }}</h3>
            <p>{{ translate({ de: 'Entdecke die faszinierende Welt der Chemie und Physik! Kombiniere Elemente, führe Experimente durch und meistere Missionen. Nutze Laborgeräte, um komplexe Verbindungen herzustellen.', en: 'Discover the fascinating world of chemistry and physics! Combine elements, conduct experiments, and complete missions. Use laboratory equipment to create complex compounds.' }) }}</p>
            <div class="mt-4 flex space-x-4">
              <button @click="startTutorial" class="px-3 py-1 text-sm rounded-md" :class="darkMode ? 'bg-blue-600 hover:bg-blue-500' : 'bg-blue-600 text-white hover:bg-blue-700'">
                {{ translate({ de: 'Tutorial starten', en: 'Start Tutorial' }) }}
              </button>
              <button @click="showWelcome = false" class="px-3 py-1 text-sm rounded-md" :class="darkMode ? 'bg-gray-600 hover:bg-gray-500' : 'bg-gray-600 text-white hover:bg-gray-700'">
                {{ translate({ de: 'Überspringen', en: 'Skip' }) }}
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Quick Mission Progress -->
      <div v-if="activeMission" class="mb-6 p-4 rounded-lg shadow-md" :class="darkMode ? 'bg-gray-800' : 'bg-blue-50 text-blue-800'">
        <div class="flex justify-between items-start">
          <div class="flex items-start">
            <svg class="h-6 w-6 mt-1 mr-3 flex-shrink-0" :class="darkMode ? 'text-yellow-400' : 'text-yellow-600'" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
            </svg>
            <div>
              <h3 class="font-bold text-lg mb-1">{{ activeMission.title }}</h3>
              <p>{{ activeMission.description }}</p>
              <div class="mt-2 w-full bg-gray-300 rounded-full h-2.5 dark:bg-gray-700">
                <div class="bg-blue-600 h-2.5 rounded-full mission-progress" :style="{ width: `${calculateMissionProgress(activeMission)}%` }"></div>
              </div>
              <div class="mt-1 text-sm">
                {{ translate({ de: 'Fortschritt', en: 'Progress' }) }}: 
                {{ getMissionProgressText(activeMission) }}
              </div>
            </div>
          </div>
          <button @click="activeMission = null" class="text-gray-500 hover:text-gray-700 ml-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
      </div>

      <!-- Tabs for different game areas -->
      <div class="mb-6">
        <div class="flex border-b" :class="darkMode ? 'border-gray-700' : 'border-gray-200'">
          <button 
            v-for="tab in tabs" 
            :key="tab.id" 
            @click="activeTab = tab.id" 
            class="py-2 px-4 font-medium rounded-t-lg transition-all"
            :class="[
              activeTab === tab.id 
                ? (darkMode ? 'bg-gray-800 text-blue-400 border-b-2 border-blue-400' : 'bg-white text-blue-600 border-b-2 border-blue-600') 
                : (darkMode ? 'text-gray-400 hover:text-white' : 'text-gray-500 hover:text-gray-700')
            ]"
          >
            <div class="flex items-center">
              <component :is="tab.icon" class="h-5 w-5 mr-2"></component>
              {{ tab.name }}
            </div>
          </button>
        </div>
      </div>

      <!-- Lab Tab -->
      <div v-if="activeTab === 'lab'" class="tab-content active">
        <!-- Workspace Area -->
        <div class="workspace-area mb-6 p-4 rounded-lg shadow-md relative" :class="darkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200'">
          <div class="flex justify-between items-center mb-3">
            <h2 class="text-xl font-bold">{{ translate({ de: 'Arbeitsbereich', en: 'Workspace' }) }}</h2>
            
            <!-- Temperature Control -->
            <div class="flex items-center space-x-2">
              <span class="text-sm">{{ translate({ de: 'Temperatur', en: 'Temperature' }) }}:</span>
              <div class="temperature-bar w-32 relative">
                <div class="temperature-indicator" :style="{ left: `${(temperature / maxTemperature) * 100}%` }"></div>
              </div>
              <input 
                type="range" 
                v-model.number="temperature" 
                min="0" 
                :max="maxTemperature" 
                class="w-24"
              >
              <input 
                type="number" 
                v-model.number="temperature" 
                min="0" 
                :max="maxTemperature" 
                class="w-16 px-2 py-1 rounded-md"
                :class="darkMode ? 'bg-gray-700 border-gray-600' : 'bg-white border-gray-300'"
              >
              <span class="text-sm">°C</span>
            </div>
          </div>
          
          <!-- Active Equipment Display -->
          <div v-if="activeEquipment.length > 0" class="mb-4 flex flex-wrap gap-2">
            <div v-for="(item, index) in activeEquipment" :key="'eq-'+index" 
                class="lab-equipment p-2 rounded-lg shadow-md flex items-center space-x-2"
                :class="getElementClass(item)">
              <span class="text-lg">{{ item.symbol }}</span>
              <span class="text-sm">{{ item.name }}</span>
              <button @click="removeEquipment(index)" class="text-gray-500 hover:text-gray-700 ml-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
              </button>
            </div>
          </div>
          
          <div class="flex flex-wrap gap-3 min-h-32" @dragover.prevent @drop="onDrop">
            <div v-for="(item, index) in workspace" :key="'workspace-'+index" 
                class="element cursor-grab p-3 rounded-lg shadow-md"
                :class="getElementClass(item)"
                draggable="true"
                @dragstart="onDragStart($event, item, index, 'workspace')"
                @click="removeFromWorkspace(index)">
              <div class="font-bold text-lg">{{ item.symbol }}</div>
              <div class="text-xs">{{ item.name }}</div>
              <div v-if="item.state" class="text-xs mt-1 italic">
                {{ translate({ de: 'Zustand', en: 'State' }) }}: {{ translateState(item.state) }}
              </div>
            </div>
            <div v-if="workspace.length === 0" class="w-full h-32 flex items-center justify-center text-gray-500 italic">
              {{ translate({ de: 'Ziehe Elemente hierher, um zu experimentieren', en: 'Drag elements here to experiment' }) }}
            </div>
          </div>

          <div class="mt-4 flex justify-between items-center">
            <button @click="combineElements" class="px-4 py-2 rounded-lg shadow hover:shadow-lg transition-all" 
                    :class="[workspace.length >= 2 || (workspace.length >= 1 && activeEquipment.length > 0) ? (darkMode ? 'bg-green-600 hover:bg-green-500' : 'bg-green-500 hover:bg-green-400 text-white') : (darkMode ? 'bg-gray-700 cursor-not-allowed' : 'bg-gray-300 cursor-not-allowed text-gray-500'), 'flex items-center space-x-2']"
                    :disabled="workspace.length < 2 && (workspace.length < 1 || activeEquipment.length === 0)">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" />
              </svg>
              <span>{{ translate({ de: 'Kombinieren', en: 'Combine' }) }}</span>
            </button>
            <button @click="clearWorkspace" class="px-4 py-2 rounded-lg shadow hover:shadow-lg transition-all flex items-center space-x-2" 
                    :class="workspace.length > 0 ? (darkMode ? 'bg-red-600 hover:bg-red-500' : 'bg-red-500 hover:bg-red-400 text-white') : (darkMode ? 'bg-gray-700 cursor-not-allowed' : 'bg-gray-300 cursor-not-allowed text-gray-500')"
                    :disabled="workspace.length === 0">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
              </svg>
              <span>{{ translate({ de: 'Leeren', en: 'Clear' }) }}</span>
            </button>
          </div>
        </div>

        <!-- Basic Elements -->
        <div class="mb-6 p-4 rounded-lg shadow-md" :class="darkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200'">
          <h2 class="text-xl font-bold mb-3">{{ translate({ de: 'Grundelemente', en: 'Basic Elements' }) }}</h2>
          <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3">
            <div v-for="element in basicElements" :key="element.id" 
                class="element cursor-grab p-3 rounded-lg shadow-md transition-all relative"
                :class="[getElementClass(element), {'tutorial-highlight': tutorialActive && tutorialStepIndex === 1}]"
                draggable="true"
                @dragstart="onDragStart($event, element, null, 'basics')"
                @click="addToWorkspace(element)">
              <div class="font-bold text-lg">{{ element.symbol }}</div>
              <div class="text-xs">{{ element.name }}</div>
              <div class="tooltip" :class="darkMode ? 'bg-gray-700' : 'bg-white text-gray-800'">
                <h4 class="font-bold">{{ element.name }}</h4>
                <p v-if="element.description" class="text-xs mt-1">{{ element.description }}</p>
                <div v-if="element.atomicNumber" class="text-xs mt-1">
                  {{ translate({ de: 'Ordnungszahl', en: 'Atomic Number' }) }}: {{ element.atomicNumber }}
                </div>
                <div v-if="element.atomicWeight" class="text-xs">
                  {{ translate({ de: 'Atomgewicht', en: 'Atomic Weight' }) }}: {{ element.atomicWeight }}
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Laboratory Equipment -->
        <div class="mb-6 p-4 rounded-lg shadow-md" :class="darkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200'">
          <h2 class="text-xl font-bold mb-3">{{ translate({ de: 'Laborgeräte', en: 'Laboratory Equipment' }) }}</h2>
          <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3">
            <div v-for="equipment in availableEquipment" :key="equipment.id" 
                class="lab-equipment cursor-grab p-3 rounded-lg shadow-md transition-all relative"
                :class="[getElementClass(equipment), {'tutorial-highlight': tutorialActive && tutorialStepIndex === 2}]"
                draggable="true"
                @dragstart="onDragStart($event, equipment, null, 'equipment')"
                @click="addEquipment(equipment)">
              <div class="font-bold text-lg">{{ equipment.symbol }}</div>
              <div class="text-xs">{{ equipment.name }}</div>
              <div class="tooltip" :class="darkMode ? 'bg-gray-700' : 'bg-white text-gray-800'">
                <h4 class="font-bold">{{ equipment.name }}</h4>
                <p class="text-xs mt-1">{{ equipment.description }}</p>
                <div class="text-xs mt-1 italic">
                  {{ translate({ de: 'Ermöglicht', en: 'Enables' }) }}: {{ equipment.enables.join(', ') }}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Elements Tab -->
      <div v-if="activeTab === 'elements'" class="tab-content active">
        <div class="mb-6 p-4 rounded-lg shadow-md" :class="darkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200'">
          <h2 class="text-xl font-bold mb-3">{{ translate({ de: 'Periodensystem der Elemente', en: 'Periodic Table of Elements' }) }}</h2>
          <p class="mb-4 text-sm">{{ translate({ de: 'Klicke auf ein Element für mehr Informationen.', en: 'Click on an element to learn more.' }) }}</p>
          
          <!-- Simplified Periodic Table -->
          <div class="grid grid-cols-18 gap-1">
            <!-- First Row -->
            <div class="element p-1 rounded-sm text-center cursor-pointer" :class="getPeriodicElementClass(1)" @click="showElementInfo(1)">
              <div class="text-xs font-bold">H</div>
              <div class="text-xs">1</div>
            </div>
            <div class="col-span-16"></div>
            <div class="element p-1 rounded-sm text-center cursor-pointer" :class="getPeriodicElementClass(2)" @click="showElementInfo(2)">
              <div class="text-xs font-bold">He</div>
              <div class="text-xs">2</div>
            </div>
            
            <!-- Second Row -->
            <div class="element p-1 rounded-sm text-center cursor-pointer" :class="getPeriodicElementClass(3)" @click="showElementInfo(3)">
              <div class="text-xs font-bold">Li</div>
              <div class="text-xs">3</div>
            </div>
            <div class="element p-1 rounded-sm text-center cursor-pointer" :class="getPeriodicElementClass(4)" @click="showElementInfo(4)">
              <div class="text-xs font-bold">Be</div>
              <div class="text-xs">4</div>
            </div>
            <div class="col-span-10"></div>
            <div class="element p-1 rounded-sm text-center cursor-pointer" :class="getPeriodicElementClass(5)" @click="showElementInfo(5)">
              <div class="text-xs font-bold">B</div>
              <div class="text-xs">5</div>
            </div>
            <div class="element p-1 rounded-sm text-center cursor-pointer" :class="getPeriodicElementClass(6)" @click="showElementInfo(6)">
              <div class="text-xs font-bold">C</div>
              <div class="text-xs">6</div>
            </div>
            <div class="element p-1 rounded-sm text-center cursor-pointer" :class="getPeriodicElementClass(7)" @click="showElementInfo(7)">
              <div class="text-xs font-bold">N</div>
              <div class="text-xs">7</div>
            </div>
            <div class="element p-1 rounded-sm text-center cursor-pointer" :class="getPeriodicElementClass(8)" @click="showElementInfo(8)">
              <div class="text-xs font-bold">O</div>
              <div class="text-xs">8</div>
            </div>
            <div class="element p-1 rounded-sm text-center cursor-pointer" :class="getPeriodicElementClass(9)" @click="showElementInfo(9)">
              <div class="text-xs font-bold">F</div>
              <div class="text-xs">9</div>
            </div>
            <div class="element p-1 rounded-sm text-center cursor-pointer" :class="getPeriodicElementClass(10)" @click="showElementInfo(10)">
              <div class="text-xs font-bold">Ne</div>
              <div class="text-xs">10</div>
            </div>
            
            <!-- Third Row -->
            <div class="element p-1 rounded-sm text-center cursor-pointer" :class="getPeriodicElementClass(11)" @click="showElementInfo(11)">
              <div class="text-xs font-bold">Na</div>
              <div class="text-xs">11</div>
            </div>
            <div class="element p-1 rounded-sm text-center cursor-pointer" :class="getPeriodicElementClass(12)" @click="showElementInfo(12)">
              <div class="text-xs font-bold">Mg</div>
              <div class="text-xs">12</div>
            </div>
            <div class="col-span-10"></div>
            <div class="element p-1 rounded-sm text-center cursor-pointer" :class="getPeriodicElementClass(13)" @click="showElementInfo(13)">
              <div class="text-xs font-bold">Al</div>
              <div class="text-xs">13</div>
            </div>
            <div class="element p-1 rounded-sm text-center cursor-pointer" :class="getPeriodicElementClass(14)" @click="showElementInfo(14)">
              <div class="text-xs font-bold">Si</div>
              <div class="text-xs">14</div>
            </div>
            <div class="element p-1 rounded-sm text-center cursor-pointer" :class="getPeriodicElementClass(15)" @click="showElementInfo(15)">
              <div class="text-xs font-bold">P</div>
              <div class="text-xs">15</div>
            </div>
            <div class="element p-1 rounded-sm text-center cursor-pointer" :class="getPeriodicElementClass(16)" @click="showElementInfo(16)">
              <div class="text-xs font-bold">S</div>
              <div class="text-xs">16</div>
            </div>
            <div class="element p-1 rounded-sm text-center cursor-pointer" :class="getPeriodicElementClass(17)" @click="showElementInfo(17)">
              <div class="text-xs font-bold">Cl</div>
              <div class="text-xs">17</div>
            </div>
            <div class="element p-1 rounded-sm text-center cursor-pointer" :class="getPeriodicElementClass(18)" @click="showElementInfo(18)">
              <div class="text-xs font-bold">Ar</div>
              <div class="text-xs">18</div>
            </div>
          </div>
          
          <!-- Element information (when clicking on periodic table) -->
          <div v-if="selectedElement" class="mt-6 p-4 rounded-lg" :class="darkMode ? 'bg-gray-700' : 'bg-blue-50'">
            <div class="flex justify-between items-start">
              <div>
                <div class="flex items-baseline">
                  <h3 class="text-xl font-bold">{{ selectedElement.name }}</h3>
                  <span class="ml-2 text-sm opacity-70">{{ selectedElement.symbol }}</span>
                </div>
                <div class="grid grid-cols-2 mt-2 gap-y-2">
                  <div class="text-sm">
                    {{ translate({ de: 'Ordnungszahl', en: 'Atomic Number' }) }}: {{ selectedElement.atomicNumber }}
                  </div>
                  <div class="text-sm">
                    {{ translate({ de: 'Atomgewicht', en: 'Atomic Weight' }) }}: {{ selectedElement.atomicWeight }}
                  </div>
                  <div class="text-sm">
                    {{ translate({ de: 'Kategorie', en: 'Category' }) }}: {{ selectedElement.category }}
                  </div>
                  <div class="text-sm">
                    {{ translate({ de: 'Schmelzpunkt', en: 'Melting Point' }) }}: {{ selectedElement.meltingPoint || 'N/A' }}
                  </div>
                  <div class="text-sm">
                    {{ translate({ de: 'Siedepunkt', en: 'Boiling Point' }) }}: {{ selectedElement.boilingPoint || 'N/A' }}
                  </div>
                  <div class="text-sm">
                    {{ translate({ de: 'Phase bei RT', en: 'Phase at RT' }) }}: {{ translateState(selectedElement.phase) }}
                  </div>
                </div>
                <p class="mt-3 text-sm">{{ selectedElement.description }}</p>
              </div>
              <button @click="selectedElement = null" class="text-gray-500 hover:text-gray-700">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
              </button>
            </div>
            <div class="mt-4">
              <button 
                v-if="isElementAvailable(selectedElement.symbol)"
                @click="addElementToWorkspace(selectedElement.symbol)" 
                class="px-3 py-1 text-sm rounded-md"
                :class="darkMode ? 'bg-green-600 hover:bg-green-500' : 'bg-green-500 text-white hover:bg-green-600'"
              >
                {{ translate({ de: 'Zum Arbeitsbereich hinzufügen', en: 'Add to Workspace' }) }}
              </button>
              <div v-else class="text-sm text-yellow-500">
                {{ translate({ de: 'Entdecke dieses Element, um es zu nutzen', en: 'Discover this element to use it' }) }}
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Discoveries Tab -->
      <div v-if="activeTab === 'discoveries'" class="tab-content active">
        <!-- Discovered Items -->
        <div class="p-4 rounded-lg shadow-md" :class="darkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200'">
          <div class="flex justify-between items-center mb-3">
            <h2 class="text-xl font-bold">{{ translate({ de: 'Entdeckungen', en: 'Discoveries' }) }} ({{ discoveredItems.length }}/{{ recipeCount }})</h2>
            <div class="text-sm px-3 py-1 rounded-full" :class="darkMode ? 'bg-gray-700' : 'bg-blue-100 text-blue-800'">
              {{ translate({ de: 'Level', en: 'Level' }) }}: {{ playerLevel }}
            </div>
          </div>
          
          <!-- Discovery Category Filters -->
          <div class="mb-4 flex flex-wrap gap-2">
            <button 
              @click="discoveryFilter = 'all'" 
              class="px-3 py-1 text-sm rounded-md transition-colors"
              :class="discoveryFilter === 'all' ? (darkMode ? 'bg-blue-600' : 'bg-blue-500 text-white') : (darkMode ? 'bg-gray-700' : 'bg-gray-200')"
            >
              {{ translate({ de: 'Alle', en: 'All' }) }}
            </button>
            <button 
              @click="discoveryFilter = 'element'" 
              class="px-3 py-1 text-sm rounded-md transition-colors"
              :class="discoveryFilter === 'element' ? (darkMode ? 'bg-blue-600' : 'bg-blue-500 text-white') : (darkMode ? 'bg-gray-700' : 'bg-gray-200')"
            >
              {{ translate({ de: 'Elemente', en: 'Elements' }) }}
            </button>
            <button 
              @click="discoveryFilter = 'molecule'" 
              class="px-3 py-1 text-sm rounded-md transition-colors"
              :class="discoveryFilter === 'molecule' ? (darkMode ? 'bg-blue-600' : 'bg-blue-500 text-white') : (darkMode ? 'bg-gray-700' : 'bg-gray-200')"
            >
              {{ translate({ de: 'Moleküle', en: 'Molecules' }) }}
            </button>
            <button 
              @click="discoveryFilter = 'compound'" 
              class="px-3 py-1 text-sm rounded-md transition-colors"
              :class="discoveryFilter === 'compound' ? (darkMode ? 'bg-blue-600' : 'bg-blue-500 text-white') : (darkMode ? 'bg-gray-700' : 'bg-gray-200')"
            >
              {{ translate({ de: 'Verbindungen', en: 'Compounds' }) }}
            </button>
            <button 
              @click="discoveryFilter = 'mixture'" 
              class="px-3 py-1 text-sm rounded-md transition-colors"
              :class="discoveryFilter === 'mixture' ? (darkMode ? 'bg-blue-600' : 'bg-blue-500 text-white') : (darkMode ? 'bg-gray-700' : 'bg-gray-200')"
            >
              {{ translate({ de: 'Gemische', en: 'Mixtures' }) }}
            </button>
            <button 
              @click="discoveryFilter = 'reaction'" 
              class="px-3 py-1 text-sm rounded-md transition-colors"
              :class="discoveryFilter === 'reaction' ? (darkMode ? 'bg-blue-600' : 'bg-blue-500 text-white') : (darkMode ? 'bg-gray-700' : 'bg-gray-200')"
            >
              {{ translate({ de: 'Reaktionen', en: 'Reactions' }) }}
            </button>
          </div>
          
          <!-- Search bar -->
          <div class="mb-4">
            <input 
              type="text" 
              v-model="searchQuery" 
              :placeholder="translate({ de: 'Suche nach Entdeckungen...', en: 'Search discoveries...' })" 
              class="w-full p-2 rounded-md"
              :class="darkMode ? 'bg-gray-700 border-gray-600' : 'bg-white border-gray-300'"
            >
          </div>
          
          <div v-if="filteredDiscoveries.length === 0" class="text-center py-8 text-gray-500 italic">
            <span v-if="discoveredItems.length === 0">
              {{ translate({ de: 'Noch keine Entdeckungen gemacht. Kombiniere Elemente, um zu beginnen!', en: 'No discoveries yet. Combine elements to start!' }) }}
            </span>
            <span v-else>
              {{ translate({ de: 'Keine Entdeckungen entsprechen deinen Filterkriterien.', en: 'No discoveries match your filter criteria.' }) }}
            </span>
          </div>
          
          <div v-else class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3">
            <div v-for="item in filteredDiscoveries" :key="item.id" 
                class="discovered-item cursor-grab p-3 rounded-lg shadow-md relative"
                :class="[getElementClass(item), {'new-discovery': newlyDiscovered.includes(item.id), 'tutorial-highlight': tutorialActive && tutorialStepIndex === 3 && filteredDiscoveries.value && filteredDiscoveries.value.length > 0 && filteredDiscoveries.value.indexOf(item) === 0}]"
                draggable="true"
                @dragstart="onDragStart($event, item, null, 'discoveries')"
                @click="showDiscoveryDetails(item)">
              <div class="font-bold text-lg">{{ item.symbol }}</div>
              <div class="text-xs">{{ item.name }}</div>
              <div class="text-xs mt-1 opacity-70 line-clamp-2">{{ item.description }}</div>
              <div v-if="item.state" class="text-xs mt-1 italic">
                {{ translate({ de: 'Zustand', en: 'State' }) }}: {{ translateState(item.state) }}
              </div>
            </div>
          </div>
          
          <!-- Pagination Controls -->
          <div v-if="filteredDiscoveries.length > itemsPerPage" class="mt-6 flex justify-center">
            <div class="flex space-x-2">
              <button 
                @click="currentPage = Math.max(1, currentPage - 1)" 
                :disabled="currentPage === 1"
                class="px-3 py-1 rounded"
                :class="currentPage === 1 ? 'opacity-50 cursor-not-allowed' : 'hover:bg-gray-200 dark:hover:bg-gray-700'"
              >
                {{ translate({ de: 'Zurück', en: 'Previous' }) }}
              </button>
              <div class="flex space-x-1">
                <button 
                  v-for="page in paginationPages" 
                  :key="page" 
                  @click="currentPage = page"
                  class="w-8 h-8 flex items-center justify-center rounded"
                  :class="currentPage === page ? (darkMode ? 'bg-blue-600' : 'bg-blue-500 text-white') : 'hover:bg-gray-200 dark:hover:bg-gray-700'"
                >
                  {{ page }}
                </button>
              </div>
              <button 
                @click="currentPage = Math.min(totalPages, currentPage + 1)" 
                :disabled="currentPage === totalPages"
                class="px-3 py-1 rounded"
                :class="currentPage === totalPages ? 'opacity-50 cursor-not-allowed' : 'hover:bg-gray-200 dark:hover:bg-gray-700'"
              >
                {{ translate({ de: 'Weiter', en: 'Next' }) }}
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Encyclopedia Tab -->
      <div v-if="activeTab === 'encyclopedia'" class="tab-content active">
        <div class="p-4 rounded-lg shadow-md" :class="darkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200'">
          <h2 class="text-xl font-bold mb-3">{{ translate({ de: 'Chemie & Physik Enzyklopädie', en: 'Chemistry & Physics Encyclopedia' }) }}</h2>
          
          <!-- Encyclopedia Categories -->
          <div class="mb-4 flex flex-wrap gap-2">
            <button 
              v-for="category in encyclopediaCategories" 
              :key="category.id"
              @click="encyclopediaActiveCategory = category.id" 
              class="px-3 py-1 text-sm rounded-md transition-colors"
              :class="encyclopediaActiveCategory === category.id ? (darkMode ? 'bg-blue-600' : 'bg-blue-500 text-white') : (darkMode ? 'bg-gray-700' : 'bg-gray-200')"
            >
              {{ category.name }}
            </button>
          </div>
          
          <!-- Encyclopedia Content -->
          <div class="mt-4">
            <div v-for="category in encyclopediaCategories" :key="'content-'+category.id" v-show="encyclopediaActiveCategory === category.id">
              <h3 class="text-lg font-semibold mb-2">{{ category.name }}</h3>
              <p class="mb-4 text-sm">{{ category.description }}</p>
              
              <!-- Topics List -->
              <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                <div v-for="topic in getEncyclopediaTopics(category.id)" :key="topic.id"
                     class="p-3 rounded-lg cursor-pointer hover:shadow-md transition-all"
                     :class="darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-100 hover:bg-gray-200'"
                     @click="showEncyclopediaTopic(topic)">
                  <h4 class="font-semibold">{{ topic.title }}</h4>
                  <p class="text-sm opacity-80 line-clamp-2">{{ topic.preview }}</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Game Progress Footer -->
    <footer class="fixed bottom-0 left-0 right-0 p-3 z-30" :class="darkMode ? 'bg-gray-800 border-t border-gray-700' : 'bg-white border-t border-gray-200 shadow-md'">
      <div class="container mx-auto">
        <div class="flex justify-between items-center">
          <div class="flex items-center space-x-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" :class="darkMode ? 'text-yellow-400' : 'text-yellow-500'" viewBox="0 0 20 20" fill="currentColor">
              <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118l-2.8-2.034c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
            </svg>
            <span>{{ translate({ de: 'Fortschritt', en: 'Progress' }) }}: {{ Math.round((discoveredItems.length / recipeCount) * 100) }}%</span>
          </div>
          
          <div class="w-1/2 bg-gray-300 rounded-full h-2.5 overflow-hidden">
            <div class="h-2.5 rounded-full" :style="{ width: `${Math.round((discoveredItems.length / recipeCount) * 100)}%` }"
                 :class="darkMode ? 'bg-green-500' : 'bg-blue-600'"></div>
          </div>
          
          <div class="text-sm">
            {{ translate({ de: 'Nächstes Level', en: 'Next Level' }) }}: {{ currentLevelProgress }}/{{ currentLevelTarget }}
          </div>
        </div>
      </div>
    </footer>

    <!-- Modals -->
    <!-- Help Modal -->
    <div v-if="showHelpModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
        <div class="p-6">
          <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-bold">{{ translate({ de: 'Hilfe & Anleitung', en: 'Help & Guide' }) }}</h2>
            <button @click="showHelpModal = false" class="text-gray-500 hover:text-gray-700">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
          </div>
          
          <div class="mb-6">
            <h3 class="font-semibold text-lg mb-2">{{ translate({ de: 'Grundlagen', en: 'Basics' }) }}</h3>
            <p class="mb-2">{{ translate({ de: 'ElementCraft ist ein Spiel, in dem du chemische Elemente kombinieren und neue Verbindungen entdecken kannst.', en: 'ElementCraft is a game where you can combine chemical elements and discover new compounds.' }) }}</p>
            <ol class="list-decimal pl-5 space-y-1">
              <li>{{ translate({ de: 'Ziehe Grundelemente in den Arbeitsbereich', en: 'Drag basic elements to the workspace' }) }}</li>
              <li>{{ translate({ de: 'Verwende Laborgeräte, um besondere Reaktionen zu ermöglichen', en: 'Use laboratory equipment to enable special reactions' }) }}</li>
              <li>{{ translate({ de: 'Kombiniere Elemente, um neue Verbindungen zu entdecken', en: 'Combine elements to discover new compounds' }) }}</li>
              <li>{{ translate({ de: 'Erfülle Missionen, um im Spiel voranzuschreiten', en: 'Complete missions to progress in the game' }) }}</li>
            </ol>
          </div>
          
          <div class="mb-6">
            <h3 class="font-semibold text-lg mb-2">{{ translate({ de: 'Laborgeräte', en: 'Laboratory Equipment' }) }}</h3>
            <p>{{ translate({ de: 'Laborgeräte sind entscheidend für fortgeschrittene Reaktionen:', en: 'Laboratory equipment is crucial for advanced reactions:' }) }}</p>
            <ul class="list-disc pl-5 space-y-1">
              <li>{{ translate({ de: 'Bunsenbrenner: Ermöglicht Reaktionen, die Hitze benötigen', en: 'Bunsen Burner: Enables reactions requiring heat' }) }}</li>
              <li>{{ translate({ de: 'Reagenzglas: Ideal für kleine Reaktionen und Mischungen', en: 'Test Tube: Perfect for small reactions and mixtures' }) }}</li>
              <li>{{ translate({ de: 'Becherglas: Für größere Mengen und komplexere Reaktionen', en: 'Beaker: For larger volumes and more complex reactions' }) }}</li>
              <li>{{ translate({ de: 'Waage: Ermöglicht präzise Messungen und stöchiometrische Berechnungen', en: 'Scale: Enables precise measurements and stoichiometric calculations' }) }}</li>
            </ul>
          </div>
          
          <div class="mb-6">
            <h3 class="font-semibold text-lg mb-2">{{ translate({ de: 'Tipps', en: 'Tips' }) }}</h3>
            <ul class="list-disc pl-5 space-y-1">
              <li>{{ translate({ de: 'Achte auf die Temperatur bei thermischen Reaktionen', en: 'Pay attention to temperature for thermal reactions' }) }}</li>
              <li>{{ translate({ de: 'Nutze die Enzyklopädie, um mehr über chemische Konzepte zu lernen', en: 'Use the encyclopedia to learn more about chemical concepts' }) }}</li>
              <li>{{ translate({ de: 'Experimentiere mit verschiedenen Kombinationen und Ausrüstungen', en: 'Experiment with different combinations and equipment' }) }}</li>
              <li>{{ translate({ de: 'Schließe Missionen ab, um neue Geräte und Elemente freizuschalten', en: 'Complete missions to unlock new equipment and elements' }) }}</li>
            </ul>
          </div>
          
          <div class="flex justify-center mt-4">
            <button @click="startTutorial" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">
              {{ translate({ de: 'Tutorial starten', en: 'Start Tutorial' }) }}
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Missions Modal -->
    <div v-if="showMissionsModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
        <div class="p-6">
          <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-bold">{{ translate({ de: 'Missionen & Errungenschaften', en: 'Missions & Achievements' }) }}</h2>
            <button @click="showMissionsModal = false" class="text-gray-500 hover:text-gray-700">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
          </div>
          
          <div class="mb-4">
            <h3 class="font-semibold text-lg mb-2">{{ translate({ de: 'Aktuelle Missionen', en: 'Current Missions' }) }}</h3>
            <div v-if="availableMissions.length === 0" class="text-center py-4 italic text-gray-500">
              {{ translate({ de: 'Keine Missionen verfügbar. Entdecke mehr Verbindungen, um neue Missionen freizuschalten!', en: 'No missions available. Discover more compounds to unlock new missions!' }) }}
            </div>
            <div v-else>
              <div v-for="mission in availableMissions" :key="mission.id" 
                   class="mb-3 p-3 rounded-lg"
                   :class="darkMode ? 'bg-gray-700' : 'bg-gray-100'">
                <div class="flex justify-between">
                  <h4 class="font-semibold">{{ mission.title }}</h4>
                  <span class="text-sm px-2 py-0.5 rounded-full" 
                        :class="mission.completed ? 'bg-green-500 text-white' : (darkMode ? 'bg-gray-600' : 'bg-gray-300')">
                    {{ mission.completed ? translate({ de: 'Abgeschlossen', en: 'Completed' }) : translate({ de: 'Offen', en: 'Open' }) }}
                  </span>
                </div>
                <p class="text-sm mt-1">{{ mission.description }}</p>
                <div class="mt-2 w-full bg-gray-300 dark:bg-gray-600 rounded-full h-2">
                  <div class="bg-blue-600 h-2 rounded-full" :style="{ width: `${calculateMissionProgress(mission)}%` }"></div>
                </div>
                <div class="flex justify-between mt-1 text-xs">
                  <span>{{ getMissionProgressText(mission) }}</span>
                  <span>{{ translate({ de: 'Belohnung', en: 'Reward' }) }}: {{ mission.reward }}</span>
                </div>
                <button 
                  v-if="!mission.completed && !activeMission" 
                  @click="selectActiveMission(mission)" 
                  class="mt-2 px-3 py-1 text-sm rounded-md bg-blue-500 text-white hover:bg-blue-600"
                >
                  {{ translate({ de: 'Aktivieren', en: 'Activate' }) }}
                </button>
                <button 
                  v-else-if="activeMission && activeMission.id === mission.id" 
                  @click="activeMission = null" 
                  class="mt-2 px-3 py-1 text-sm rounded-md bg-gray-500 text-white hover:bg-gray-600"
                >
                  {{ translate({ de: 'Deaktivieren', en: 'Deactivate' }) }}
                </button>
              </div>
            </div>
          </div>
          
          <div>
            <h3 class="font-semibold text-lg mb-2">{{ translate({ de: 'Errungenschaften', en: 'Achievements' }) }}</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
              <div v-for="achievement in achievements" :key="achievement.id" 
                   class="p-3 rounded-lg"
                   :class="[
                     achievement.unlocked 
                       ? (darkMode ? 'bg-green-800 bg-opacity-30' : 'bg-green-100') 
                       : (darkMode ? 'bg-gray-700 opacity-70' : 'bg-gray-100 opacity-70')
                   ]">
                <div class="flex items-center">
                  <div class="mr-3 text-2xl" v-if="achievement.unlocked">🏆</div>
                  <div class="mr-3 text-2xl" v-else>🔒</div>
                  <div>
                    <h4 class="font-semibold">{{ achievement.title }}</h4>
                    <p class="text-sm mt-1">{{ achievement.description }}</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Discovery Details Modal -->
    <div v-if="selectedDiscovery" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-4">
        <div class="p-6">
          <div class="flex justify-between items-center mb-4">
            <div class="flex items-center">
              <div class="w-12 h-12 flex items-center justify-center rounded-lg mr-4" :class="getElementClass(selectedDiscovery)">
                <span class="text-xl font-bold">{{ selectedDiscovery.symbol }}</span>
              </div>
              <h2 class="text-xl font-bold">{{ selectedDiscovery.name }}</h2>
            </div>
            <button @click="selectedDiscovery = null" class="text-gray-500 hover:text-gray-700">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
          </div>
          
          <div class="mb-4">
            <div class="grid grid-cols-2 gap-4 mb-4">
              <div>
                <h3 class="text-sm font-semibold opacity-70">{{ translate({ de: 'Kategorie', en: 'Category' }) }}</h3>
                <p>{{ translateCategory(selectedDiscovery.category) }}</p>
              </div>
              <div v-if="selectedDiscovery.formula">
                <h3 class="text-sm font-semibold opacity-70">{{ translate({ de: 'Formel', en: 'Formula' }) }}</h3>
                <p>{{ selectedDiscovery.formula }}</p>
              </div>
              <div v-if="selectedDiscovery.state">
                <h3 class="text-sm font-semibold opacity-70">{{ translate({ de: 'Zustand', en: 'State' }) }}</h3>
                <p>{{ translateState(selectedDiscovery.state) }}</p>
              </div>
              <div v-if="selectedDiscovery.meltingPoint">
                <h3 class="text-sm font-semibold opacity-70">{{ translate({ de: 'Schmelzpunkt', en: 'Melting Point' }) }}</h3>
                <p>{{ selectedDiscovery.meltingPoint }}°C</p>
              </div>
              <div v-if="selectedDiscovery.boilingPoint">
                <h3 class="text-sm font-semibold opacity-70">{{ translate({ de: 'Siedepunkt', en: 'Boiling Point' }) }}</h3>
                <p>{{ selectedDiscovery.boilingPoint }}°C</p>
              </div>
            </div>
            
            <div class="mb-4">
              <h3 class="text-sm font-semibold opacity-70">{{ translate({ de: 'Beschreibung', en: 'Description' }) }}</h3>
              <p>{{ selectedDiscovery.description }}</p>
            </div>
            
            <div v-if="getDiscoveryRecipe(selectedDiscovery)" class="mb-4">
              <h3 class="text-sm font-semibold opacity-70">{{ translate({ de: 'Herstellung', en: 'Creation' }) }}</h3>
              <div class="mt-1 p-3 rounded-lg" :class="darkMode ? 'bg-gray-700' : 'bg-gray-100'">
                <div class="flex flex-wrap items-center">
                  <template v-for="(inputId, idx) in getDiscoveryRecipe(selectedDiscovery).inputs">
                    <div v-if="idx > 0" class="mx-2">+</div>
                    <div class="element py-1 px-2 rounded-md text-center" :class="getElementClassById(inputId)">
                      {{ getElementSymbolById(inputId) }}
                    </div>
                  </template>
                  <div class="mx-2">→</div>
                  <div class="element py-1 px-2 rounded-md text-center" :class="getElementClass(selectedDiscovery)">
                    {{ selectedDiscovery.symbol }}
                  </div>
                </div>
                <div v-if="getDiscoveryRecipe(selectedDiscovery).requiredEquipment" class="mt-2 text-sm">
                  {{ translate({ de: 'Benötigte Ausrüstung', en: 'Required Equipment' }) }}: 
                  {{ getDiscoveryRecipe(selectedDiscovery).requiredEquipment.map(eq => getEquipmentNameById(eq)).join(', ') }}
                </div>
                <div v-if="getDiscoveryRecipe(selectedDiscovery).requiredTemperature" class="mt-1 text-sm">
                  {{ translate({ de: 'Benötigte Temperatur', en: 'Required Temperature' }) }}:
                  {{ getDiscoveryRecipe(selectedDiscovery).requiredTemperature.min }} - 
                  {{ getDiscoveryRecipe(selectedDiscovery).requiredTemperature.max }}°C
                </div>
              </div>
            </div>
            
            <div v-if="getRelatedDiscoveries(selectedDiscovery).length > 0" class="mb-4">
              <h3 class="text-sm font-semibold opacity-70">{{ translate({ de: 'Verwandte Entdeckungen', en: 'Related Discoveries' }) }}</h3>
              <div class="flex flex-wrap gap-2 mt-1">
                <div v-for="item in getRelatedDiscoveries(selectedDiscovery)" :key="item.id"
                     class="element py-1 px-2 rounded-md text-center cursor-pointer"
                     :class="getElementClass(item)"
                     @click="showDiscoveryDetails(item)">
                  {{ item.symbol }}
                </div>
              </div>
            </div>
          </div>
          
          <div class="flex space-x-3">
            <button 
              @click="addToWorkspace(selectedDiscovery); selectedDiscovery = null" 
              class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"
            >
              {{ translate({ de: 'Zum Arbeitsbereich hinzufügen', en: 'Add to Workspace' }) }}
            </button>
            <button 
              @click="selectedDiscovery = null" 
              class="px-4 py-2 bg-gray-300 dark:bg-gray-700 rounded hover:bg-gray-400 dark:hover:bg-gray-600"
            >
              {{ translate({ de: 'Schließen', en: 'Close' }) }}
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Encyclopedia Topic Modal -->
    <div v-if="selectedTopic" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-3xl w-full mx-4 max-h-[90vh] overflow-y-auto">
        <div class="p-6">
          <div class="flex justify-between items-start mb-4">
            <h2 class="text-xl font-bold">{{ selectedTopic.title }}</h2>
            <button @click="selectedTopic = null" class="text-gray-500 hover:text-gray-700">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
          </div>
          
          <div class="prose dark:prose-invert max-w-none">
            <div v-html="selectedTopic.content"></div>
          </div>
          
          <div v-if="selectedTopic.relatedElements && selectedTopic.relatedElements.length > 0" class="mt-6">
            <h3 class="text-lg font-semibold mb-2">{{ translate({ de: 'Verwandte Elemente', en: 'Related Elements' }) }}</h3>
            <div class="flex flex-wrap gap-2">
              <div v-for="elementId in selectedTopic.relatedElements" :key="elementId"
                   class="element py-1 px-2 rounded-md text-center cursor-pointer"
                   :class="getElementClassById(elementId)"
                   @click="addElementToWorkspace(elementId)">
                {{ getElementSymbolById(elementId) }}
              </div>
            </div>
          </div>
          
          <div class="flex justify-end mt-6">
            <button 
              @click="selectedTopic = null" 
              class="px-4 py-2 bg-gray-300 dark:bg-gray-700 rounded hover:bg-gray-400 dark:hover:bg-gray-600"
            >
              {{ translate({ de: 'Schließen', en: 'Close' }) }}
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Reaction Animation -->
    <div v-if="showReactionAnimation" class="reaction-animation">
      <div class="text-center">
        <div class="text-4xl mb-4" :class="{'bouncing': reactionResult.success, 'rotating': !reactionResult.success}">
          {{ reactionResult.symbol || '⚗️' }}
        </div>
        <h3 class="text-xl font-bold text-white mb-2">{{ reactionResult.title }}</h3>
        <p class="text-white mb-4">{{ reactionResult.message }}</p>
        <button 
          @click="showReactionAnimation = false" 
          class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"
        >
          {{ translate({ de: 'Fortfahren', en: 'Continue' }) }}
        </button>
      </div>
    </div>
  </div>

  <script>
    function translate(translations) {
      const language = localStorage.getItem('elementcraft-language') || 'de';
      return translations[language] || translations['en'] || 'Translation missing';
    }
    
    const { createApp, ref, computed, onMounted, watch } = Vue;
    
    createApp({
      setup() {
        // Game state
        const darkMode = ref(localStorage.getItem('elementcraft-dark-mode') === 'true');
        const currentLanguage = ref(localStorage.getItem('elementcraft-language') || 'de');
        const workspace = ref([]);
        const discoveredItems = ref([]);
        const newlyDiscovered = ref([]);
        const notifications = ref([]);
        const showWelcome = ref(true);
        const showHelpModal = ref(false);
        const showMissionsModal = ref(false);
        const playerLevel = ref(1);
        const currentLevelProgress = ref(0);
        const currentLevelTarget = computed(() => playerLevel.value * 5);
        const activeEquipment = ref([]);
        const temperature = ref(25); // Default room temperature
        const maxTemperature = ref(1000); // Maximum possible temperature
        const activeTab = ref('lab');
        const selectedDiscovery = ref(null);
        const selectedElement = ref(null);
        const selectedTopic = ref(null);
        const currentPage = ref(1);
        const itemsPerPage = ref(15);
        const discoveryFilter = ref('all');
        const searchQuery = ref('');
        const encyclopediaActiveCategory = ref('basics');
        const activeMission = ref(null);
        const tutorialActive = ref(false);
        const tutorialStepIndex = ref(0);
        const showReactionAnimation = ref(false);
        const reactionResult = ref({});
        
        // Tabs for the main interface
        const tabs = [
          { 
            id: 'lab', 
            name: translate({ de: 'Labor', en: 'Laboratory' }),
            icon: {
              template: '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z" /></svg>'
            }
          },
          { 
            id: 'elements', 
            name: translate({ de: 'Periodensystem', en: 'Periodic Table' }),
            icon: {
              template: '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z" /></svg>'
            }
          },
          { 
            id: 'discoveries', 
            name: translate({ de: 'Entdeckungen', en: 'Discoveries' }),
            icon: {
              template: '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>'
            }
          },
          { 
            id: 'encyclopedia', 
            name: translate({ de: 'Enzyklopädie', en: 'Encyclopedia' }),
            icon: {
              template: '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" /></svg>'
            }
          }
        ];
        
        // Tutorial steps
        const tutorialSteps = [
          {
            title: translate({ de: 'Willkommen bei ElementCraft!', en: 'Welcome to ElementCraft!' }),
            content: translate({ de: 'In diesem Spiel wirst du die faszinierende Welt der Chemie entdecken. Kombiniere Elemente, entdecke Verbindungen und lerne wissenschaftliche Konzepte. Lass uns beginnen!', en: 'In this game, you will discover the fascinating world of chemistry. Combine elements, discover compounds, and learn scientific concepts. Let\'s get started!' })
          },
          {
            title: translate({ de: 'Grundelemente', en: 'Basic Elements' }),
            content: translate({ de: 'Hier siehst du die Grundelemente. Klicke auf eines, um es zum Arbeitsbereich hinzuzufügen, oder ziehe es per Drag & Drop dorthin.', en: 'Here you can see the basic elements. Click on one to add it to the workspace, or drag and drop it there.' })
          },
          {
            title: translate({ de: 'Laborgeräte', en: 'Laboratory Equipment' }),
            content: translate({ de: 'Diese Laborgeräte ermöglichen dir spezielle Reaktionen. Ein Bunsenbrenner wird für Reaktionen mit hoher Temperatur benötigt, ein Reagenzglas für bestimmte Mischungen.', en: 'These laboratory tools enable special reactions. A Bunsen burner is needed for high-temperature reactions, a test tube for certain mixtures.' })
          },
          {
            title: translate({ de: 'Entdeckungen', en: 'Discoveries' }),
            content: translate({ de: 'Hier werden alle deine Entdeckungen angezeigt. Du kannst sie filtern und nach ihnen suchen. Entdecke neue Verbindungen, um diese Liste zu erweitern!', en: 'All your discoveries will be displayed here. You can filter and search them. Discover new compounds to expand this list!' })
          },
          {
            title: translate({ de: 'Missionen', en: 'Missions' }),
            content: translate({ de: 'Missionen geben dir Ziele und belohnen dich für Fortschritte. Schließe sie ab, um neue Elemente und Geräte freizuschalten!', en: 'Missions give you goals and reward you for progress. Complete them to unlock new elements and equipment!' })
          },
          {
            title: translate({ de: 'Enzyklopädie', en: 'Encyclopedia' }),
            content: translate({ de: 'Die Enzyklopädie enthält wertvolles Wissen über Chemie und Physik. Nutze sie, um mehr über Elemente, Verbindungen und wissenschaftliche Konzepte zu lernen.', en: 'The encyclopedia contains valuable knowledge about chemistry and physics. Use it to learn more about elements, compounds, and scientific concepts.' })
          },
          {
            title: translate({ de: 'Du bist bereit!', en: 'You\'re ready!' }),
            content: translate({ de: 'Du kennst jetzt die Grundlagen. Experimentiere, entdecke und hab Spaß beim Lernen! Schau dir das Hilfemenü an, wenn du weitere Informationen benötigst.', en: 'You now know the basics. Experiment, discover, and have fun learning! Check the help menu if you need more information.' })
          }
        ];
        
        // Current tutorial step
        const currentTutorialStep = computed(() => {
          return tutorialSteps[tutorialStepIndex.value];
        });
        
        // Start the tutorial
        function startTutorial() {
          tutorialActive.value = true;
          tutorialStepIndex.value = 0;
          showWelcome.value = false;
          activeTab.value = 'lab'; // Make sure we're on the lab tab
        }
        
        // Skip the tutorial
        function skipTutorial() {
          tutorialActive.value = false;
          localStorage.setItem('elementcraft-tutorial-completed', 'true');
        }
        
        // Move to the next tutorial step
        function nextTutorialStep() {
          if (tutorialStepIndex.value < tutorialSteps.length - 1) {
            tutorialStepIndex.value++;
            
            // Change tab based on tutorial step
            if (tutorialStepIndex.value === 3) {
              activeTab.value = 'discoveries';
            } else if (tutorialStepIndex.value === 4) {
              activeTab.value = 'lab';
              openMissionsModal();
            } else if (tutorialStepIndex.value === 5) {
              showMissionsModal.value = false;
              activeTab.value = 'encyclopedia';
            } else if (tutorialStepIndex.value === 6) {
              activeTab.value = 'lab';
            }
          } else {
            tutorialActive.value = false;
            localStorage.setItem('elementcraft-tutorial-completed', 'true');
          }
        }
        
        // Move to the previous tutorial step
        function prevTutorialStep() {
          if (tutorialStepIndex.value > 0) {
            tutorialStepIndex.value--;
            
            // Change tab based on tutorial step
            if (tutorialStepIndex.value === 0) {
              activeTab.value = 'lab';
            } else if (tutorialStepIndex.value === 2) {
              activeTab.value = 'lab';
              showMissionsModal.value = false;
            } else if (tutorialStepIndex.value === 3) {
              activeTab.value = 'discoveries';
            } else if (tutorialStepIndex.value === 4) {
              activeTab.value = 'lab';
              openMissionsModal();
            } else if (tutorialStepIndex.value === 5) {
              activeTab.value = 'encyclopedia';
            }
          }
        }
        
        // Encyclopedia categories
        const encyclopediaCategories = [
          {
            id: 'basics',
            name: translate({ de: 'Grundlagen der Chemie', en: 'Chemistry Basics' }),
            description: translate({ de: 'Einführung in die grundlegenden chemischen Konzepte und Prinzipien.', en: 'Introduction to basic chemical concepts and principles.' })
          },
          {
            id: 'periodic',
            name: translate({ de: 'Periodensystem', en: 'Periodic Table' }),
            description: translate({ de: 'Informationen über das Periodensystem der Elemente und seine Struktur.', en: 'Information about the periodic table of elements and its structure.' })
          },
          {
            id: 'reactions',
            name: translate({ de: 'Chemische Reaktionen', en: 'Chemical Reactions' }),
            description: translate({ de: 'Erklärungen zu verschiedenen Arten von chemischen Reaktionen.', en: 'Explanations of different types of chemical reactions.' })
          },
          {
            id: 'physics',
            name: translate({ de: 'Physikalische Konzepte', en: 'Physics Concepts' }),
            description: translate({ de: 'Grundlegende physikalische Prinzipien, die mit Chemie zusammenhängen.', en: 'Basic physical principles related to chemistry.' })
          },
          {
            id: 'laboratory',
            name: translate({ de: 'Laborausrüstung', en: 'Laboratory Equipment' }),
            description: translate({ de: 'Informationen über verschiedene Laborgeräte und ihre Anwendungen.', en: 'Information about various laboratory equipment and their applications.' })
          }
        ];
        
        // Encyclopedia content
        const encyclopediaContent = [
          {
            id: 'atoms',
            categoryId: 'basics',
            title: translate({ de: 'Atome und Moleküle', en: 'Atoms and Molecules' }),
            preview: translate({ de: 'Die grundlegenden Bausteine der Materie und wie sie sich zu Molekülen verbinden.', en: 'The basic building blocks of matter and how they combine to form molecules.' }),
            content: `
              <h3>${translate({ de: 'Aufbau von Atomen', en: 'Structure of Atoms' })}</h3>
              <p>${translate({ de: 'Atome bestehen aus einem Kern aus Protonen und Neutronen, um den Elektronen kreisen. Die Anzahl der Protonen bestimmt, um welches Element es sich handelt.', en: 'Atoms consist of a nucleus of protons and neutrons, around which electrons orbit. The number of protons determines which element it is.' })}</p>
              
              <h3>${translate({ de: 'Moleküle', en: 'Molecules' })}</h3>
              <p>${translate({ de: 'Moleküle entstehen, wenn zwei oder mehr Atome durch chemische Bindungen verbunden werden. Die Art der Bindung hängt von den beteiligten Elementen ab.', en: 'Molecules form when two or more atoms join together through chemical bonds. The type of bond depends on the elements involved.' })}</p>
              
              <h3>${translate({ de: 'Chemische Bindungen', en: 'Chemical Bonds' })}</h3>
              <ul>
                <li><strong>${translate({ de: 'Ionenbindung', en: 'Ionic Bond' })}</strong>: ${translate({ de: 'Entsteht durch Elektronenübertragung zwischen Metallen und Nichtmetallen.', en: 'Forms through electron transfer between metals and non-metals.' })}</li>
                <li><strong>${translate({ de: 'Kovalente Bindung', en: 'Covalent Bond' })}</strong>: ${translate({ de: 'Atome teilen Elektronen, um eine stabile Elektronenkonfiguration zu erreichen.', en: 'Atoms share electrons to achieve a stable electron configuration.' })}</li>
                <li><strong>${translate({ de: 'Metallische Bindung', en: 'Metallic Bond' })}</strong>: ${translate({ de: 'Positive Metallionen in einem "Meer" aus delokalisierten Elektronen.', en: 'Positive metal ions in a "sea" of delocalized electrons.' })}</li>
              </ul>
            `,
            relatedElements: ['H', 'O', 'C', 'N']
          },
          {
            id: 'periodic-system',
            categoryId: 'periodic',
            title: translate({ de: 'Das Periodensystem der Elemente', en: 'The Periodic Table of Elements' }),
            preview: translate({ de: 'Die Organisation und Struktur des Periodensystems und seine Bedeutung in der Chemie.', en: 'The organization and structure of the periodic table and its significance in chemistry.' }),
            content: `
              <h3>${translate({ de: 'Geschichte des Periodensystems', en: 'History of the Periodic Table' })}</h3>
              <p>${translate({ de: 'Das Periodensystem wurde 1869 von Dmitri Mendelejew entwickelt. Er ordnete die Elemente nach steigender Atommasse an und erkannte Muster in ihren Eigenschaften.', en: 'The periodic table was developed in 1869 by Dmitri Mendeleev. He arranged elements by increasing atomic mass and recognized patterns in their properties.' })}</p>
              
              <h3>${translate({ de: 'Struktur', en: 'Structure' })}</h3>
              <p>${translate({ de: 'Das moderne Periodensystem ordnet Elemente nach steigender Ordnungszahl (Anzahl der Protonen) an. Elemente in der gleichen Gruppe (Spalte) haben ähnliche chemische Eigenschaften.', en: 'The modern periodic table arranges elements by increasing atomic number (number of protons). Elements in the same group (column) have similar chemical properties.' })}</p>
              
              <h3>${translate({ de: 'Perioden und Gruppen', en: 'Periods and Groups' })}</h3>
              <ul>
                <li><strong>${translate({ de: 'Perioden', en: 'Periods' })}</strong>: ${translate({ de: 'Horizontale Reihen; Elemente in derselben Periode haben die gleiche Anzahl von Elektronenschalen.', en: 'Horizontal rows; elements in the same period have the same number of electron shells.' })}</li>
                <li><strong>${translate({ de: 'Gruppen', en: 'Groups' })}</strong>: ${translate({ de: 'Vertikale Spalten; Elemente in derselben Gruppe haben ähnliche Eigenschaften und die gleiche Anzahl von Valenzelektronen.', en: 'Vertical columns; elements in the same group have similar properties and the same number of valence electrons.' })}</li>
              </ul>
              
              <h3>${translate({ de: 'Elementkategorien', en: 'Element Categories' })}</h3>
              <ul>
                <li><strong>${translate({ de: 'Metalle', en: 'Metals' })}</strong>: ${translate({ de: 'Leiten Wärme und Elektrizität gut, sind formbar und glänzend.', en: 'Good conductors of heat and electricity, malleable, and shiny.' })}</li>
                <li><strong>${translate({ de: 'Nichtmetalle', en: 'Non-metals' })}</strong>: ${translate({ de: 'Schlechte Leiter, oft gasförmig oder spröde als Feststoffe.', en: 'Poor conductors, often gaseous or brittle as solids.' })}</li>
                <li><strong>${translate({ de: 'Halbmetalle', en: 'Metalloids' })}</strong>: ${translate({ de: 'Haben Eigenschaften zwischen Metallen und Nichtmetallen.', en: 'Have properties between metals and non-metals.' })}</li>
              </ul>
            `,
            relatedElements: ['H', 'He', 'Li', 'Be', 'Na', 'Mg']
          },
          {
            id: 'chemical-reactions',
            categoryId: 'reactions',
            title: translate({ de: 'Grundlegende chemische Reaktionen', en: 'Basic Chemical Reactions' }),
            preview: translate({ de: 'Die verschiedenen Arten von chemischen Reaktionen und wie sie ablaufen.', en: 'The different types of chemical reactions and how they occur.' }),
            content: `
              <h3>${translate({ de: 'Arten von Reaktionen', en: 'Types of Reactions' })}</h3>
              <ul>
                <li><strong>${translate({ de: 'Synthesereaktion', en: 'Synthesis Reaction' })}</strong>: A + B → AB<br>
                ${translate({ de: 'Zwei oder mehr Stoffe verbinden sich zu einem komplexeren Produkt.', en: 'Two or more substances combine to form a more complex product.' })}</li>
                
                <li><strong>${translate({ de: 'Zersetzungsreaktion', en: 'Decomposition Reaction' })}</strong>: AB → A + B<br>
                ${translate({ de: 'Ein Stoff zerfällt in einfachere Substanzen.', en: 'A substance breaks down into simpler substances.' })}</li>
                
                <li><strong>${translate({ de: 'Austauschreaktion', en: 'Single Replacement' })}</strong>: A + BC → AC + B<br>
                ${translate({ de: 'Ein Element ersetzt ein anderes in einer Verbindung.', en: 'One element replaces another in a compound.' })}</li>
                
                <li><strong>${translate({ de: 'Doppelte Austauschreaktion', en: 'Double Replacement' })}</strong>: AB + CD → AD + CB<br>
                ${translate({ de: 'Zwei Verbindungen tauschen ihre Komponenten aus.', en: 'Two compounds exchange their components.' })}</li>
                
                <li><strong>${translate({ de: 'Verbrennungsreaktion', en: 'Combustion Reaction' })}</strong>: ${translate({ de: 'Reaktion mit Sauerstoff, oft unter Freisetzung von Wärme und Licht.', en: 'Reaction with oxygen, often releasing heat and light.' })}</li>
              </ul>
              
              <h3>${translate({ de: 'Energieänderungen', en: 'Energy Changes' })}</h3>
              <ul>
                <li><strong>${translate({ de: 'Exotherme Reaktionen', en: 'Exothermic Reactions' })}</strong>: ${translate({ de: 'Geben Energie in Form von Wärme ab.', en: 'Release energy in the form of heat.' })}</li>
                <li><strong>${translate({ de: 'Endotherme Reaktionen', en: 'Endothermic Reactions' })}</strong>: ${translate({ de: 'Nehmen Energie auf, oft in Form von Wärme.', en: 'Absorb energy, often in the form of heat.' })}</li>
              </ul>
              
              <h3>${translate({ de: 'Reaktionsgeschwindigkeit', en: 'Reaction Rate' })}</h3>
              <p>${translate({ de: 'Die Geschwindigkeit einer Reaktion wird beeinflusst durch:', en: 'The speed of a reaction is influenced by:' })}</p>
              <ul>
                <li>${translate({ de: 'Temperatur', en: 'Temperature' })}</li>
                <li>${translate({ de: 'Konzentration', en: 'Concentration' })}</li>
                <li>${translate({ de: 'Oberfläche der Reaktanten', en: 'Surface area of reactants' })}</li>
                <li>${translate({ de: 'Katalysatoren', en: 'Catalysts' })}</li>
              </ul>
            `,
            relatedElements: ['O', 'H', 'C', 'Na', 'Cl']
          },
          {
            id: 'states-of-matter',
            categoryId: 'physics',
            title: translate({ de: 'Aggregatzustände', en: 'States of Matter' }),
            preview: translate({ de: 'Die verschiedenen Zustände, in denen Materie existieren kann, und die Übergänge zwischen ihnen.', en: 'The different states in which matter can exist and the transitions between them.' }),
            content: `
              <h3>${translate({ de: 'Hauptzustände der Materie', en: 'Main States of Matter' })}</h3>
              <ul>
                <li><strong>${translate({ de: 'Feststoff', en: 'Solid' })}</strong>: ${translate({ de: 'Feste Form, definiertes Volumen und definierte Form. Teilchen sind eng gepackt und vibrieren nur an festen Positionen.', en: 'Definite volume and shape. Particles are tightly packed and only vibrate in fixed positions.' })}</li>
                
                <li><strong>${translate({ de: 'Flüssigkeit', en: 'Liquid' })}</strong>: ${translate({ de: 'Definiertes Volumen, aber anpassbare Form. Teilchen können sich umeinander bewegen, bleiben aber in Kontakt.', en: 'Definite volume but adaptable shape. Particles can move around each other but remain in contact.' })}</li>
                
                <li><strong>${translate({ de: 'Gas', en: 'Gas' })}</strong>: ${translate({ de: 'Kein definiertes Volumen oder Form. Teilchen bewegen sich frei und schnell mit großen Abständen zueinander.', en: 'No definite volume or shape. Particles move freely and rapidly with large distances between them.' })}</li>
                
                <li><strong>${translate({ de: 'Plasma', en: 'Plasma' })}</strong>: ${translate({ de: 'Ionisiertes Gas mit freien Elektronen und positiv geladenen Ionen. Kommt in Sternen und Blitzen vor.', en: 'Ionized gas with free electrons and positively charged ions. Found in stars and lightning.' })}</li>
              </ul>
              
              <h3>${translate({ de: 'Phasenübergänge', en: 'Phase Transitions' })}</h3>
              <ul>
                <li><strong>${translate({ de: 'Schmelzen', en: 'Melting' })}</strong>: ${translate({ de: 'Übergang von fest zu flüssig durch Wärmezufuhr.', en: 'Transition from solid to liquid by adding heat.' })}</li>
                
                <li><strong>${translate({ de: 'Gefrieren', en: 'Freezing' })}</strong>: ${translate({ de: 'Übergang von flüssig zu fest durch Wärmeentzug.', en: 'Transition from liquid to solid by removing heat.' })}</li>
                
                <li><strong>${translate({ de: 'Verdampfen', en: 'Evaporation' })}</strong>: ${translate({ de: 'Übergang von flüssig zu gasförmig an der Oberfläche.', en: 'Transition from liquid to gas at the surface.' })}</li>
                
                <li><strong>${translate({ de: 'Sieden', en: 'Boiling' })}</strong>: ${translate({ de: 'Schnelle Verdampfung in der gesamten Flüssigkeit bei einer bestimmten Temperatur.', en: 'Rapid evaporation throughout the liquid at a specific temperature.' })}</li>
                
                <li><strong>${translate({ de: 'Kondensation', en: 'Condensation' })}</strong>: ${translate({ de: 'Übergang von gasförmig zu flüssig durch Wärmeentzug.', en: 'Transition from gas to liquid by removing heat.' })}</li>
                
                <li><strong>${translate({ de: 'Sublimation', en: 'Sublimation' })}</strong>: ${translate({ de: 'Direkter Übergang von fest zu gasförmig ohne flüssige Phase.', en: 'Direct transition from solid to gas without a liquid phase.' })}</li>
              </ul>
            `,
            relatedElements: ['H', 'O', 'N', 'He']
          },
          {
            id: 'lab-equipment',
            categoryId: 'laboratory',
            title: translate({ de: 'Laborgeräte und ihre Verwendung', en: 'Laboratory Equipment and Their Uses' }),
            preview: translate({ de: 'Eine Übersicht über die wichtigsten Laborgeräte in der Chemie und Physik.', en: 'An overview of essential laboratory equipment in chemistry and physics.' }),
            content: `
              <h3>${translate({ de: 'Grundlegende Laborgeräte', en: 'Basic Laboratory Equipment' })}</h3>
              
              <h4>${translate({ de: 'Behälter und Gefäße', en: 'Containers and Vessels' })}</h4>
              <ul>
                <li><strong>${translate({ de: 'Reagenzglas', en: 'Test Tube' })}</strong>: ${translate({ de: 'Schmales Glasrohr für kleine Experimente und zum Erhitzen kleiner Mengen von Substanzen.', en: 'Narrow glass tube for small experiments and heating small amounts of substances.' })}</li>
                
                <li><strong>${translate({ de: 'Becherglas', en: 'Beaker' })}</strong>: ${translate({ de: 'Zylindrisches Gefäß mit Ausguss zum Mischen und Erhitzen von Flüssigkeiten.', en: 'Cylindrical vessel with a spout for mixing and heating liquids.' })}</li>
                
                <li><strong>${translate({ de: 'Erlenmeyerkolben', en: 'Erlenmeyer Flask' })}</strong>: ${translate({ de: 'Kegelförmiger Kolben, der Spritzer reduziert und leicht zu schwenken ist.', en: 'Conical flask that reduces splashing and is easy to swirl.' })}</li>
                
                <li><strong>${translate({ de: 'Messkolben', en: 'Volumetric Flask' })}</strong>: ${translate({ de: 'Für präzise Volumenmessungen und Herstellung von Lösungen.', en: 'For precise volume measurements and preparation of solutions.' })}</li>
              </ul>
              
              <h4>${translate({ de: 'Heizgeräte', en: 'Heating Equipment' })}</h4>
              <ul>
                <li><strong>${translate({ de: 'Bunsenbrenner', en: 'Bunsen Burner' })}</strong>: ${translate({ de: 'Gasheizgerät für hohe Temperaturen mit regulierbarer Flamme.', en: 'Gas heating device for high temperatures with adjustable flame.' })}</li>
                
                <li><strong>${translate({ de: 'Heizplatte', en: 'Hot Plate' })}</strong>: ${translate({ de: 'Elektrische Heizfläche für kontrolliertes Erhitzen ohne offene Flamme.', en: 'Electric heating surface for controlled heating without open flame.' })}</li>
                
                <li><strong>${translate({ de: 'Wasserbad', en: 'Water Bath' })}</strong>: ${translate({ de: 'Für gleichmäßiges Erhitzen bei Temperaturen bis 100°C.', en: 'For uniform heating at temperatures up to 100°C.' })}</li>
              </ul>
              
              <h4>${translate({ de: 'Mess- und Wägegeräte', en: 'Measuring and Weighing Equipment' })}</h4>
              <ul>
                <li><strong>${translate({ de: 'Pipette', en: 'Pipette' })}</strong>: ${translate({ de: 'Zur präzisen Übertragung von Flüssigkeitsvolumen.', en: 'For precise transfer of liquid volumes.' })}</li>
                
                <li><strong>${translate({ de: 'Messzylinder', en: 'Graduated Cylinder' })}</strong>: ${translate({ de: 'Zur ungefähren Volumenmessung von Flüssigkeiten.', en: 'For approximate volume measurement of liquids.' })}</li>
                
                <li><strong>${translate({ de: 'Waage', en: 'Scale' })}</strong>: ${translate({ de: 'Zur genauen Massenbestimmung von Substanzen.', en: 'For accurate mass determination of substances.' })}</li>
                
                <li><strong>${translate({ de: 'Thermometer', en: 'Thermometer' })}</strong>: ${translate({ de: 'Zur Temperaturmessung.', en: 'For temperature measurement.' })}</li>
              </ul>
              
              <h4>${translate({ de: 'Trenngeräte', en: 'Separation Equipment' })}</h4>
              <ul>
                <li><strong>${translate({ de: 'Trichter', en: 'Funnel' })}</strong>: ${translate({ de: 'Zum Überführen von Flüssigkeiten und für Filtration.', en: 'For transferring liquids and for filtration.' })}</li>
                
                <li><strong>${translate({ de: 'Scheidetrichter', en: 'Separatory Funnel' })}</strong>: ${translate({ de: 'Zur Trennung nicht mischbarer Flüssigkeiten.', en: 'For separating immiscible liquids.' })}</li>
                
                <li><strong>${translate({ de: 'Destillationsapparat', en: 'Distillation Apparatus' })}</strong>: ${translate({ de: 'Zur Trennung von Flüssigkeiten basierend auf Siedepunkten.', en: 'For separating liquids based on boiling points.' })}</li>
              </ul>
            `,
            relatedElements: []
          }
        ];
        
        // Get encyclopedia topics for a specific category
        function getEncyclopediaTopics(categoryId) {
          return encyclopediaContent.filter(topic => topic.categoryId === categoryId);
        }
        
        // Show encyclopedia topic details
        function showEncyclopediaTopic(topic) {
          selectedTopic.value = topic;
        }
        
        // Pagination
        const totalPages = computed(() => {
          return Math.ceil(filteredDiscoveries.value.length / itemsPerPage.value);
        });
        
        const paginationPages = computed(() => {
          const pages = [];
          for (let i = 1; i <= totalPages.value; i++) {
            pages.push(i);
          }
          return pages;
        });
        
        // Filtered discoveries based on category and search query
        const filteredDiscoveries = computed(() => {
          let filtered = discoveredItems.value;
          
          // Apply category filter
          if (discoveryFilter.value !== 'all') {
            filtered = filtered.filter(item => item.category === discoveryFilter.value);
          }
          
          // Apply search filter
          if (searchQuery.value.trim() !== '') {
            const query = searchQuery.value.toLowerCase();
            filtered = filtered.filter(item => 
              item.name.toLowerCase().includes(query) || 
              item.description.toLowerCase().includes(query) ||
              item.symbol.toLowerCase().includes(query)
            );
          }
          
          // Sort items by category and name
          filtered = filtered.sort((a, b) => {
            if (a.category !== b.category) {
              const categoryOrder = { 'element': 1, 'molecule': 2, 'compound': 3, 'mixture': 4, 'reaction': 5 };
              return categoryOrder[a.category] - categoryOrder[b.category];
            }
            return a.name.localeCompare(b.name);
          });
          
          return filtered;
        });
        
        // Basic elements that are always available
        const basicElements = ref([
          { 
            id: 'H', 
            symbol: 'H', 
            name: translate({ de: 'Wasserstoff', en: 'Hydrogen' }), 
            category: 'element', 
            color: 'blue',
            atomicNumber: 1,
            atomicWeight: 1.008,
            phase: 'gas',
            description: translate({ de: 'Leichtestes Element, brennbar und sehr reaktiv.', en: 'Lightest element, flammable and highly reactive.' }),
            meltingPoint: -259.16,
            boilingPoint: -252.87
          },
          { 
            id: 'O', 
            symbol: 'O', 
            name: translate({ de: 'Sauerstoff', en: 'Oxygen' }), 
            category: 'element', 
            color: 'red',
            atomicNumber: 8,
            atomicWeight: 15.999,
            phase: 'gas',
            description: translate({ de: 'Unterstützt Verbrennung, notwendig für Atmung.', en: 'Supports combustion, necessary for respiration.' }),
            meltingPoint: -218.79,
            boilingPoint: -182.95
          },
          { 
            id: 'C', 
            symbol: 'C', 
            name: translate({ de: 'Kohlenstoff', en: 'Carbon' }), 
            category: 'element', 
            color: 'gray',
            atomicNumber: 6,
            atomicWeight: 12.011,
            phase: 'solid',
            description: translate({ de: 'Grundlage organischer Verbindungen, kommt in verschiedenen Allotropen vor.', en: 'Basis of organic compounds, exists in various allotropes.' }),
            meltingPoint: 3550,
            boilingPoint: 4027
          },
          { 
            id: 'N', 
            symbol: 'N', 
            name: translate({ de: 'Stickstoff', en: 'Nitrogen' }), 
            category: 'element', 
            color: 'green',
            atomicNumber: 7,
            atomicWeight: 14.007,
            phase: 'gas',
            description: translate({ de: 'Hauptbestandteil der Erdatmosphäre, wichtig für Proteine.', en: 'Main component of Earth\'s atmosphere, important for proteins.' }),
            meltingPoint: -210.0,
            boilingPoint: -195.8
          },
          { 
            id: 'Na', 
            symbol: 'Na', 
            name: translate({ de: 'Natrium', en: 'Sodium' }), 
            category: 'element', 
            color: 'purple',
            atomicNumber: 11,
            atomicWeight: 22.990,
            phase: 'solid',
            description: translate({ de: 'Silbrig-weißes, weiches Alkalimetall, reagiert heftig mit Wasser.', en: 'Silvery-white, soft alkali metal, reacts vigorously with water.' }),
            meltingPoint: 97.79,
            boilingPoint: 882.9
          },
          { 
            id: 'Cl', 
            symbol: 'Cl', 
            name: translate({ de: 'Chlor', en: 'Chlorine' }), 
            category: 'element', 
            color: 'yellow',
            atomicNumber: 17,
            atomicWeight: 35.45,
            phase: 'gas',
            description: translate({ de: 'Gelblich-grünes Gas, stark oxidierend, wird zur Wasseraufbereitung verwendet.', en: 'Yellowish-green gas, strongly oxidizing, used for water treatment.' }),
            meltingPoint: -101.5,
            boilingPoint: -34.04
          },
          { 
            id: 'Fe', 
            symbol: 'Fe', 
            name: translate({ de: 'Eisen', en: 'Iron' }), 
            category: 'element', 
            color: 'orange',
            atomicNumber: 26,
            atomicWeight: 55.845,
            phase: 'solid',
            description: translate({ de: 'Häufigstes Übergangselement, magnetisch, grundlegendes Metall für Industrie.', en: 'Most common transition element, magnetic, fundamental metal for industry.' }),
            meltingPoint: 1538,
            boilingPoint: 2862
          },
          { 
            id: 'S', 
            symbol: 'S', 
            name: translate({ de: 'Schwefel', en: 'Sulfur' }), 
            category: 'element', 
            color: 'yellow',
            atomicNumber: 16,
            atomicWeight: 32.06,
            phase: 'solid',
            description: translate({ de: 'Gelber, spröder Nichtmetall mit charakteristischem Geruch.', en: 'Yellow, brittle non-metal with a characteristic odor.' }),
            meltingPoint: 115.21,
            boilingPoint: 444.61
          }
        ]);
        
        // Additional elements to be discovered
        const advancedElements = ref([
          { 
            id: 'Cu', 
            symbol: 'Cu', 
            name: translate({ de: 'Kupfer', en: 'Copper' }), 
            category: 'element', 
            color: 'brown',
            atomicNumber: 29,
            atomicWeight: 63.546,
            phase: 'solid',
            description: translate({ de: 'Rötliches Metall, guter Leiter für Wärme und Elektrizität.', en: 'Reddish metal, good conductor of heat and electricity.' }),
            meltingPoint: 1084.62,
            boilingPoint: 2562
          },
          { 
            id: 'Ag', 
            symbol: 'Ag', 
            name: translate({ de: 'Silber', en: 'Silver' }), 
            category: 'element', 
            color: 'silver',
            atomicNumber: 47,
            atomicWeight: 107.868,
            phase: 'solid',
            description: translate({ de: 'Glänzendes, weiches Edelmetall mit höchster elektrischer Leitfähigkeit.', en: 'Lustrous, soft precious metal with highest electrical conductivity.' }),
            meltingPoint: 961.78,
            boilingPoint: 2162
          },
          { 
            id: 'Au', 
            symbol: 'Au', 
            name: translate({ de: 'Gold', en: 'Gold' }), 
            category: 'element', 
            color: 'gold',
            atomicNumber: 79,
            atomicWeight: 196.967,
            phase: 'solid',
            description: translate({ de: 'Glänzendes, gelbes Edelmetall, sehr beständig gegen Korrosion.', en: 'Lustrous, yellow precious metal, highly resistant to corrosion.' }),
            meltingPoint: 1064.18,
            boilingPoint: 2856
          },
          { 
            id: 'Hg', 
            symbol: 'Hg', 
            name: translate({ de: 'Quecksilber', en: 'Mercury' }), 
            category: 'element', 
            color: 'silver',
            atomicNumber: 80,
            atomicWeight: 200.59,
            phase: 'liquid',
            description: translate({ de: 'Silbriges Metall, flüssig bei Raumtemperatur, giftig.', en: 'Silvery metal, liquid at room temperature, toxic.' }),
            meltingPoint: -38.83,
            boilingPoint: 356.73
          },
          { 
            id: 'He', 
            symbol: 'He', 
            name: translate({ de: 'Helium', en: 'Helium' }), 
            category: 'element', 
            color: 'yellow',
            atomicNumber: 2,
            atomicWeight: 4.0026,
            phase: 'gas',
            description: translate({ de: 'Leichtes, inertes Edelgas, bekannt für seinen Einsatz in Ballons.', en: 'Light, inert noble gas, known for its use in balloons.' }),
            meltingPoint: -272.2,
            boilingPoint: -268.93
          }
        ]);
        
        // Laboratory equipment
        const availableEquipment = ref([
          {
            id: 'bunsen_burner',
            symbol: '🔥',
            name: translate({ de: 'Bunsenbrenner', en: 'Bunsen Burner' }),
            category: 'equipment',
            color: 'red',
            description: translate({ de: 'Erzeugt eine heiße Flamme für Experimente, die hohe Temperaturen erfordern.', en: 'Creates a hot flame for experiments requiring high temperatures.' }),
            enables: [translate({ de: 'Erhitzen', en: 'Heating' }), translate({ de: 'Verbrennung', en: 'Combustion' })]
          },
          {
            id: 'test_tube',
            symbol: '🧪',
            name: translate({ de: 'Reagenzglas', en: 'Test Tube' }),
            category: 'equipment',
            color: 'blue',
            description: translate({ de: 'Schmaler Glasbehälter für kleine Experimente und Reaktionen.', en: 'Narrow glass container for small experiments and reactions.' }),
            enables: [translate({ de: 'Mischen', en: 'Mixing' }), translate({ de: 'Kleine Reaktionen', en: 'Small Reactions' })]
          },
          {
            id: 'beaker',
            symbol: '🧫',
            name: translate({ de: 'Becherglas', en: 'Beaker' }),
            category: 'equipment',
            color: 'cyan',
            description: translate({ de: 'Größerer Behälter für Flüssigkeiten und größere Reaktionen.', en: 'Larger container for liquids and bigger reactions.' }),
            enables: [translate({ de: 'Größere Mengen', en: 'Larger Volumes' }), translate({ de: 'Komplexe Mischungen', en: 'Complex Mixtures' })]
          },
          {
            id: 'scale',
            symbol: '⚖️',
            name: translate({ de: 'Waage', en: 'Scale' }),
            category: 'equipment',
            color: 'purple',
            description: translate({ de: 'Misst die Masse von Substanzen für präzise Experimente.', en: 'Measures the mass of substances for precise experiments.' }),
            enables: [translate({ de: 'Präzise Messungen', en: 'Precise Measurements' }), translate({ de: 'Stöchiometrie', en: 'Stoichiometry' })]
          },
          {
            id: 'filter',
            symbol: '🧻',
            name: translate({ de: 'Filter', en: 'Filter' }),
            category: 'equipment',
            color: 'white',
            description: translate({ de: 'Trennt Feststoffe von Flüssigkeiten durch Filtration.', en: 'Separates solids from liquids through filtration.' }),
            enables: [translate({ de: 'Filtration', en: 'Filtration' }), translate({ de: 'Trennung', en: 'Separation' })]
          }
        ]);
        
        // Special elements that are unlocked after discovering some items
        const specialElements = ref([
          { 
            id: 'electricity', 
            symbol: '⚡', 
            name: translate({ de: 'Elektrizität', en: 'Electricity' }), 
            category: 'energy', 
            color: 'yellow',
            description: translate({ de: 'Stromfluss durch Ladungsunterschiede, ermöglicht elektrochemische Reaktionen.', en: 'Flow of charge due to potential difference, enables electrochemical reactions.' }),
            unlockAt: 5  // Unlocks after discovering 5 items
          },
          {
            id: 'uv_light',
            symbol: '☀️',
            name: translate({ de: 'UV-Licht', en: 'UV Light' }),
            category: 'energy',
            color: 'purple',
            description: translate({ de: 'Elektromagnetische Strahlung, die photochemische Reaktionen auslösen kann.', en: 'Electromagnetic radiation that can trigger photochemical reactions.' }),
            unlockAt: 10  // Unlocks after discovering 10 items
          },
          {
            id: 'catalyst',
            symbol: '✨',
            name: translate({ de: 'Katalysator', en: 'Catalyst' }),
            category: 'special',
            color: 'green',
            description: translate({ de: 'Beschleunigt chemische Reaktionen, ohne selbst verbraucht zu werden.', en: 'Accelerates chemical reactions without being consumed.' }),
            unlockAt: 15  // Unlocks after discovering 15 items
          }
        ]);
        
        // All possible combinations/recipes in the game
        const recipes = ref([
          // Basic combinations
          {
            inputs: ['H', 'H', 'O'],
            output: {
              id: 'H2O',
              symbol: 'H₂O',
              name: translate({ de: 'Wasser', en: 'Water' }),
              description: translate({ de: 'Die grundlegende Verbindung des Lebens, Lösungsmittel für viele Reaktionen.', en: 'The fundamental compound of life, solvent for many reactions.' }),
              category: 'molecule',
              color: 'blue',
              formula: 'H₂O',
              state: 'liquid'
            }
          },
          {
            inputs: ['H', 'Cl'],
            output: {
              id: 'HCl',
              symbol: 'HCl',
              name: translate({ de: 'Salzsäure', en: 'Hydrochloric Acid' }),
              description: translate({ de: 'Eine starke Säure, die in der Industrie und im Magen vorkommt.', en: 'A strong acid found in industry and in the stomach.' }),
              category: 'molecule',
              color: 'yellow',
              formula: 'HCl',
              state: 'aqueous'
            }
          },
          {
            inputs: ['Na', 'Cl'],
            output: {
              id: 'NaCl',
              symbol: 'NaCl',
              name: translate({ de: 'Kochsalz', en: 'Table Salt' }),
              description: translate({ de: 'Grundlegendes Mineral für Leben und Kochen, Ionenverbindung.', en: 'Essential mineral for life and cooking, ionic compound.' }),
              category: 'compound',
              color: 'white',
              formula: 'NaCl',
              state: 'solid'
            }
          },
          {
            inputs: ['C', 'O', 'O'],
            output: {
              id: 'CO2',
              symbol: 'CO₂',
              name: translate({ de: 'Kohlendioxid', en: 'Carbon Dioxide' }),
              description: translate({ de: 'Gas in der Atmosphäre, Produkt der Verbrennung und Atmung.', en: 'Atmospheric gas, product of combustion and respiration.' }),
              category: 'molecule',
              color: 'gray',
              formula: 'CO₂',
              state: 'gas'
            }
          },
          {
            inputs: ['N', 'H', 'H', 'H'],
            output: {
              id: 'NH3',
              symbol: 'NH₃',
              name: translate({ de: 'Ammoniak', en: 'Ammonia' }),
              description: translate({ de: 'Stechend riechendes Gas, wichtig für Düngemittel.', en: 'Pungent-smelling gas, important for fertilizers.' }),
              category: 'molecule',
              color: 'green',
              formula: 'NH₃',
              state: 'gas'
            }
          },
          {
            inputs: ['H', 'H'],
            output: {
              id: 'H2',
              symbol: 'H₂',
              name: translate({ de: 'Wasserstoffgas', en: 'Hydrogen Gas' }),
              description: translate({ de: 'Leichtestes Element, brennbar und potenzieller Kraftstoff.', en: 'Lightest element, flammable and potential fuel.' }),
              category: 'molecule',
              color: 'blue',
              formula: 'H₂',
              state: 'gas'
            }
          },
          {
            inputs: ['O', 'O'],
            output: {
              id: 'O2',
              symbol: 'O₂',
              name: translate({ de: 'Sauerstoffgas', en: 'Oxygen Gas' }),
              description: translate({ de: 'Notwendig zum Atmen und für Verbrennungsreaktionen.', en: 'Necessary for breathing and combustion reactions.' }),
              category: 'molecule',
              color: 'red',
              formula: 'O₂',
              state: 'gas'
            }
          },
          
          // Reactions with water
          {
            inputs: ['H2O', 'CO2'],
            output: {
              id: 'H2CO3',
              symbol: 'H₂CO₃',
              name: translate({ de: 'Kohlensäure', en: 'Carbonic Acid' }),
              description: translate({ de: 'Macht Getränke sprudelnd, zerfällt leicht in Wasser und CO₂.', en: 'Makes drinks fizzy, easily decomposes into water and CO₂.' }),
              category: 'molecule',
              color: 'blue',
              formula: 'H₂CO₃',
              state: 'aqueous'
            }
          },
          {
            inputs: ['H2O', 'NaCl'],
            output: {
              id: 'saline',
              symbol: 'NaCl(aq)',
              name: translate({ de: 'Kochsalzlösung', en: 'Saline Solution' }),
              description: translate({ de: 'Salzwasser, wichtig für medizinische Anwendungen.', en: 'Salt water, important for medical applications.' }),
              category: 'mixture',
              color: 'blue',
              formula: 'NaCl(aq)',
              state: 'liquid'
            }
          },
          
          // Metal reactions
          {
            inputs: ['Fe', 'O2'],
            output: {
              id: 'Fe2O3',
              symbol: 'Fe₂O₃',
              name: translate({ de: 'Rost', en: 'Rust' }),
              description: translate({ de: 'Eisenoxid, Ergebnis der Oxidation von Eisen an feuchter Luft.', en: 'Iron oxide, result of iron oxidation in moist air.' }),
              category: 'compound',
              color: 'orange',
              formula: 'Fe₂O₃',
              state: 'solid'
            }
          },
          {
            inputs: ['Fe2O3', 'C'],
            requiredEquipment: ['bunsen_burner'],
            requiredTemperature: { min: 700, max: 1200 },
            output: {
              id: 'Fe_CO2',
              symbol: 'Fe+CO₂',
              name: translate({ de: 'Eisengewinnung', en: 'Iron Smelting' }),
              description: translate({ de: 'Metallurgischer Prozess zur Gewinnung von Eisen aus Erz.', en: 'Metallurgical process to extract iron from ore.' }),
              category: 'reaction',
              color: 'orange',
              formula: 'Fe₂O₃ + 3C → 2Fe + 3CO₂',
              state: 'solid'
            }
          },
          
          // Carbon compounds
          {
            inputs: ['C', 'H', 'H', 'H', 'H'],
            output: {
              id: 'CH4',
              symbol: 'CH₄',
              name: translate({ de: 'Methan', en: 'Methane' }),
              description: translate({ de: 'Einfachster Kohlenwasserstoff, Hauptbestandteil von Erdgas.', en: 'Simplest hydrocarbon, main component of natural gas.' }),
              category: 'molecule',
              color: 'gray',
              formula: 'CH₄',
              state: 'gas'
            }
          },
          {
            inputs: ['CH4', 'O2'],
            requiredEquipment: ['bunsen_burner'],
            output: {
              id: 'combustion',
              symbol: '🔥',
              name: translate({ de: 'Verbrennung', en: 'Combustion' }),
              description: translate({ de: 'Exotherme Reaktion mit Sauerstoff, erzeugt Wärme und Licht.', en: 'Exothermic reaction with oxygen, produces heat and light.' }),
              category: 'reaction',
              color: 'red',
              formula: 'CH₄ + 2O₂ → CO₂ + 2H₂O + Energie',
              state: 'gas'
            }
          },
          {
            inputs: ['C', 'H', 'H', 'O', 'H'],
            output: {
              id: 'CH3OH',
              symbol: 'CH₃OH',
              name: translate({ de: 'Methanol', en: 'Methanol' }),
              description: translate({ de: 'Einfacher Alkohol, giftig, wird als Lösungsmittel verwendet.', en: 'Simple alcohol, toxic, used as a solvent.' }),
              category: 'molecule',
              color: 'indigo',
              formula: 'CH₃OH',
              state: 'liquid'
            }
          },
          
          // Acid-base reactions
          {
            inputs: ['Na', 'O', 'H'],
            output: {
              id: 'NaOH',
              symbol: 'NaOH',
              name: translate({ de: 'Natronlauge', en: 'Sodium Hydroxide' }),
              description: translate({ de: 'Starke Base, ätzend, wird in Reinigungsmitteln verwendet.', en: 'Strong base, caustic, used in cleaning products.' }),
              category: 'compound',
              color: 'purple',
              formula: 'NaOH',
              state: 'solid'
            }
          },
          {
            inputs: ['NaOH', 'HCl'],
            requiredEquipment: ['test_tube'],
            output: {
              id: 'NaCl_H2O',
              symbol: 'NaCl+H₂O',
              name: translate({ de: 'Neutralisation', en: 'Neutralization' }),
              description: translate({ de: 'Säure-Base-Reaktion, erzeugt Salz und Wasser.', en: 'Acid-base reaction, produces salt and water.' }),
              category: 'reaction',
              color: 'blue',
              formula: 'NaOH + HCl → NaCl + H₂O',
              state: 'aqueous'
            }
          },
          
          // Oxidation reactions
          {
            inputs: ['H', 'O', 'H', 'O'],
            output: {
              id: 'H2O2',
              symbol: 'H₂O₂',
              name: translate({ de: 'Wasserstoffperoxid', en: 'Hydrogen Peroxide' }),
              description: translate({ de: 'Oxidationsmittel, Bleichmittel, zerfällt zu Wasser und Sauerstoff.', en: 'Oxidizing agent, bleach, decomposes to water and oxygen.' }),
              category: 'molecule',
              color: 'cyan',
              formula: 'H₂O₂',
              state: 'liquid'
            }
          },
          {
            inputs: ['S', 'O', 'O'],
            output: {
              id: 'SO2',
              symbol: 'SO₂',
              name: translate({ de: 'Schwefeldioxid', en: 'Sulfur Dioxide' }),
              description: translate({ de: 'Reizgas, entsteht bei Verbrennung schwefelhaltiger Brennstoffe.', en: 'Irritant gas, produced by burning sulfur-containing fuels.' }),
              category: 'molecule',
              color: 'yellow',
              formula: 'SO₂',
              state: 'gas'
            }
          },
          
          // Advanced reactions with equipment
          {
            inputs: ['H2O'],
            requiredEquipment: ['electricity'],
            output: {
              id: 'electrolysis',
              symbol: 'H₂+O₂',
              name: translate({ de: 'Elektrolyse', en: 'Electrolysis' }),
              description: translate({ de: 'Zerlegung durch Strom, spaltet Wasser in Wasserstoff und Sauerstoff.', en: 'Decomposition by electricity, splits water into hydrogen and oxygen.' }),
              category: 'reaction',
              color: 'blue',
              formula: '2H₂O → 2H₂ + O₂',
              state: 'gas'
            }
          },
          {
            inputs: ['NaCl'],
            requiredEquipment: ['electricity', 'beaker'],
            output: {
              id: 'NaCl_electrolysis',
              symbol: 'Na+Cl₂',
              name: translate({ de: 'Chlor-Alkali-Prozess', en: 'Chlor-Alkali Process' }),
              description: translate({ de: 'Elektrolyse von Salzlösung, erzeugt Chlorgas und Natronlauge.', en: 'Electrolysis of salt solution, produces chlorine gas and sodium hydroxide.' }),
              category: 'reaction',
              color: 'green',
              formula: '2NaCl + 2H₂O → Cl₂ + 2NaOH + H₂',
              state: 'mixed'
            }
          },
          {
            inputs: ['Fe', 'C'],
            requiredEquipment: ['bunsen_burner'],
            requiredTemperature: { min: 800, max: 1200 },
            output: {
              id: 'steel',
              symbol: 'Fe-C',
              name: translate({ de: 'Stahl', en: 'Steel' }),
              description: translate({ de: 'Legierung aus Eisen und Kohlenstoff, härter und stärker als reines Eisen.', en: 'Alloy of iron and carbon, harder and stronger than pure iron.' }),
              category: 'compound',
              color: 'gray',
              formula: 'Fe + C',
              state: 'solid'
            }
          },
          
          // More advanced compounds
          {
            inputs: ['N', 'O'],
            output: {
              id: 'NO',
              symbol: 'NO',
              name: translate({ de: 'Stickstoffmonoxid', en: 'Nitric Oxide' }),
              description: translate({ de: 'Signalmolekül im Körper, wichtig für Blutgefäßerweiterung.', en: 'Signaling molecule in the body, important for blood vessel dilation.' }),
              category: 'molecule',
              color: 'green',
              formula: 'NO',
              state: 'gas'
            }
          },
          {
            inputs: ['NO', 'O2'],
            output: {
              id: 'NO2',
              symbol: 'NO₂',
              name: translate({ de: 'Stickstoffdioxid', en: 'Nitrogen Dioxide' }),
              description: translate({ de: 'Braunes Gas, Luftschadstoff, entsteht bei Verbrennungsprozessen.', en: 'Brown gas, air pollutant, produced in combustion processes.' }),
              category: 'molecule',
              color: 'brown',
              formula: 'NO₂',
              state: 'gas'
            }
          },
          {
            inputs: ['S', 'O', 'O', 'O'],
            output: {
              id: 'SO3',
              symbol: 'SO₃',
              name: translate({ de: 'Schwefeltrioxid', en: 'Sulfur Trioxide' }),
              description: translate({ de: 'Reaktives Gas, reagiert mit Wasser zu Schwefelsäure.', en: 'Reactive gas, reacts with water to form sulfuric acid.' }),
              category: 'molecule',
              color: 'yellow',
              formula: 'SO₃',
              state: 'gas'
            }
          },
          {
            inputs: ['SO3', 'H2O'],
            requiredEquipment: ['beaker'],
            output: {
              id: 'H2SO4',
              symbol: 'H₂SO₄',
              name: translate({ de: 'Schwefelsäure', en: 'Sulfuric Acid' }),
              description: translate({ de: 'Starke, korrosive Säure, wichtig in der Industrie.', en: 'Strong, corrosive acid, important in industry.' }),
              category: 'compound',
              color: 'yellow',
              formula: 'H₂SO₄',
              state: 'liquid'
            }
          },
          {
            inputs: ['N', 'H'],
            requiredEquipment: ['catalyst'],
            output: {
              id: 'HN3',
              symbol: 'HN₃',
              name: translate({ de: 'Stickstoffwasserstoffsäure', en: 'Hydrazoic Acid' }),
              description: translate({ de: 'Hochexplosive Verbindung, sehr instabil.', en: 'Highly explosive compound, very unstable.' }),
              category: 'molecule',
              color: 'purple',
              formula: 'HN₃',
              state: 'liquid'
            }
          },
          {
            inputs: ['C', 'O'],
            output: {
              id: 'CO',
              symbol: 'CO',
              name: translate({ de: 'Kohlenmonoxid', en: 'Carbon Monoxide' }),
              description: translate({ de: 'Farb- und geruchloses, giftiges Gas, bindet an Hämoglobin.', en: 'Colorless, odorless, toxic gas, binds to hemoglobin.' }),
              category: 'molecule',
              color: 'gray',
              formula: 'CO',
              state: 'gas'
            }
          },
          {
            inputs: ['H', 'F'],
            output: {
              id: 'HF',
              symbol: 'HF',
              name: translate({ de: 'Fluorwasserstoff', en: 'Hydrogen Fluoride' }),
              description: translate({ de: 'Stark korrosive Säure, ätzt Glas, sehr gefährlich.', en: 'Highly corrosive acid, etches glass, very dangerous.' }),
              category: 'molecule',
              color: 'green',
              formula: 'HF',
              state: 'gas'
            }
          }
        ]);
        
        // Missions
        const missions = ref([
          {
            id: 'mission1',
            title: translate({ de: 'Erste Schritte', en: 'First Steps' }),
            description: translate({ de: 'Entdecke die grundlegenden Moleküle Wasser (H₂O) und Wasserstoffgas (H₂).', en: 'Discover the basic molecules Water (H₂O) and Hydrogen Gas (H₂).' }),
            requirements: [
              { type: 'discover', id: 'H2O' },
              { type: 'discover', id: 'H2' }
            ],
            reward: translate({ de: 'Freischaltung des Bunsenbrenners', en: 'Unlocks the Bunsen Burner' }),
            completed: false,
            progress: 0,
            unlockLevel: 1
          },
          {
            id: 'mission2',
            title: translate({ de: 'Säuren und Basen', en: 'Acids and Bases' }),
            description: translate({ de: 'Erzeuge Salzsäure (HCl) und führe eine Neutralisationsreaktion durch.', en: 'Create Hydrochloric Acid (HCl) and perform a neutralization reaction.' }),
            requirements: [
              { type: 'discover', id: 'HCl' },
              { type: 'discover', id: 'NaOH' },
              { type: 'discover', id: 'NaCl_H2O' }
            ],
            reward: translate({ de: 'Freischaltung von Elektrizität', en: 'Unlocks Electricity' }),
            completed: false,
            progress: 0,
            unlockLevel: 2
          },
          {
            id: 'mission3',
            title: translate({ de: 'Kohlenstoffchemie', en: 'Carbon Chemistry' }),
            description: translate({ de: 'Entdecke verschiedene Kohlenstoffverbindungen: CO₂, CO und CH₄.', en: 'Discover various carbon compounds: CO₂, CO, and CH₄.' }),
            requirements: [
              { type: 'discover', id: 'CO2' },
              { type: 'discover', id: 'CO' },
              { type: 'discover', id: 'CH4' }
            ],
            reward: translate({ de: 'Freischaltung des UV-Lichts', en: 'Unlocks UV Light' }),
            completed: false,
            progress: 0,
            unlockLevel: 3
          },
          {
            id: 'mission4',
            title: translate({ de: 'Metallverarbeitung', en: 'Metal Processing' }),
            description: translate({ de: 'Erzeuge Rost und führe einen Schmelzprozess durch, um Stahl herzustellen.', en: 'Create rust and perform a smelting process to produce steel.' }),
            requirements: [
              { type: 'discover', id: 'Fe2O3' },
              { type: 'discover', id: 'Fe_CO2' },
              { type: 'discover', id: 'steel' }
            ],
            reward: translate({ de: 'Freischaltung fortgeschrittener Metalle: Cu, Ag, Au', en: 'Unlocks advanced metals: Cu, Ag, Au' }),
            completed: false,
            progress: 0,
            unlockLevel: 4
          },
          {
            id: 'mission5',
            title: translate({ de: 'Elektrolyse', en: 'Electrolysis' }),
            description: translate({ de: 'Führe Elektrolyse von Wasser und Salzlösung durch.', en: 'Perform electrolysis of water and salt solution.' }),
            requirements: [
              { type: 'discover', id: 'electrolysis' },
              { type: 'discover', id: 'NaCl_electrolysis' }
            ],
            reward: translate({ de: 'Freischaltung des Katalysators', en: 'Unlocks Catalyst' }),
            completed: false,
            progress: 0,
            unlockLevel: 5
          }
        ]);
        
        // Available missions based on level
        const availableMissions = computed(() => {
          return missions.value.filter(mission => mission.unlockLevel <= playerLevel.value);
        });
        
        // Achievements
        const achievements = ref([
          {
            id: 'achievement1',
            title: translate({ de: 'Chemiker in Ausbildung', en: 'Chemist in Training' }),
            description: translate({ de: 'Entdecke 5 verschiedene Verbindungen.', en: 'Discover 5 different compounds.' }),
            requirement: { type: 'discoveryCount', count: 5 },
            unlocked: false
          },
          {
            id: 'achievement2',
            title: translate({ de: 'Laborassistent', en: 'Lab Assistant' }),
            description: translate({ de: 'Schließe deine erste Mission ab.', en: 'Complete your first mission.' }),
            requirement: { type: 'missionCount', count: 1 },
            unlocked: false
          },
          {
            id: 'achievement3',
            title: translate({ de: 'Elementar, mein Lieber!', en: 'Elementary, My Dear!' }),
            description: translate({ de: 'Entdecke alle Grundelemente.', en: 'Discover all basic elements.' }),
            requirement: { type: 'elementCount', count: basicElements.value.length + advancedElements.value.length },
            unlocked: false
          },
          {
            id: 'achievement4',
            title: translate({ de: 'Meister der Mischungen', en: 'Master of Mixtures' }),
            description: translate({ de: 'Erzeuge 3 verschiedene Gemische.', en: 'Create 3 different mixtures.' }),
            requirement: { type: 'categoryCount', category: 'mixture', count: 3 },
            unlocked: false
          },
          {
            id: 'achievement5',
            title: translate({ de: 'Reaktionsexperte', en: 'Reaction Expert' }),
            description: translate({ de: 'Führe 5 verschiedene Reaktionen durch.', en: 'Perform 5 different reactions.' }),
            requirement: { type: 'categoryCount', category: 'reaction', count: 5 },
            unlocked: false
          },
          {
            id: 'achievement6',
            title: translate({ de: 'Alchemist', en: 'Alchemist' }),
            description: translate({ de: 'Erreiche Level 10.', en: 'Reach Level 10.' }),
            requirement: { type: 'level', level: 10 },
            unlocked: false
          }
        ]);
        
        // Total number of recipes that can be discovered
        const recipeCount = computed(() => {
          return recipes.value.length;
        });
        
        // Check achievements
        function checkAchievements() {
          achievements.value.forEach(achievement => {
            if (!achievement.unlocked) {
              let completed = false;
              
              if (achievement.requirement.type === 'discoveryCount') {
                completed = discoveredItems.value.length >= achievement.requirement.count;
              } else if (achievement.requirement.type === 'missionCount') {
                completed = missions.value.filter(m => m.completed).length >= achievement.requirement.count;
              } else if (achievement.requirement.type === 'elementCount') {
                const elements = discoveredItems.value.filter(item => item.category === 'element');
                completed = elements.length >= achievement.requirement.count;
              } else if (achievement.requirement.type === 'categoryCount') {
                const items = discoveredItems.value.filter(item => item.category === achievement.requirement.category);
                completed = items.length >= achievement.requirement.count;
              } else if (achievement.requirement.type === 'level') {
                completed = playerLevel.value >= achievement.requirement.level;
              }
              
              if (completed) {
                achievement.unlocked = true;
                addNotification(
                  translate({ de: 'Errungenschaft freigeschaltet!', en: 'Achievement Unlocked!' }),
                  achievement.title,
                  'achievement'
                );
              }
            }
          });
        }
        
        // Calculate mission progress
        function calculateMissionProgress(mission) {
          if (mission.completed) return 100;
          
          const totalRequirements = mission.requirements.length;
          const completedRequirements = mission.requirements.filter(req => {
            if (req.type === 'discover') {
              return discoveredItems.value.some(item => item.id === req.id);
            }
            return false;
          }).length;
          
          mission.progress = completedRequirements;
          return Math.round((completedRequirements / totalRequirements) * 100);
        }
        
        // Get mission progress text
        function getMissionProgressText(mission) {
          return `${mission.progress}/${mission.requirements.length}`;
        }
        
        // Check mission completion
        function checkMissions() {
          missions.value.forEach(mission => {
            if (!mission.completed) {
              const progress = calculateMissionProgress(mission);
              
              if (progress === 100) {
                mission.completed = true;
                
                // Apply rewards
                if (mission.id === 'mission1') {
                  // First mission unlocks bunsen burner, which should already be available
                } else if (mission.id === 'mission2') {
                  // Unlock electricity
                  if (!basicElements.value.some(e => e.id === 'electricity') && 
                      !discoveredItems.value.some(i => i.id === 'electricity')) {
                    discoveredItems.value.push({
                      id: 'electricity',
                      symbol: '⚡',
                      name: translate({ de: 'Elektrizität', en: 'Electricity' }),
                      category: 'energy',
                      color: 'yellow',
                      description: translate({ de: 'Stromfluss durch Ladungsunterschiede.', en: 'Flow of charge due to potential difference.' })
                    });
                  }
                } else if (mission.id === 'mission3') {
                  // Unlock UV light
                  if (!basicElements.value.some(e => e.id === 'uv_light') && 
                      !discoveredItems.value.some(i => i.id === 'uv_light')) {
                    discoveredItems.value.push({
                      id: 'uv_light',
                      symbol: '☀️',
                      name: translate({ de: 'UV-Licht', en: 'UV Light' }),
                      category: 'energy',
                      color: 'purple',
                      description: translate({ de: 'Elektromagnetische Strahlung.', en: 'Electromagnetic radiation.' })
                    });
                  }
                } else if (mission.id === 'mission4') {
                  // Unlock advanced metals
                  advancedElements.value
                    .filter(e => ['Cu', 'Ag', 'Au'].includes(e.id))
                    .forEach(metal => {
                      if (!discoveredItems.value.some(i => i.id === metal.id)) {
                        discoveredItems.value.push({
                          ...metal,
                          category: 'element'
                        });
                      }
                    });
                } else if (mission.id === 'mission5') {
                  // Unlock catalyst
                  if (!basicElements.value.some(e => e.id === 'catalyst') && 
                      !discoveredItems.value.some(i => i.id === 'catalyst')) {
                    discoveredItems.value.push({
                      id: 'catalyst',
                      symbol: '✨',
                      name: translate({ de: 'Katalysator', en: 'Catalyst' }),
                      category: 'special',
                      color: 'green',
                      description: translate({ de: 'Beschleunigt chemische Reaktionen.', en: 'Accelerates chemical reactions.' })
                    });
                  }
                }
                
                addNotification(
                  translate({ de: 'Mission abgeschlossen!', en: 'Mission Completed!' }),
                  mission.title,
                  'mission'
                );
                
                // Level up if needed
                playerLevel.value += 1;
                currentLevelProgress.value = 0;
                
                // Check if active mission was completed
                if (activeMission.value && activeMission.value.id === mission.id) {
                  activeMission.value = null;
                }
              }
            }
          });
        }
        
        // Select active mission
        function selectActiveMission(mission) {
          activeMission.value = mission;
          showMissionsModal.value = false;
        }
        
        // Open missions modal
        function openMissionsModal() {
          showMissionsModal.value = true;
        }
        
        // Open help modal
        function openHelpModal() {
          showHelpModal.value = true;
        }
        
        // Get element class for periodic table
        function getPeriodicElementClass(atomicNumber) {
          let category = '';
          
          // Simplified category determination based on atomic number
          if ([1, 2, 3, 4, 11, 12].includes(atomicNumber)) {
            category = 'metal'; // Actually H is non-metal, He is noble gas, but simplifying
          } else if ([5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 17, 18].includes(atomicNumber)) {
            category = 'nonmetal';
          }
          
          let discovered = basicElements.value.some(e => e.atomicNumber === atomicNumber) || 
                           discoveredItems.value.some(i => i.atomicNumber === atomicNumber);
          
          let baseClass = 'cursor-pointer';
          
          if (category === 'metal') {
            baseClass += darkMode.value 
              ? (discovered ? ' bg-blue-700' : ' bg-gray-700') 
              : (discovered ? ' bg-blue-200' : ' bg-gray-200');
          } else if (category === 'nonmetal') {
            baseClass += darkMode.value 
              ? (discovered ? ' bg-green-700' : ' bg-gray-700') 
              : (discovered ? ' bg-green-200' : ' bg-gray-200');
          } else {
            baseClass += darkMode.value ? ' bg-gray-700' : ' bg-gray-200';
          }
          
          return baseClass;
        }
        
        // Show element information
        function showElementInfo(atomicNumber) {
          // Find element in basic or advanced elements
          const element = [...basicElements.value, ...advancedElements.value].find(e => e.atomicNumber === atomicNumber);
          
          if (element) {
            selectedElement.value = element;
          }
        }
        
        // Check if an element is available to use
        function isElementAvailable(symbol) {
          return basicElements.value.some(e => e.symbol === symbol) || 
                 discoveredItems.value.some(i => i.symbol === symbol);
        }
        
        // Add element to workspace by symbol
        function addElementToWorkspace(symbol) {
          const element = [...basicElements.value, ...discoveredItems.value].find(e => e.symbol === symbol || e.id === symbol);
          if (element) {
            addToWorkspace(element);
          }
        }
        
        // Show discovery details
        function showDiscoveryDetails(discovery) {
          selectedDiscovery.value = discovery;
        }
        
        // Get the recipe for a discovery
        function getDiscoveryRecipe(discovery) {
          return recipes.value.find(recipe => recipe.output.id === discovery.id);
        }
        
        // Get related discoveries
        function getRelatedDiscoveries(discovery) {
          // Find discoveries that share elements or are part of the same reaction
          const recipe = getDiscoveryRecipe(discovery);
          if (!recipe) return [];
          
          const relatedIds = recipe.inputs;
          
          // Get discoveries that are made from or with this discovery
          const relatedByUse = recipes.value
            .filter(r => r.inputs.includes(discovery.id))
            .map(r => r.output.id);
          
          return discoveredItems.value.filter(item => 
            relatedIds.includes(item.id) || relatedByUse.includes(item.id)
          );
        }
        
        // Get element symbol by ID
        function getElementSymbolById(id) {
          const element = [...basicElements.value, ...discoveredItems.value].find(e => e.id === id);
          return element ? element.symbol : id;
        }
        
        // Get element class by ID
        function getElementClassById(id) {
          const element = [...basicElements.value, ...discoveredItems.value].find(e => e.id === id);
          return element ? getElementClass(element) : '';
        }
        
        // Get equipment name by ID
        function getEquipmentNameById(id) {
          const equipment = availableEquipment.value.find(e => e.id === id);
          return equipment ? equipment.name : id;
        }
        
        // Translate state
        function translateState(state) {
          if (!state) return '';
          
          const stateMap = {
            'solid': translate({ de: 'Fest', en: 'Solid' }),
            'liquid': translate({ de: 'Flüssig', en: 'Liquid' }),
            'gas': translate({ de: 'Gasförmig', en: 'Gas' }),
            'aqueous': translate({ de: 'Wässrig', en: 'Aqueous' }),
            'mixed': translate({ de: 'Gemischt', en: 'Mixed' })
          };
          
          return stateMap[state] || state;
        }
        
        // Translate category
        function translateCategory(category) {
          if (!category) return '';
          
          const categoryMap = {
            'element': translate({ de: 'Element', en: 'Element' }),
            'molecule': translate({ de: 'Molekül', en: 'Molecule' }),
            'compound': translate({ de: 'Verbindung', en: 'Compound' }),
            'mixture': translate({ de: 'Gemisch', en: 'Mixture' }),
            'reaction': translate({ de: 'Reaktion', en: 'Reaction' }),
            'energy': translate({ de: 'Energie', en: 'Energy' }),
            'special': translate({ de: 'Spezial', en: 'Special' }),
            'equipment': translate({ de: 'Ausrüstung', en: 'Equipment' })
          };
          
          return categoryMap[category] || category;
        }
        
        // Get the right class for elements based on their category and color
        function getElementClass(element) {
          if (!element) return '';
          
          let baseClass = '';
          
          // Base color based on element type
          switch(element.category) {
            case 'element':
              baseClass = darkMode.value ? 'bg-gray-700' : 'bg-gray-200';
              break;
            case 'molecule':
              baseClass = darkMode.value ? 'bg-blue-800' : 'bg-blue-100';
              break;
            case 'compound':
              baseClass = darkMode.value ? 'bg-indigo-800' : 'bg-indigo-100';
              break;
            case 'mixture':
              baseClass = darkMode.value ? 'bg-purple-800' : 'bg-purple-100';
              break;
            case 'reaction':
              baseClass = darkMode.value ? 'bg-red-800' : 'bg-red-100';
              break;
            case 'energy':
              baseClass = darkMode.value ? 'bg-yellow-700' : 'bg-yellow-100';
              break;
            case 'special':
              baseClass = darkMode.value ? 'bg-green-700' : 'bg-green-100';
              break;
            case 'equipment':
              baseClass = darkMode.value ? 'bg-cyan-700' : 'bg-cyan-100';
              break;
            default:
              baseClass = darkMode.value ? 'bg-gray-700' : 'bg-gray-200';
          }
          
          // Text color
          let textClass = darkMode.value ? 'text-white' : 'text-gray-900';
          
          // Border color based on element's specific color
          let borderClass = '';
          switch(element.color) {
            case 'blue':
              borderClass = 'border-blue-500';
              break;
            case 'red':
              borderClass = 'border-red-500';
              break;
            case 'green':
              borderClass = 'border-green-500';
              break;
            case 'yellow':
              borderClass = 'border-yellow-500';
              break;
            case 'purple':
              borderClass = 'border-purple-500';
              break;
            case 'gray':
              borderClass = 'border-gray-500';
              break;
            case 'orange':
              borderClass = 'border-orange-500';
              break;
            case 'cyan':
              borderClass = 'border-cyan-500';
              break;
            case 'indigo':
              borderClass = 'border-indigo-500';
              break;
            case 'white':
              borderClass = darkMode.value ? 'border-gray-300' : 'border-gray-400';
              break;
            case 'brown':
              borderClass = 'border-yellow-700';
              break;
            case 'silver':
              borderClass = 'border-gray-400';
              break;
            case 'gold':
              borderClass = 'border-yellow-500';
              break;
            default:
              borderClass = 'border-gray-500';
          }
          
          return `${baseClass} ${textClass} border-2 ${borderClass}`;
        }
        
        // Get notification icon class
        function notificationIconClass(type) {
          switch(type) {
            case 'discovery':
              return 'text-green-500';
            case 'mission':
              return 'text-yellow-500';
            case 'achievement':
              return 'text-purple-500';
            default:
              return 'text-blue-500';
          }
        }
        
        // Element dragging handlers
        function onDragStart(event, item, index, source) {
          event.dataTransfer.effectAllowed = 'copy';
          event.dataTransfer.setData('text/plain', JSON.stringify({
            item,
            index,
            source
          }));
        }
        
        function onDrop(event) {
          const data = JSON.parse(event.dataTransfer.getData('text/plain'));
          
          if (data.source === 'workspace') {
            // If it's from the workspace, don't add it again
            return;
          }
          
          if (data.source === 'equipment') {
            addEquipment(data.item);
          } else {
            addToWorkspace(data.item);
          }
          
          createParticles(event.clientX, event.clientY);
        }
        
        // Add element to workspace
        function addToWorkspace(element) {
          workspace.value.push(element);
          createParticles(event.clientX, event.clientY);
        }
        
        // Add equipment to active equipment
        function addEquipment(equipment) {
          if (!activeEquipment.value.some(eq => eq.id === equipment.id)) {
            activeEquipment.value.push(equipment);
            createParticles(event.clientX, event.clientY);
          }
        }
        
        // Remove equipment
        function removeEquipment(index) {
          activeEquipment.value.splice(index, 1);
        }
        
        // Remove element from workspace
        function removeFromWorkspace(index) {
          workspace.value.splice(index, 1);
        }
        
        // Clear the entire workspace
        function clearWorkspace() {
          workspace.value = [];
        }
        
        // Visual effects
        function createParticles(x, y) {
          const container = document.querySelector('#app');
          const numParticles = 8;
          
          for (let i = 0; i < numParticles; i++) {
            const particle = document.createElement('div');
            particle.classList.add('particle');
            
            // Random size between 5-10px
            const size = Math.random() * 5 + 5;
            particle.style.width = `${size}px`;
            particle.style.height = `${size}px`;
            
            // Random color
            const colors = ['#4299e1', '#48bb78', '#ed8936', '#ed64a6', '#9f7aea'];
            particle.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            
            // Position at the event coordinates
            particle.style.left = `${x}px`;
            particle.style.top = `${y}px`;
            
            // Random direction
            const angle = Math.random() * Math.PI * 2;
            const distance = Math.random() * 100 + 50;
            const tx = Math.cos(angle) * distance;
            const ty = Math.sin(angle) * distance;
            
            particle.style.setProperty('--tx', `${tx}px`);
            particle.style.setProperty('--ty', `${ty}px`);
            
            container.appendChild(particle);
            
            // Remove particle after animation completes
            setTimeout(() => {
              particle.remove();
            }, 1000);
          }
        }
        
        // Dismiss notification
        function dismissNotification(id) {
          const notification = notifications.value.find(n => n.id === id);
          if (notification) {
            notification.exiting = true;
            setTimeout(() => {
              notifications.value = notifications.value.filter(n => n.id !== id);
            }, 500);
          }
        }
        
        // Add a notification that disappears after a few seconds
        function addNotification(title, message, type = 'info') {
          const id = Date.now();
          const notification = { id, title, message, type, exiting: false };
          notifications.value.push(notification);
          
          // Remove notification after 8 seconds
          setTimeout(() => {
            dismissNotification(id);
          }, 8000);
        }
        
        // Try to combine elements in the workspace
        function combineElements() {
          if (workspace.value.length < 2 && (workspace.value.length < 1 || activeEquipment.value.length === 0)) return;
          
          // Get the ids of all elements in workspace
          const workspaceIds = workspace.value.map(item => item.id);
          
          // Get active equipment ids
          const equipmentIds = activeEquipment.value.map(item => item.id);
          
          // Sort the ids to ensure consistent matching regardless of order
          workspaceIds.sort();
          
          // Check each recipe to see if it matches
          for (const recipe of recipes.value) {
            const inputs = [...recipe.inputs].sort();
            
            // Check if all recipe inputs are in the workspace
            const inputsMatch = arraysMatch(inputs, workspaceIds);
            
            // Check if required equipment is active
            const hasRequiredEquipment = !recipe.requiredEquipment || 
              recipe.requiredEquipment.every(eq => equipmentIds.includes(eq));
            
            // Check temperature requirements
            const temperatureOk = !recipe.requiredTemperature || 
              (temperature.value >= recipe.requiredTemperature.min && 
               temperature.value <= recipe.requiredTemperature.max);
            
            // If all conditions match
            if (inputsMatch && hasRequiredEquipment && temperatureOk) {
              const output = recipe.output;
              
              // Check if already discovered
              if (!discoveredItems.value.some(item => item.id === output.id)) {
                discoveredItems.value.push(output);
                newlyDiscovered.value.push(output.id);
                
                // Update level progress
                currentLevelProgress.value += 1;
                if (currentLevelProgress.value >= currentLevelTarget.value) {
                  playerLevel.value += 1;
                  currentLevelProgress.value = 0;
                  
                  addNotification(
                    translate({ de: 'Level aufgestiegen!', en: 'Level Up!' }),
                    translate({ 
                      de: `Du bist jetzt Level ${playerLevel.value}!`, 
                      en: `You are now level ${playerLevel.value}!` 
                    }),
                    'info'
                  );
                }

                // Show discovery notification
                addNotification(
                  translate({ de: 'Neue Entdeckung!', en: 'New Discovery!' }),
                  translate({ 
                    de: `Du hast ${output.name} entdeckt!`, 
                    en: `You discovered ${output.name}!` 
                  }),
                  'discovery'
                );
                
                // Show reaction animation
                showReactionAnimation.value = true;
                reactionResult.value = {
                  success: true,
                  symbol: output.symbol,
                  title: translate({ de: 'Reaktion erfolgreich!', en: 'Reaction Successful!' }),
                  message: translate({ 
                    de: `Du hast erfolgreich ${output.name} erzeugt!`, 
                    en: `You successfully created ${output.name}!` 
                  })
                };
                
                // Clear newly discovered flag after a while
                setTimeout(() => {
                  newlyDiscovered.value = newlyDiscovered.value.filter(id => id !== output.id);
                }, 5000);
                
                // Replace workspace with new discovery
                workspace.value = [output];
                
                // Check missions and achievements
                checkMissions();
                checkAchievements();
                
                return;
              } else {
                // If already discovered, just show success message
                showReactionAnimation.value = true;
                reactionResult.value = {
                  success: true,
                  symbol: output.symbol,
                  title: translate({ de: 'Reaktion erfolgreich!', en: 'Reaction Successful!' }),
                  message: translate({ 
                    de: `Du hast ${output.name} erneut erzeugt.`, 
                    en: `You created ${output.name} again.` 
                  })
                };
                
                // Replace workspace with created item
                workspace.value = [discoveredItems.value.find(item => item.id === output.id)];
                return;
              }
            }
            
            // If inputs match but other requirements don't
            if (inputsMatch && (!hasRequiredEquipment || !temperatureOk)) {
              showReactionAnimation.value = true;
              
              let failureMessage = '';
              
              if (!hasRequiredEquipment && recipe.requiredEquipment) {
                const missingEquipment = recipe.requiredEquipment
                  .filter(eq => !equipmentIds.includes(eq))
                  .map(eq => getEquipmentNameById(eq))
                  .join(', ');
                
                failureMessage = translate({ 
                  de: `Du benötigst: ${missingEquipment}`, 
                  en: `You need: ${missingEquipment}` 
                });
              } else if (!temperatureOk && recipe.requiredTemperature) {
                failureMessage = translate({ 
                  de: `Benötigte Temperatur: ${recipe.requiredTemperature.min} - ${recipe.requiredTemperature.max}°C`, 
                  en: `Required temperature: ${recipe.requiredTemperature.min} - ${recipe.requiredTemperature.max}°C` 
                });
              }
              
              reactionResult.value = {
                success: false,
                symbol: '❌',
                title: translate({ de: 'Reaktion fehlgeschlagen!', en: 'Reaction Failed!' }),
                message: failureMessage
              };
              
              return;
            }
          }
          
          // If we got here, no matching recipe was found
          showReactionAnimation.value = true;
          reactionResult.value = {
            success: false,
            symbol: '❓',
            title: translate({ de: 'Keine Reaktion', en: 'No Reaction' }),
            message: translate({ 
              de: 'Diese Elemente können nicht kombiniert werden.', 
              en: 'These elements cannot be combined.' 
            })
          };
        }
        
        // Helper to check if arrays have the same elements
        function arraysMatch(arr1, arr2) {
          if (arr1.length !== arr2.length) return false;
          
          for (let i = 0; i < arr1.length; i++) {
            if (arr1[i] !== arr2[i]) return false;
          }
          
          return true;
        }
        
        // Toggle dark mode
        function toggleDarkMode() {
          darkMode.value = !darkMode.value;
          localStorage.setItem('elementcraft-dark-mode', darkMode.value);
        }
        
        // Toggle language between German and English
        function toggleLanguage() {
          currentLanguage.value = currentLanguage.value === 'de' ? 'en' : 'de';
          localStorage.setItem('elementcraft-language', currentLanguage.value);
        }
        
        // Reset the game
        function resetGame() {
          if (confirm(translate({ 
            de: 'Bist du sicher? Alle Fortschritte gehen verloren!', 
            en: 'Are you sure? All progress will be lost!' 
          }))) {
            workspace.value = [];
            discoveredItems.value = [];
            newlyDiscovered.value = [];
            playerLevel.value = 1;
            currentLevelProgress.value = 0;
            showWelcome.value = true;
            activeEquipment.value = [];
            temperature.value = 25;
            
            // Reset missions
            missions.value.forEach(mission => {
              mission.completed = false;
              mission.progress = 0;
            });
            activeMission.value = null;
            
            // Reset achievements
            achievements.value.forEach(achievement => {
              achievement.unlocked = false;
            });
            
            // Reset to only basic elements, removing special elements
            basicElements.value = basicElements.value.filter(el => !specialElements.value.some(se => se.id === el.id));
            
            addNotification(
              translate({ de: 'Spiel zurückgesetzt', en: 'Game Reset' }),
              translate({ 
                de: 'Dein Fortschritt wurde zurückgesetzt.', 
                en: 'Your progress has been reset.' 
              }),
              'info'
            );
          }
        }
        
        // Load saved game from localStorage
        function loadGame() {
          const savedGame = localStorage.getItem('elementcraft-save');
          if (savedGame) {
            try {
              const gameData = JSON.parse(savedGame);
              
              // Load basic game state
              discoveredItems.value = gameData.discovered || [];
              playerLevel.value = gameData.level || 1;
              currentLevelProgress.value = gameData.progress || 0;
              showWelcome.value = gameData.tutorial !== undefined ? !gameData.tutorial : true;
              
              // Load missions
              if (gameData.missions) {
                gameData.missions.forEach(savedMission => {
                  const mission = missions.value.find(m => m.id === savedMission.id);
                  if (mission) {
                    mission.completed = savedMission.completed;
                    mission.progress = savedMission.progress;
                  }
                });
              }
              
              // Load achievements
              if (gameData.achievements) {
                gameData.achievements.forEach(savedAchievement => {
                  const achievement = achievements.value.find(a => a.id === savedAchievement.id);
                  if (achievement) {
                    achievement.unlocked = savedAchievement.unlocked;
                  }
                });
              }
              
              // Load active mission
              if (gameData.activeMission) {
                activeMission.value = missions.value.find(m => m.id === gameData.activeMission);
              }
              
              // Check if special elements should be unlocked
              specialElements.value.forEach(element => {
                if (discoveredItems.value.length >= element.unlockAt && 
                    !basicElements.value.some(e => e.id === element.id) &&
                    !discoveredItems.value.some(i => i.id === element.id)) {
                  discoveredItems.value.push(element);
                }
              });
            } catch (e) {
              console.error('Failed to load saved game:', e);
            }
          }
        }
        
        // Save game to localStorage
        function saveGame() {
          const gameData = {
            discovered: discoveredItems.value,
            level: playerLevel.value,
            progress: currentLevelProgress.value,
            tutorial: showWelcome.value === false,
            missions: missions.value.map(mission => ({
              id: mission.id,
              completed: mission.completed,
              progress: mission.progress
            })),
            achievements: achievements.value.map(achievement => ({
              id: achievement.id,
              unlocked: achievement.unlocked
            })),
            activeMission: activeMission.value ? activeMission.value.id : null
          };
          
          localStorage.setItem('elementcraft-save', JSON.stringify(gameData));
        }
        
        // Setup an autosave
        function setupAutosave() {
          setInterval(saveGame, 30000); // Save every 30 seconds
        }
        
        // Watch for changes to update translations when language changes
        watch(currentLanguage, () => {
          // Update basic elements translation
          basicElements.value = basicElements.value.map(element => ({
            ...element,
            name: translate({ 
              de: getGermanName(element.id), 
              en: getEnglishName(element.id)
            }),
            description: translate({
              de: getGermanDescription(element.id),
              en: getEnglishDescription(element.id)
            })
          }));
          
          // Update available equipment
          availableEquipment.value = availableEquipment.value.map(equipment => ({
            ...equipment,
            name: translate({
              de: getGermanEquipmentName(equipment.id),
              en: getEnglishEquipmentName(equipment.id)
            }),
            description: translate({
              de: getGermanEquipmentDescription(equipment.id),
              en: getEnglishEquipmentDescription(equipment.id)
            }),
            enables: equipment.enables.map(e => translate({
              de: getGermanCapability(e),
              en: e
            }))
          }));
          
          // Update discovered items
          discoveredItems.value = discoveredItems.value.map(item => ({
            ...item,
            name: translate({ 
              de: getGermanName(item.id), 
              en: getEnglishName(item.id)
            }),
            description: translate({
              de: getGermanDescription(item.id),
              en: getEnglishDescription(item.id)
            })
          }));
          
          // Update tabs
          tabs.forEach((tab, index) => {
            tabs[index].name = translate({
              de: getGermanTabName(tab.id),
              en: getEnglishTabName(tab.id)
            });
          });
          
          // Update recipes
          recipes.value = recipes.value.map(recipe => ({
            ...recipe,
            output: {
              ...recipe.output,
              name: translate({
                de: getGermanName(recipe.output.id),
                en: getEnglishName(recipe.output.id)
              }),
              description: translate({
                de: getGermanDescription(recipe.output.id),
                en: getEnglishDescription(recipe.output.id)
              })
            }
          }));
          
          // Update missions
          missions.value = missions.value.map(mission => ({
            ...mission,
            title: translate({
              de: getGermanMissionTitle(mission.id),
              en: getEnglishMissionTitle(mission.id)
            }),
            description: translate({
              de: getGermanMissionDescription(mission.id),
              en: getEnglishMissionDescription(mission.id)
            }),
            reward: translate({
              de: getGermanMissionReward(mission.id),
              en: getEnglishMissionReward(mission.id)
            })
          }));
          
          // Update achievements
          achievements.value = achievements.value.map(achievement => ({
            ...achievement,
            title: translate({
              de: getGermanAchievementTitle(achievement.id),
              en: getEnglishAchievementTitle(achievement.id)
            }),
            description: translate({
              de: getGermanAchievementDescription(achievement.id),
              en: getEnglishAchievementDescription(achievement.id)
            })
          }));
          
          // Update encyclopedia categories
          encyclopediaCategories.forEach((category, index) => {
            encyclopediaCategories[index].name = translate({
              de: getGermanCategoryName(category.id),
              en: getEnglishCategoryName(category.id)
            });
            encyclopediaCategories[index].description = translate({
              de: getGermanCategoryDescription(category.id),
              en: getEnglishCategoryDescription(category.id)
            });
          });
        });
        
        // Helper functions for tab translations
        function getGermanTabName(id) {
          const nameMap = {
            'lab': 'Labor',
            'elements': 'Periodensystem',
            'discoveries': 'Entdeckungen',
            'encyclopedia': 'Enzyklopädie'
          };
          return nameMap[id] || id;
        }
        
        function getEnglishTabName(id) {
          const nameMap = {
            'lab': 'Laboratory',
            'elements': 'Periodic Table',
            'discoveries': 'Discoveries',
            'encyclopedia': 'Encyclopedia'
          };
          return nameMap[id] || id;
        }
        
        // Helper functions for encyclopedia category translations
        function getGermanCategoryName(id) {
          const nameMap = {
            'basics': 'Grundlagen der Chemie',
            'periodic': 'Periodensystem',
            'reactions': 'Chemische Reaktionen',
            'physics': 'Physikalische Konzepte',
            'laboratory': 'Laborausrüstung'
          };
          return nameMap[id] || id;
        }
        
        function getEnglishCategoryName(id) {
          const nameMap = {
            'basics': 'Chemistry Basics',
            'periodic': 'Periodic Table',
            'reactions': 'Chemical Reactions',
            'physics': 'Physics Concepts',
            'laboratory': 'Laboratory Equipment'
          };
          return nameMap[id] || id;
        }
        
        function getGermanCategoryDescription(id) {
          const descMap = {
            'basics': 'Einführung in die grundlegenden chemischen Konzepte und Prinzipien.',
            'periodic': 'Informationen über das Periodensystem der Elemente und seine Struktur.',
            'reactions': 'Erklärungen zu verschiedenen Arten von chemischen Reaktionen.',
            'physics': 'Grundlegende physikalische Prinzipien, die mit Chemie zusammenhängen.',
            'laboratory': 'Informationen über verschiedene Laborgeräte und ihre Anwendungen.'
          };
          return descMap[id] || '';
        }
        
        function getEnglishCategoryDescription(id) {
          const descMap = {
            'basics': 'Introduction to basic chemical concepts and principles.',
            'periodic': 'Information about the periodic table of elements and its structure.',
            'reactions': 'Explanations of different types of chemical reactions.',
            'physics': 'Basic physical principles related to chemistry.',
            'laboratory': 'Information about various laboratory equipment and their applications.'
          };
          return descMap[id] || '';
        }
        
        // Helper functions for mission translations
        function getGermanMissionTitle(id) {
          const titleMap = {
            'mission1': 'Erste Schritte',
            'mission2': 'Säuren und Basen',
            'mission3': 'Kohlenstoffchemie',
            'mission4': 'Metallverarbeitung',
            'mission5': 'Elektrolyse'
          };
          return titleMap[id] || id;
        }
        
        function getEnglishMissionTitle(id) {
          const titleMap = {
            'mission1': 'First Steps',
            'mission2': 'Acids and Bases',
            'mission3': 'Carbon Chemistry',
            'mission4': 'Metal Processing',
            'mission5': 'Electrolysis'
          };
          return titleMap[id] || id;
        }
        
        function getGermanMissionDescription(id) {
          const descMap = {
            'mission1': 'Entdecke die grundlegenden Moleküle Wasser (H₂O) und Wasserstoffgas (H₂).',
            'mission2': 'Erzeuge Salzsäure (HCl) und führe eine Neutralisationsreaktion durch.',
            'mission3': 'Entdecke verschiedene Kohlenstoffverbindungen: CO₂, CO und CH₄.',
            'mission4': 'Erzeuge Rost und führe einen Schmelzprozess durch, um Stahl herzustellen.',
            'mission5': 'Führe Elektrolyse von Wasser und Salzlösung durch.'
          };
          return descMap[id] || '';
        }
        
        function getEnglishMissionDescription(id) {
          const descMap = {
            'mission1': 'Discover the basic molecules Water (H₂O) and Hydrogen Gas (H₂).',
            'mission2': 'Create Hydrochloric Acid (HCl) and perform a neutralization reaction.',
            'mission3': 'Discover various carbon compounds: CO₂, CO, and CH₄.',
            'mission4': 'Create rust and perform a smelting process to produce steel.',
            'mission5': 'Perform electrolysis of water and salt solution.'
          };
          return descMap[id] || '';
        }
        
        function getGermanMissionReward(id) {
          const rewardMap = {
            'mission1': 'Freischaltung des Bunsenbrenners',
            'mission2': 'Freischaltung von Elektrizität',
            'mission3': 'Freischaltung des UV-Lichts',
            'mission4': 'Freischaltung fortgeschrittener Metalle: Cu, Ag, Au',
            'mission5': 'Freischaltung des Katalysators'
          };
          return rewardMap[id] || '';
        }
        
        function getEnglishMissionReward(id) {
          const rewardMap = {
            'mission1': 'Unlocks the Bunsen Burner',
            'mission2': 'Unlocks Electricity',
            'mission3': 'Unlocks UV Light',
            'mission4': 'Unlocks advanced metals: Cu, Ag, Au',
            'mission5': 'Unlocks Catalyst'
          };
          return rewardMap[id] || '';
        }
        
        // Helper functions for achievement translations
        function getGermanAchievementTitle(id) {
          const titleMap = {
            'achievement1': 'Chemiker in Ausbildung',
            'achievement2': 'Laborassistent',
            'achievement3': 'Elementar, mein Lieber!',
            'achievement4': 'Meister der Mischungen',
            'achievement5': 'Reaktionsexperte',
            'achievement6': 'Alchemist'
          };
          return titleMap[id] || id;
        }
        
        function getEnglishAchievementTitle(id) {
          const titleMap = {
            'achievement1': 'Chemist in Training',
            'achievement2': 'Lab Assistant',
            'achievement3': 'Elementary, My Dear!',
            'achievement4': 'Master of Mixtures',
            'achievement5': 'Reaction Expert',
            'achievement6': 'Alchemist'
          };
          return titleMap[id] || id;
        }
        
        function getGermanAchievementDescription(id) {
          const descMap = {
            'achievement1': 'Entdecke 5 verschiedene Verbindungen.',
            'achievement2': 'Schließe deine erste Mission ab.',
            'achievement3': 'Entdecke alle Grundelemente.',
            'achievement4': 'Erzeuge 3 verschiedene Gemische.',
            'achievement5': 'Führe 5 verschiedene Reaktionen durch.',
            'achievement6': 'Erreiche Level 10.'
          };
          return descMap[id] || '';
        }
        
        function getEnglishAchievementDescription(id) {
          const descMap = {
            'achievement1': 'Discover 5 different compounds.',
            'achievement2': 'Complete your first mission.',
            'achievement3': 'Discover all basic elements.',
            'achievement4': 'Create 3 different mixtures.',
            'achievement5': 'Perform 5 different reactions.',
            'achievement6': 'Reach Level 10.'
          };
          return descMap[id] || '';
        }
        
        // Helper functions for equipment translations
        function getGermanEquipmentName(id) {
          const nameMap = {
            'bunsen_burner': 'Bunsenbrenner',
            'test_tube': 'Reagenzglas',
            'beaker': 'Becherglas',
            'scale': 'Waage',
            'filter': 'Filter'
          };
          return nameMap[id] || id;
        }
        
        function getEnglishEquipmentName(id) {
          const nameMap = {
            'bunsen_burner': 'Bunsen Burner',
            'test_tube': 'Test Tube',
            'beaker': 'Beaker',
            'scale': 'Scale',
            'filter': 'Filter'
          };
          return nameMap[id] || id;
        }
        
        function getGermanEquipmentDescription(id) {
          const descMap = {
            'bunsen_burner': 'Erzeugt eine heiße Flamme für Experimente, die hohe Temperaturen erfordern.',
            'test_tube': 'Schmaler Glasbehälter für kleine Experimente und Reaktionen.',
            'beaker': 'Größerer Behälter für Flüssigkeiten und größere Reaktionen.',
            'scale': 'Misst die Masse von Substanzen für präzise Experimente.',
            'filter': 'Trennt Feststoffe von Flüssigkeiten durch Filtration.'
          };
          return descMap[id] || '';
        }
        
        function getEnglishEquipmentDescription(id) {
          const descMap = {
            'bunsen_burner': 'Creates a hot flame for experiments requiring high temperatures.',
            'test_tube': 'Narrow glass container for small experiments and reactions.',
            'beaker': 'Larger container for liquids and bigger reactions.',
            'scale': 'Measures the mass of substances for precise experiments.',
            'filter': 'Separates solids from liquids through filtration.'
          };
          return descMap[id] || '';
        }
        
        function getGermanCapability(capability) {
          const capMap = {
            'Heating': 'Erhitzen',
            'Combustion': 'Verbrennung',
            'Mixing': 'Mischen',
            'Small Reactions': 'Kleine Reaktionen',
            'Larger Volumes': 'Größere Mengen',
            'Complex Mixtures': 'Komplexe Mischungen',
            'Precise Measurements': 'Präzise Messungen',
            'Stoichiometry': 'Stöchiometrie',
            'Filtration': 'Filtration',
            'Separation': 'Trennung'
          };
          return capMap[capability] || capability;
        }
        
        // Helper functions for name translations
        function getGermanName(id) {
          const nameMap = {
            'H': 'Wasserstoff',
            'O': 'Sauerstoff',
            'C': 'Kohlenstoff',
            'N': 'Stickstoff',
            'Na': 'Natrium',
            'Cl': 'Chlor',
            'Fe': 'Eisen',
            'S': 'Schwefel',
            'Cu': 'Kupfer',
            'Ag': 'Silber',
            'Au': 'Gold',
            'Hg': 'Quecksilber',
            'He': 'Helium',
            'H2O': 'Wasser',
            'HCl': 'Salzsäure',
            'NaCl': 'Kochsalz',
            'CO2': 'Kohlendioxid',
            'CO': 'Kohlenmonoxid',
            'NH3': 'Ammoniak',
            'H2': 'Wasserstoffgas',
            'O2': 'Sauerstoffgas',
            'H2CO3': 'Kohlensäure',
            'Fe2O3': 'Rost',
            'CH4': 'Methan',
            'H2O2': 'Wasserstoffperoxid',
            'NaOH': 'Natronlauge',
            'CH3OH': 'Methanol',
            'SO2': 'Schwefeldioxid',
            'SO3': 'Schwefeltrioxid',
            'H2SO4': 'Schwefelsäure',
            'NO': 'Stickstoffmonoxid',
            'NO2': 'Stickstoffdioxid',
            'HN3': 'Stickstoffwasserstoffsäure',
            'HF': 'Fluorwasserstoff',
            'combustion': 'Verbrennung',
            'NaCl_H2O': 'Neutralisation',
            'saline': 'Kochsalzlösung',
            'Fe_CO2': 'Eisengewinnung',
            'steel': 'Stahl',
            'electrolysis': 'Elektrolyse',
            'NaCl_electrolysis': 'Chlor-Alkali-Prozess',
            'electricity': 'Elektrizität',
            'uv_light': 'UV-Licht',
            'catalyst': 'Katalysator'
          };
          return nameMap[id] || id;
        }
        
        function getEnglishName(id) {
          const nameMap = {
            'H': 'Hydrogen',
            'O': 'Oxygen',
            'C': 'Carbon',
            'N': 'Nitrogen',
            'Na': 'Sodium',
            'Cl': 'Chlorine',
            'Fe': 'Iron',
            'S': 'Sulfur',
            'Cu': 'Copper',
            'Ag': 'Silver',
            'Au': 'Gold',
            'Hg': 'Mercury',
            'He': 'Helium',
            'H2O': 'Water',
            'HCl': 'Hydrochloric Acid',
            'NaCl': 'Table Salt',
            'CO2': 'Carbon Dioxide',
            'CO': 'Carbon Monoxide',
            'NH3': 'Ammonia',
            'H2': 'Hydrogen Gas',
            'O2': 'Oxygen Gas',
            'H2CO3': 'Carbonic Acid',
            'Fe2O3': 'Rust',
            'CH4': 'Methane',
            'H2O2': 'Hydrogen Peroxide',
            'NaOH': 'Sodium Hydroxide',
            'CH3OH': 'Methanol',
            'SO2': 'Sulfur Dioxide',
            'SO3': 'Sulfur Trioxide',
            'H2SO4': 'Sulfuric Acid',
            'NO': 'Nitric Oxide',
            'NO2': 'Nitrogen Dioxide',
            'HN3': 'Hydrazoic Acid',
            'HF': 'Hydrogen Fluoride',
            'combustion': 'Combustion',
            'NaCl_H2O': 'Neutralization',
            'saline': 'Saline Solution',
            'Fe_CO2': 'Iron Smelting',
            'steel': 'Steel',
            'electrolysis': 'Electrolysis',
            'NaCl_electrolysis': 'Chlor-Alkali Process',
            'electricity': 'Electricity',
            'uv_light': 'UV Light',
            'catalyst': 'Catalyst'
          };
          return nameMap[id] || id;
        }
        
        function getGermanDescription(id) {
          const descMap = {
            'H': 'Leichtestes Element, brennbar und sehr reaktiv.',
            'O': 'Unterstützt Verbrennung, notwendig für Atmung.',
            'C': 'Grundlage organischer Verbindungen, kommt in verschiedenen Allotropen vor.',
            'N': 'Hauptbestandteil der Erdatmosphäre, wichtig für Proteine.',
            'Na': 'Silbrig-weißes, weiches Alkalimetall, reagiert heftig mit Wasser.',
            'Cl': 'Gelblich-grünes Gas, stark oxidierend, wird zur Wasseraufbereitung verwendet.',
            'Fe': 'Häufigstes Übergangselement, magnetisch, grundlegendes Metall für Industrie.',
            'S': 'Gelber, spröder Nichtmetall mit charakteristischem Geruch.',
            'Cu': 'Rötliches Metall, guter Leiter für Wärme und Elektrizität.',
            'Ag': 'Glänzendes, weiches Edelmetall mit höchster elektrischer Leitfähigkeit.',
            'Au': 'Glänzendes, gelbes Edelmetall, sehr beständig gegen Korrosion.',
            'Hg': 'Silbriges Metall, flüssig bei Raumtemperatur, giftig.',
            'He': 'Leichtes, inertes Edelgas, bekannt für seinen Einsatz in Ballons.',
            'H2O': 'Die grundlegende Verbindung des Lebens, Lösungsmittel für viele Reaktionen.',
            'HCl': 'Eine starke Säure, die in der Industrie und im Magen vorkommt.',
            'NaCl': 'Grundlegendes Mineral für Leben und Kochen, Ionenverbindung.',
            'CO2': 'Gas in der Atmosphäre, Produkt der Verbrennung und Atmung.',
            'CO': 'Farb- und geruchloses, giftiges Gas, bindet an Hämoglobin.',
            'NH3': 'Stechend riechendes Gas, wichtig für Düngemittel.',
            'H2': 'Leichtestes Element, brennbar und potenzieller Kraftstoff.',
            'O2': 'Notwendig zum Atmen und für Verbrennungsreaktionen.',
            'H2CO3': 'Macht Getränke sprudelnd, zerfällt leicht in Wasser und CO₂.',
            'Fe2O3': 'Eisenoxid, Ergebnis der Oxidation von Eisen an feuchter Luft.',
            'CH4': 'Einfachster Kohlenwasserstoff, Hauptbestandteil von Erdgas.',
            'H2O2': 'Oxidationsmittel, Bleichmittel, zerfällt zu Wasser und Sauerstoff.',
            'NaOH': 'Starke Base, ätzend, wird in Reinigungsmitteln verwendet.',
            'CH3OH': 'Einfacher Alkohol, giftig, wird als Lösungsmittel verwendet.',
            'SO2': 'Reizgas, entsteht bei Verbrennung schwefelhaltiger Brennstoffe.',
            'SO3': 'Reaktives Gas, reagiert mit Wasser zu Schwefelsäure.',
            'H2SO4': 'Starke, korrosive Säure, wichtig in der Industrie.',
            'NO': 'Signalmolekül im Körper, wichtig für Blutgefäßerweiterung.',
            'NO2': 'Braunes Gas, Luftschadstoff, entsteht bei Verbrennungsprozessen.',
            'HN3': 'Hochexplosive Verbindung, sehr instabil.',
            'HF': 'Stark korrosive Säure, ätzt Glas, sehr gefährlich.',
            'combustion': 'Exotherme Reaktion mit Sauerstoff, erzeugt Wärme und Licht.',
            'NaCl_H2O': 'Säure-Base-Reaktion, erzeugt Salz und Wasser.',
            'saline': 'Salzwasser, wichtig für medizinische Anwendungen.',
            'Fe_CO2': 'Metallurgischer Prozess zur Gewinnung von Eisen aus Erz.',
            'steel': 'Legierung aus Eisen und Kohlenstoff, härter und stärker als reines Eisen.',
            'electrolysis': 'Zerlegung durch Strom, spaltet Wasser in Wasserstoff und Sauerstoff.',
            'NaCl_electrolysis': 'Elektrolyse von Salzlösung, erzeugt Chlorgas und Natronlauge.',
            'electricity': 'Stromfluss durch Ladungsunterschiede, ermöglicht elektrochemische Reaktionen.',
            'uv_light': 'Elektromagnetische Strahlung, die photochemische Reaktionen auslösen kann.',
            'catalyst': 'Beschleunigt chemische Reaktionen, ohne selbst verbraucht zu werden.'
          };
          return descMap[id] || '';
        }
        
        function getEnglishDescription(id) {
          const descMap = {
            'H': 'Lightest element, flammable and highly reactive.',
            'O': 'Supports combustion, necessary for respiration.',
            'C': 'Basis of organic compounds, exists in various allotropes.',
            'N': 'Main component of Earth\'s atmosphere, important for proteins.',
            'Na': 'Silvery-white, soft alkali metal, reacts vigorously with water.',
            'Cl': 'Yellowish-green gas, strongly oxidizing, used for water treatment.',
            'Fe': 'Most common transition element, magnetic, fundamental metal for industry.',
            'S': 'Yellow, brittle non-metal with a characteristic odor.',
            'Cu': 'Reddish metal, good conductor of heat and electricity.',
            'Ag': 'Lustrous, soft precious metal with highest electrical conductivity.',
            'Au': 'Lustrous, yellow precious metal, highly resistant to corrosion.',
            'Hg': 'Silvery metal, liquid at room temperature, toxic.',
            'He': 'Light, inert noble gas, known for its use in balloons.',
            'H2O': 'The fundamental compound of life, solvent for many reactions.',
            'HCl': 'A strong acid found in industry and in the stomach.',
            'NaCl': 'Essential mineral for life and cooking, ionic compound.',
            'CO2': 'Atmospheric gas, product of combustion and respiration.',
            'CO': 'Colorless, odorless, toxic gas, binds to hemoglobin.',
            'NH3': 'Pungent-smelling gas, important for fertilizers.',
            'H2': 'Lightest element, flammable and potential fuel.',
            'O2': 'Necessary for breathing and combustion reactions.',
            'H2CO3': 'Makes drinks fizzy, easily decomposes into water and CO₂.',
            'Fe2O3': 'Iron oxide, result of iron oxidation in moist air.',
            'CH4': 'Simplest hydrocarbon, main component of natural gas.',
            'H2O2': 'Oxidizing agent, bleach, decomposes to water and oxygen.',
            'NaOH': 'Strong base, caustic, used in cleaning products.',
            'CH3OH': 'Simple alcohol, toxic, used as a solvent.',
            'SO2': 'Irritant gas, produced by burning sulfur-containing fuels.',
            'SO3': 'Reactive gas, reacts with water to form sulfuric acid.',
            'H2SO4': 'Strong, corrosive acid, important in industry.',
            'NO': 'Signaling molecule in the body, important for blood vessel dilation.',
            'NO2': 'Brown gas, air pollutant, produced in combustion processes.',
            'HN3': 'Highly explosive compound, very unstable.',
            'HF': 'Highly corrosive acid, etches glass, very dangerous.',
            'combustion': 'Exothermic reaction with oxygen, produces heat and light.',
            'NaCl_H2O': 'Acid-base reaction, produces salt and water.',
            'saline': 'Salt water, important for medical applications.',
            'Fe_CO2': 'Metallurgical process to extract iron from ore.',
            'steel': 'Alloy of iron and carbon, harder and stronger than pure iron.',
            'electrolysis': 'Decomposition by electricity, splits water into hydrogen and oxygen.',
            'NaCl_electrolysis': 'Electrolysis of salt solution, produces chlorine gas and sodium hydroxide.',
            'electricity': 'Flow of charge due to potential difference, enables electrochemical reactions.',
            'uv_light': 'Electromagnetic radiation that can trigger photochemical reactions.',
            'catalyst': 'Accelerates chemical reactions without being consumed.'
          };
          return descMap[id] || '';
        }
        
        // Initialize game on mount
        onMounted(() => {
          // Check if tutorial was completed
          const tutorialCompleted = localStorage.getItem('elementcraft-tutorial-completed') === 'true';
          if (tutorialCompleted) {
            showWelcome.value = false;
          }
          
          loadGame();
          setupAutosave();
          
          // Check if missions are completed
          checkMissions();
          
          // Check if achievements are unlocked
          checkAchievements();
        });
        
        return {
          // Game state
          darkMode,
          currentLanguage,
          workspace,
          discoveredItems,
          newlyDiscovered,
          notifications,
          showWelcome,
          showHelpModal,
          showMissionsModal,
          playerLevel,
          currentLevelProgress,
          currentLevelTarget,
          activeEquipment,
          temperature,
          maxTemperature,
          activeTab,
          tabs,
          selectedDiscovery,
          selectedElement,
          selectedTopic,
          currentPage,
          itemsPerPage,
          discoveryFilter,
          searchQuery,
          encyclopediaActiveCategory,
          encyclopediaCategories,
          activeMission,
          showReactionAnimation,
          reactionResult,
          
          // Computed properties
          basicElements,
          availableEquipment,
          filteredDiscoveries,
          totalPages,
          paginationPages,
          recipeCount,
          availableMissions,
          achievements,
          tutorialActive,
          tutorialStepIndex,
          currentTutorialStep,
          
          // Methods
          translate,
          getElementClass,
          onDragStart,
          onDrop,
          addToWorkspace,
          removeFromWorkspace,
          clearWorkspace,
          combineElements,
          toggleDarkMode,
          toggleLanguage,
          resetGame,
          addEquipment,
          removeEquipment,
          openHelpModal,
          openMissionsModal,
          calculateMissionProgress,
          getMissionProgressText,
          selectActiveMission,
          getPeriodicElementClass,
          showElementInfo,
          isElementAvailable,
          addElementToWorkspace,
          showDiscoveryDetails,
          getDiscoveryRecipe,
          getRelatedDiscoveries,
          getElementSymbolById,
          getElementClassById,
          getEquipmentNameById,
          translateState,
          translateCategory,
          startTutorial,
          skipTutorial,
          nextTutorialStep,
          prevTutorialStep,
          dismissNotification,
          notificationIconClass,
          getEncyclopediaTopics,
          showEncyclopediaTopic
        };
      }
    }).mount('#app');
  </script>
</body>
</html>
